import{r as d,j as e,a as Pt}from"./react-BoqISt01.js";import{c as Ks}from"./react-dom-Bk743r0W.js";import{u as V,a as ze,P as en}from"./react-redux-D3oi59tp.js";import{a as X}from"./axios-CCb-kr4I.js";import{s as q,L as ue,C as le,R as O,F as B,D as Z,B as T,a as as,T as st,P as tn,d as sn,M as fe,b as z,c as M,S as ce,e as de,f as Y,g as Dt,h as be,i as Be,I as xe,j as is,k as Ut,l as Ht,m as jt,n as _t,o as Bt,p as nn,q as rn,A as an,r as ft,t as Pe,u as Ke,v as Ze,w as ln,x as on,y as yt,z as dn,E as ls}from"./antd-DUgvu7h7.js";import{u as Te}from"./react-responsive-B9DcSnuZ.js";import{L as cn}from"./rc-virtual-list-D8xMsbcw.js";import{F as D,f as Qe,a as Ye,b as os,c as $e,d as Ae,e as un,g as xn,h as pn,i as mn,j as Tt,k as We,l as Et,m as hn,n as et,o as tt,p as nt,q as xt,r as gn,s as jn,t as fn,u as yn}from"./@fortawesome-iG2bi8FM.js";import{a2 as vt,A as ds,a3 as cs,a4 as vn,o as Wt,a5 as wn,a6 as _e,R as $t,a1 as At,v as Rt,r as bn,s as Cn,x as Sn,a7 as In}from"./@ant-design-DbJKpMgD.js";import{c as us,a as Ie,b as Nn}from"./@reduxjs-DkgbS889.js";import{m as Se,h as zt}from"./moment-BAfwh5x7.js";import{D as kn,B as Qt}from"./react-chartjs-2-0Z_sSmBf.js";import{C as Fn,A as Pn,p as _n,a as Tn,b as En,L as $n,c as An}from"./chart.js-BkMDj0WH.js";import{L as pe,B as Rn}from"./react-router-dom-UU0TJEQ6.js";import{l as Mn}from"./socket.io-client-CDVIIGn8.js";import{O as xs,C as ps,a as qn,T as ms,D as hs,P as Ln,R as On,b as gs,S as js,L as fs,c as ys,d as vs,e as Dn,f as Un,g as ws,h as Hn,i as Bn,j as Wn}from"./@radix-ui-B3e9CqpC.js";import{c as zn}from"./clsx-B-dksMZM.js";import{t as Qn}from"./tailwind-merge-D696Ktp4.js";import{X as wt,C as Yn,a as Jn,S as Gn,T as Xn,b as pt,P as Vn,c as Zn,d as Kn}from"./lucide-react-C-DaTvPU.js";import{u as er,F as tr,C as sr,b as nr}from"./react-hook-form-E7byIJnj.js";import{c as Mt}from"./class-variance-authority-Dp3B9jqt.js";import{z as Me}from"./zod-DHHRaryC.js";import{t as rr}from"./@hookform-CaGMwPfa.js";import{d as ar,e as Fe,b as ir}from"./react-router-CBguhhk8.js";import"./@babel-D3CJPhrF.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-BQxMxw6g.js";import"./rc-util-CNJZKBfo.js";import"./classnames-CAxFPVRb.js";import"./rc-resize-observer-DAFDewDD.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-DZL9tseL.js";import"./@rc-component-DPyZj6wr.js";import"./rc-overflow-BihHMfjR.js";import"./rc-picker-C6pnqAVS.js";import"./dayjs-DMN7meC7.js";import"./rc-tabs-BUPz9aOH.js";import"./rc-dropdown-DBn3Vn4f.js";import"./rc-menu-CXhGSgjF.js";import"./rc-select-Enbnx8e0.js";import"./rc-segmented-DWUgWqHo.js";import"./rc-input-number-Do8zGlOB.js";import"./rc-input-DGbryaDy.js";import"./@ctrl-DOFZgDuz.js";import"./rc-drawer-DjgcoIVX.js";import"./rc-field-form-DdGYHmQ7.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-image-CQiP7trl.js";import"./rc-dialog-B4yQaf15.js";import"./rc-notification-m3oA-fH0.js";import"./rc-tooltip-BAFIWTUD.js";import"./rc-steps-jTTkhuna.js";import"./rc-progress-BECVEO62.js";import"./rc-switch-B_QRjvBh.js";import"./rc-table-rj7zZJss.js";import"./rc-tree-BDK0sBoh.js";import"./rc-checkbox-XvbJzSrO.js";import"./rc-pagination-CZPuIcur.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-textarea-BF1YsysJ.js";import"./copy-to-clipboard-DN2oU9Yq.js";import"./toggle-selection-BHUZwh74.js";import"./matchmediaquery-9DU1HNkU.js";import"./css-mediaquery-DcYbJrVh.js";import"./hyphenate-style-name-HOLnhz8K.js";import"./shallow-equal-BQUY1Bas.js";import"./prop-types-Bq5K3Feg.js";import"./@emotion-CW87jbl0.js";import"./stylis-OW4gUFyn.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./@kurkle-BZxJdD1U.js";import"./@remix-run-Br25Cn4W.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./react-remove-scroll-uEV8_dwQ.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-Chida324.js";import"./react-style-singleton-D-ncAbk2.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BUbtaZ7t.js";import"./use-callback-ref-CGYexTLy.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-CyZwn0-1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const x of n)if(x.type==="childList")for(const m of x.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function s(n){const x={};return n.integrity&&(x.integrity=n.integrity),n.referrerPolicy&&(x.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?x.credentials="include":n.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function i(n){if(n.ep)return;n.ep=!0;const x=s(n);fetch(n.href,x)}})();const ye="https://menu-server-c2b952e2c698.herokuapp.com/api",lr=t=>X.post(`${ye}/products`,t),or=t=>{const r=encodeURIComponent(t._id);return X.put(`${ye}/products/${r}`,t)},dr=t=>X.delete(`${ye}/products/${t}`),bs=()=>X.get(`${ye}/products`),cr=t=>X.get(`${ye}/products/${t}`),ur=(t,r)=>X.post(`${ye}/sizes/${t}`,r),xr=(t,r)=>X.put(`${ye}/sizes/${t}`,r),pr=(t,r)=>X.delete(`${ye}/sizes/${t}/${r}`),mr=t=>X.post(`${ye}/variations`,t),hr=(t,r)=>X.put(`${ye}/variations/${t}`,r),gr=t=>X.delete(`${ye}/variations/${t}`),Cs=d.createContext(),Ss=()=>d.useContext(Cs),jr=({children:t})=>{const[r,s]=d.useState(!1),[i,n]=d.useState(!1),[x,m]=d.useState("add"),[u,g]=d.useState(null),[f,S]=d.useState(null),C=I=>new Promise(async(j,a)=>{var o;try{const h=await cr(I);(o=h==null?void 0:h.data)!=null&&o.error?a(!1):j(h==null?void 0:h.data)}catch(h){console.error("Error get product:",h)}}),L=I=>new Promise(async(j,a)=>{var o,h;s(!0);try{const b=await lr(I);s(!1),(o=b==null?void 0:b.data)!=null&&o.error?(q.error((h=b==null?void 0:b.data)==null?void 0:h.error),a(!1)):(q.success("המוצר נוסף בהצלחה"),j(!0))}catch(b){console.error("Error adding product:",b),q.error("שגיאה בהוספת המוצר"),s(!1)}}),N=I=>new Promise(async(j,a)=>{var o;s(!0);try{const h=await or(I);s(!1),(o=h==null?void 0:h.data)!=null&&o.error||(q.success("המוצר עודכן בהצלחה"),j(!0)),a(!1)}catch(h){console.error("Error updating product:",h),q.error("שגיאה בעדכון המוצר"),s(!1)}}),_=async I=>{s(!0);try{await dr(I),q.success("המוצר נמחק בהצלחה"),s(!1)}catch(j){console.error("Error deleting product:",j),q.error("שגיאה במחיקת המוצר"),s(!1)}},R=(I,j)=>(s(!0),new Promise(async(a,o)=>{try{const h=await ur(I,j);q.success("הגודל נוסף בהצלחה"),s(!1),a(h.data)}catch(h){console.error("Error adding size:",h),q.error("שגיאה בהוספת הגודל"),s(!1),o(h)}})),P=(I,j)=>(s(!0),new Promise(async(a,o)=>{try{const h=await xr(I,j);q.success("הגודל עודכן בהצלחה"),s(!1),a(h.data)}catch(h){console.error("Error updating size:",h),q.error("שגיאה בעדכון הגודל"),s(!1),o(h)}})),v=(I,j)=>(s(!0),new Promise(async(a,o)=>{try{await pr(I,j),q.success("הגודל נמחק בהצלחה"),s(!1),a(!0)}catch(h){console.error("Error deleting size:",h),q.error("שגיאה במחיקת הגודל"),s(!1),o(h)}})),w=I=>(s(!0),new Promise(async(j,a)=>{try{const o=await mr(I);q.success("הווריאציה נוספה בהצלחה"),s(!1),j(o.data)}catch(o){console.error("Error adding variation:",o),q.error("שגיאה בהוספת הווריאציה"),s(!1),a(o)}})),c=(I,j)=>(s(!0),new Promise(async(a,o)=>{try{const h=await hr(I,j);q.success("הווריאציה עודכנה בהצלחה"),s(!1),a(h.data)}catch(h){console.error("Error updating variation:",h),q.error("שגיאה בעדכון הווריאציה"),s(!1),o(h)}})),p=I=>(s(!0),new Promise(async(j,a)=>{try{await gr(I),q.success("הווריאציה נמחקה בהצלחה"),s(!1),j(!0)}catch(o){console.error("Error deleting variation:",o),q.error("שגיאה במחיקת הווריאציה"),s(!1),a(o)}}));return e.jsx(Cs.Provider,{value:{getProductById:C,addProduct:L,updateProduct:N,deleteProduct:_,addSize:R,updateSize:P,deleteSize:v,addVariation:w,updateVariation:c,deleteVariation:p,loading:r,isModalVisible:i,setIsModalVisible:n,modalMode:x,setModalMode:m,selectedItem:u,setSelectedItem:g,selectedUpdateSize:f,setSelectedUpdateSize:S},children:t})};function fr({data:t,type:r,tableKeys:s,mobileKeys:i,openModal:n,Dtitle:x,Dcontent:m,onDelete:u}){const g=Te({query:"(max-width: 500px)"}),[f,S]=d.useState(0),[C,L]=d.useState(1),[N,_]=d.useState(6),[R,P]=d.useState([]),v=(p,I)=>{const j=(p-1)*I,a=j+I;return t.slice(j,a)},w=(p,I)=>{L(p),_(I)};d.useEffect(()=>{S(t.length),P(v(C,N))},[C,N,t]);const c=p=>{fe.confirm({title:x,content:m,okText:"מחק",cancelText:"בטל",onOk:()=>u(p==null?void 0:p._id)})};return g?e.jsx(e.Fragment,{children:e.jsx(ue,{style:{maxHeight:"55vh",overflowY:"auto",minHeight:"80%",height:"80%"},children:e.jsx(cn,{data:t,itemHeight:47,itemKey:"_id",children:p=>{var I,j,a;return e.jsx(ue.Item,{className:"width-100",style:{padding:"0"},children:e.jsxs(le,{className:"width-100 padding-card",style:{margin:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(B,{flex:1,children:e.jsx("strong",{style:{fontSize:"1.3em"},children:p==null?void 0:p.name})}),e.jsxs(B,{flex:1,style:{flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("strong",{children:(I=s==null?void 0:s.find(o=>o.key==="usedCount"))==null?void 0:I.title}),e.jsx("p",{children:p==null?void 0:p.usedCount})]}),(j=s==null?void 0:s.find(o=>o.key==="type"||o.key==="category"))==null?void 0:j.render("",p,"view")]}),s.filter(o=>o.key!=="name"&&o.key!=="type"&&(o==null?void 0:o.key)!=="category"&&(o==null?void 0:o.key)!=="actions"&&(i==null?void 0:i.includes(o==null?void 0:o.key))).map((o,h,b)=>e.jsxs(Pt.Fragment,{children:[e.jsxs("div",{style:{fontSize:"0.9em",display:"flex",justifyContent:"space-between"},children:[o.title&&e.jsxs("strong",{children:[o.title,":"]}),e.jsx("span",{children:o.render?o.render(null,p,"view"):p[o.dataIndex]||"—"})]}),h<2&&e.jsx(Z,{style:{margin:"0.2em"}})]},`${p==null?void 0:p._id}-${o.key}`)),e.jsxs(O,{className:"card-actions",align:"middle",justify:"center",children:[(a=s==null?void 0:s.find(o=>o.key==="actions"))==null?void 0:a.render(null,p),r==="P"&&e.jsx(Z,{type:"vertical"}),e.jsxs(B,{align:"center",justify:"center",children:[e.jsx(T,{type:"text",onClick:()=>c(p),children:e.jsx(D,{icon:Qe})}),e.jsx(T,{type:"text",onClick:()=>n("edit",p),children:e.jsx(D,{icon:Ye})}),e.jsx(T,{type:"text",onClick:()=>n("view",p),children:e.jsx(D,{icon:os})})]})]})]})},p==null?void 0:p._id)}})})}):e.jsxs(B,{flex:1,style:{display:"flex",flexDirection:"column",overflow:"hidden",width:"100%"},children:[e.jsx(B,{flex:1,style:{maxWidth:"100%",maxHeight:r==="P"?"63%":"90%",overflowY:"auto",overflowX:"auto"},children:e.jsx(as,{style:{minWidth:"100%"},columns:s.map(p=>({...p,title:e.jsx(st,{title:p.title,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:p.title})})})),dataSource:R,pagination:!1,direction:"rtl"})}),e.jsx(B,{align:"center",justify:"center",style:{marginTop:"2vh"},children:e.jsx(tn,{current:C,total:f,pageSize:N,onChange:w,style:{direction:"ltr"},showSizeChanger:!0,pageSizeOptions:["6","10","20","50"],locale:sn})})]})}const{Text:Yt}=Y,yr=({value:t=[],onChange:r,ingredientsArr:s=[],fields:i,add:n,remove:x,form:m})=>{var o,h;const[u,g]=d.useState(null),[f,S]=d.useState(!1);d.useState(null),d.useState(null);const[C,L]=d.useState(""),N=d.useRef(null),_=d.useCallback(()=>{setTimeout(()=>{N.current&&N.current.scroll({top:N.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(o=N.current)==null?void 0:o.scrollHeight]),R=(b,E)=>{const y=[...m.getFieldValue("ingredients")||[]];y[u]={...y[u],ingredientId:b,unit:E.unit,name:E.label},L(E.unit)},P=b=>{const F=[...m.getFieldValue("ingredients")||[]];F[u]={...F[u],quantity:b}},v=()=>{const E=a()[u];if(!E||!E.ingredientId||!E.quantity)return;const F=s.find(J=>J._id===E.ingredientId),y={...E,name:(F==null?void 0:F.name)||"---",unit:(F==null?void 0:F.unit)||E.unit,weightOrVolumePerUnit:E.weightOrVolumePerUnit||null},W=[...t,y];r(W),g(null),S(!1)},w=b=>{const E=t.filter((F,y)=>y!==b);r(E),g(null)},c=()=>{f&&w(u),g(null),S(!1)},p=()=>g(null),I=(b,E,F)=>{const y=[...t];if(y[b][E]=F,E==="ingredientId"){const W=s.find(J=>J._id===F);W&&(y[b].unit=W.unit,y[b].name=W.name)}r(y)},j=b=>{switch(b){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}},a=()=>{const b=m==null?void 0:m.getFieldValue("ingredients");return Array.isArray(b)?b:[]};return d.useEffect(()=>{a().length>0&&_()},[(h=m==null?void 0:m.getFieldValue("ingredients"))==null?void 0:h.length]),e.jsxs(e.Fragment,{children:[f?e.jsxs(O,{gutter:16,style:{marginBottom:"1vw"},children:[e.jsxs("div",{className:"flex flex-1 flex-wrap",children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[u,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(ce,{placeholder:"בחר רכיב",filterOption:(b,E)=>{var F;return(F=E==null?void 0:E.label)==null?void 0:F.toLowerCase().includes(b.toLowerCase())},showSearch:!0,options:s==null?void 0:s.map(b=>({value:b._id,label:b.name,unit:b.unit})),onChange:R})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[u,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(de,{onChange:P,addonAfter:j(C),placeholder:"כמות"})})}),C==="units"&&e.jsx(z,{span:14,children:e.jsx(M.Item,{name:[u,"weightOrVolumePerUnit"],rules:[{required:!0,message:"הזן נפח/משקל ליחידה"}],children:e.jsx(de,{placeholder:"נפח/משקל ליחידה",min:0,onChange:b=>I(u,"weightOrVolumePerUnit",b),addonAfter:"קילו/ליטר"})})})]}),e.jsxs(z,{span:4,children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:v}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:c})]})]}):e.jsx(T,{type:"dashed",onClick:()=>{g(t.length),S(!0)},disabled:u!==null,style:{marginBottom:"8px"},children:"הוסף מרכיב"}),e.jsx(le,{ref:N,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:t,renderItem:(b,E)=>{var J;const F=u===E,y=s.find(G=>G._id===b.ingredientId),W=j(b.unit||(y==null?void 0:y.unit));return e.jsx(ue.Item,{children:F&&!f?e.jsxs(O,{gutter:16,style:{marginBottom:"1vw"},children:[e.jsxs("div",{className:"flex flex-1 flex-wrap",children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[E,"ingredientId"],children:e.jsx(ce,{placeholder:"בחר רכיב",value:b.ingredientId||null,onChange:G=>I(E,"ingredientId",G),options:s.map(G=>({value:G._id,label:G.name})),showSearch:!0})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[E,"quantity"],children:e.jsx(de,{placeholder:"כמות",onChange:G=>I(E,"quantity",G),min:0,addonAfter:W,style:{width:"100%"}})})}),b.unit==="units"&&e.jsx(z,{span:14,children:e.jsx(M.Item,{name:[E,"weightOrVolumePerUnit"],rules:[{required:!0,message:"הזן נפח/משקל ליחידה"}],children:e.jsx(de,{placeholder:"נפח/משקל ליחידה (ליטר/גרם)",min:0,style:{width:"100%"},addonAfter:"קילו/ליטר",onChange:G=>I(E,"weightOrVolumePerUnit",G)})})})]}),e.jsxs(z,{children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:p}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:c})]})]}):e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:1,children:e.jsx(Yt,{children:(b==null?void 0:b.name)||((J=b==null?void 0:b.ingredientData)==null?void 0:J.name)||"---"})}),e.jsx(B,{flex:1,children:e.jsxs(Yt,{children:[b.quantity," ",W,b.unit==="units"&&b.weightOrVolumePerUnit?` (${b.weightOrVolumePerUnit} ק"ג/ליטר)`:""]})}),e.jsxs(O,{children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ye}),onClick:()=>g(E)}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Qe}),onClick:()=>w(E)})]})]})},E)}})})]})},we=[{value:"weight",label:"משקל",display:t=>t>=1?'ק"ג':"גרם"},{value:"volume",label:"נפח",display:t=>t>=1?"ליטר":'מ"ל'},{value:"units",label:"יחידות",display:t=>t>1?"יחידות":"יחידה"}],{Option:qe}=ce,{Text:me}=Y,{TextArea:vr}=xe;function wr({mode:t="view",type:r,fields:s=[],onSubmit:i,initialValues:n={},onClose:x,groups:m,tableKeys:u,ingredientsArr:g}){var y,W,J,G,re,ae,ie,k,A;const[f]=M.useForm(),[S]=M.useForm(),[C]=M.useForm(),L=V(l=>{var $,H;return(H=($=l.settings.settings)==null?void 0:$.hourlyRate)==null?void 0:H.value}),[N,_]=d.useState(0),[R,P]=d.useState(["process","wait"]),[v,w]=d.useState({}),[c,p]=d.useState(n),[I,j]=d.useState(n.unit||null),[a,o]=d.useState(n.subUnit||null),h=l=>{console.log("onChange:",l),_(l)},b=async l=>{let $=l.quantity;x&&x(),(l.subUnit==="g"||l.subUnit==="ml")&&($=l.quantity/1e3);const H={...n,...v,...l,quantity:$};i&&await i(H),await S.resetFields(),await C.resetFields()};d.useEffect(()=>{if(n){const l=n.quantity<1?n.quantity*1e3:n.quantity;f.setFieldsValue({...n,quantity:l}),j(n.unit),o(n.subUnit||"kg")}},[n,f]);const E=(l,$)=>l.map(H=>{const{key:K,title:he,type:Ne,options:Re,rules:ve,props:ke,hiddenInForm:U,coin:ne,divider:ee}=H;if(U)return null;switch(Ne){case"text":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(xe,{...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"number":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve==null?void 0:ve.map(Q=>Q.validator?{...Q,validator:(se,oe)=>Q.validator(se,oe,n)}:Q),validateTrigger:"onSubmit",children:e.jsx(de,{suffix:ne&&"₪",min:0,style:{width:"100%"},...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"float":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(de,{suffix:ne&&"₪",min:0,step:.01,style:{width:"100%"},...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"select":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(ce,{...ke,showSearch:!0,onChange:Q=>{K==="unit"&&(j(Q),p(se=>({...se,unit:Q,subUnit:void 0})),$.setFieldsValue({subUnit:void 0}))},children:Re.map(Q=>e.jsx(qe,{value:Q.value,children:Q.label},Q.value))})},K),e.jsx(M.Item,{noStyle:!0,shouldUpdate:(Q,se)=>Q.unit!==se.unit,children:()=>{const Q=c==null?void 0:c.unit,se=c==null?void 0:c.subUnit;return K==="unit"&&(Q==="weight"||Q==="volume")?e.jsx(M.Item,{name:"subUnit",initialValue:se||(Q==="weight"?(c==null?void 0:c.quantity)>=1?"kg":"g":(c==null?void 0:c.quantity)>=1?"liter":"ml"),validateTrigger:"onSubmit",label:Q==="weight"?'בחר יחידת משקל (ק"ג / גרם)':'בחר יחידת נפח (ליטר / מ"ל)',rules:[{required:!0,message:"אנא בחר יחידת משנה"}],children:e.jsx(ce,{onChange:oe=>p(ut=>({...ut,subUnit:oe})),children:Q==="weight"?e.jsxs(e.Fragment,{children:[e.jsx(qe,{value:"kg",children:'ק"ג'}),e.jsx(qe,{value:"g",children:"גרם"})]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{value:"liter",children:"ליטר"}),e.jsx(qe,{value:"ml",children:'מ"ל'})]})})}):null}}),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"ingredientsManager":return e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"0.5em"}}),e.jsx(M.List,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:(Q,{add:se,remove:oe})=>e.jsx(yr,{fields:Q,add:se,form:$,remove:oe,value:$.getFieldValue(K),onChange:ut=>$.setFieldsValue({[K]:ut}),ingredientsArr:g})},K)]});case"price":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:"withVATFlag",initialValue:!0,valuePropName:"checked",validateTrigger:"onSubmit",children:e.jsx(Be,{onChange:()=>{p(Q=>({...Q,price:void 0,priceExcludingVAT:void 0}))},children:'עלות כולל מע"מ'})},"withVATFlag"),e.jsx(M.Item,{noStyle:!0,validateTrigger:"onSubmit",shouldUpdate:(Q,se)=>Q.withVATFlag!==se.withVATFlag,children:({getFieldValue:Q})=>Q("withVATFlag")?e.jsx(M.Item,{name:"price",label:'עלות (כולל מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(de,{addonAfter:"₪",onChange:se=>{p(oe=>({...oe,priceExcludingVAT:void 0,price:se}))},style:{width:"100%"}})},"price"):e.jsx(M.Item,{name:"priceExcludingVAT",label:'עלות (ללא מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(de,{style:{width:"100%"},addonAfter:"₪",onChange:se=>{p(oe=>({...oe,price:void 0,priceExcludingVAT:se}))}})},"priceExcludingVAT")})]});case"custom":return e.jsxs(e.Fragment,{children:[H.render&&H.render("",n,"edit",$),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"textArea":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(vr,{style:{resize:"none"},showCount:!0,maxLength:H==null?void 0:H.maxLength})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});default:return null}});if(t==="view")switch(r){case"mix":return e.jsxs("div",{children:[e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(y=u==null?void 0:u.find(l=>l.key==="type"))==null?void 0:y.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(W=u==null?void 0:u.find(l=>l.key==="is_active"))==null?void 0:W.render("",n,"view")}),e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",n==null?void 0:n.totalCost]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(ds,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.preparationTime," דקות"]})]})]}),e.jsxs(le,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs("div",{style:{margin:"12px 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["עלות עבודה (₪)",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.laborCost," (₪",L,")"]})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["עלות ל-100 גרם (₪)",":"]})}),e.jsx(B,{children:e.jsx("p",{style:{},children:(J=u==null?void 0:u.find(l=>l.key==="unitCost"))==null?void 0:J.render("",n,"view")})})]})]}),e.jsxs(le,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:[e.jsx(me,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0",maxHeight:"5vw",overflow:"auto"},children:(G=n==null?void 0:n.ingredients)==null?void 0:G.map((l,$)=>{var K;const H=(()=>{switch(l==null?void 0:l.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(me,{children:[(K=g==null?void 0:g.find(he=>(he==null?void 0:he._id)===(l==null?void 0:l.ingredientId)))==null?void 0:K.name," -"," ",l.quantity," ",H," - ₪",l==null?void 0:l.costForQuantity]})},$)})})]})]});case"ingredient":return e.jsxs("div",{children:[e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(re=u==null?void 0:u.find(l=>l.key==="type"))==null?void 0:re.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(Y.Text,{strong:!0,children:n==null?void 0:n.SKU})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(ae=u==null?void 0:u.find(l=>l.key==="is_active"))==null?void 0:ae.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(ie=u==null?void 0:u.find(l=>l.key==="supplierId"))==null?void 0:ie.render("",n,"view")}),e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(z,{children:[e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.priceExcludingVAT,' (ללא מע"מ)']}),e.jsxs(Y.Text,{style:{fontSize:"1em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.price,' (כולל מע"מ)']})]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(D,{icon:un}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.quantity," ",we.find(l=>l.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)]})]})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["כמות מינימלית",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:[n==null?void 0:n.unitQuantity," ",we.find(l=>l.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)," - ₪",n==null?void 0:n.unitPrice]})})]}),(n==null?void 0:n.juiceRatio)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["יחס עיבוד",":"]})}),e.jsx(B,{children:e.jsx("p",{style:{},children:(k=u==null?void 0:u.find(l=>l.key==="juiceRatio"))==null?void 0:k.render("",n,"view")})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["מחיר ליחידה מעובדת",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.processedPrice]})})]})]}),(n==null?void 0:n.notes)&&e.jsx(le,{type:"inner",style:{backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:e.jsxs(z,{children:[e.jsx(O,{style:{marginBottom:"4px"},children:e.jsxs(me,{strong:!0,style:{fontSize:"1.2em",color:"#333"},children:["הערות",":"]})}),e.jsx(Y.Text,{style:{fontSize:"1em",color:"#555"},children:n==null?void 0:n.notes})]})})]});default:return e.jsxs("div",{style:{},children:[e.jsxs(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name}),(A=u==null?void 0:u.find(l=>l.key==="type"))==null?void 0:A.render("",n,"view")]}),u==null?void 0:u.filter(l=>l.key!=="type"&&(l==null?void 0:l.key)!=="name"&&!l.column).map((l,$,H)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:[l.title,":"]})}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:(l==null?void 0:l.render)&&(l==null?void 0:l.render("",n,t,"view"))||n[l.key]||"—"})})]},l.key),$<(H==null?void 0:H.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]})),u==null?void 0:u.filter(l=>l.column).map((l,$,H)=>e.jsxs(e.Fragment,{children:[$===0&&e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[e.jsxs(me,{strong:!0,style:{fontSize:"1.4em"},children:[l.title,":"]}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:(l==null?void 0:l.render)&&(l==null?void 0:l.render("",n,t,"view"))||n[l.key]||"—"})})]},l.key),$<(H==null?void 0:H.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]}))]})}const F=[{title:"מידע",icon:e.jsx(cs,{}),content:e.jsxs(M,{form:S,layout:"vertical",onValuesChange:(l,$)=>{p(H=>({...H,...l}))},onFinish:async l=>{await S.validateFields(),p({...c,...l}),_(N+1)},initialValues:n,children:[E(s==null?void 0:s.filter(l=>l.group===1),S),m&&!(n!=null&&n._id)&&e.jsx(T,{type:"primary",htmlType:"submit",children:"הבא"}),t!=="add"&&e.jsx(T,{type:"primary",onClick:()=>b(c),children:"עדכן"})]})},{title:"עלויות",icon:e.jsx(vn,{}),content:e.jsxs(M,{layout:"vertical",form:C,onValuesChange:(l,$)=>{p(H=>({...H,...l}))},onFinish:l=>{const $={...c,...l};p($),i&&i($)},initialValues:n,children:[E(s==null?void 0:s.filter(l=>l.group===2),C),m&&!(n!=null&&n._id)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"24px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[N>0&&e.jsx(T,{onClick:()=>_(N-1),children:"הקודם"}),e.jsx(T,{type:"primary",htmlType:"submit",children:t!=="add"?"עדכן":"סיום"})]})]}),t!=="add"&&e.jsx(T,{type:"primary",onClick:()=>{console.log(C==null?void 0:C.getFieldsValue()),b(c)},children:"עדכן"})]})}];return e.jsxs(e.Fragment,{children:[m&&!(n!=null&&n._id)&&e.jsx(B,{wrap:"wrap",justify:"space-between",align:"center",style:{gap:"8px"},children:e.jsx(Dt,{current:N,onChange:h,status:R[N],style:{width:"100%"},children:F==null?void 0:F.map((l,$)=>e.jsx(Dt.Step,{title:l.title,icon:l.icon},$))})}),m&&(n==null?void 0:n._id)&&e.jsx(B,{flex:1,wrap:"wrap",justify:"center",align:"center",style:{gap:"8px"},children:e.jsx(be,{current:N,onChange:h,status:R[N],style:{width:"100%"},children:F==null?void 0:F.map((l,$)=>e.jsx(be.TabPane,{tab:l.title,icon:l.icon},$))})}),m&&F[N].content,!m&&e.jsxs(M,{form:f,layout:"vertical",onFinish:b,onValuesChange:l=>{console.log(l)},initialValues:n,children:[!m&&E(s,f),t!=="view"&&(!m||m&&(n==null?void 0:n._id))&&e.jsx(M.Item,{children:e.jsx(T,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"1vw"},children:t==="add"?"הוסף":"עדכן"})})]})]})}function br({open:t,onClose:r,filters:s,setFilters:i,filtersArr:n}){var C,L,N,_,R,P,v;const[x,m]=d.useState({type:s.type||[],supplierId:s.supplierId||[],is_active:s.is_active}),u=w=>{m(c=>({...c,[w]:w==="is_active"?null:[]}))},g=()=>{const w=Object.entries(x).reduce((c,[p,I])=>((Array.isArray(I)&&I.length>0||typeof I=="boolean")&&(c[p]=I),c),{});i(w),r()},f=w=>{const c=w==="all"?null:w==="true";m(p=>({...p,is_active:c}))},S=({options:w,filterKey:c})=>{const p=I=>{m(j=>{const a=j[c]||[],o=a.includes(I)?a.filter(h=>h!==I):[...a,I];return{...j,[c]:o}})};return e.jsxs("div",{children:[e.jsx("div",{className:"sticky top-0 bg-white p-2 border-b",children:e.jsx(T,{type:"link",className:"w-full text-left",onClick:()=>u(c),children:"איפוס בחירה"})}),e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",padding:"8px"},onScroll:I=>I.stopPropagation(),children:w.map(I=>e.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:e.jsx(Be,{checked:(x[c]||[]).includes(I.value),onChange:()=>p(I.value),children:I.label})},I.value))})]})};return e.jsxs(is,{title:"סינון רכיבים",placement:"right",onClose:r,open:t,width:360,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"קטגוריה"}),e.jsx(Ut,{content:e.jsx(S,{options:((C=n.find(w=>w.value==="type"))==null?void 0:C.options)||[],filterKey:"type"}),trigger:"click",getPopupContainer:w=>w.parentElement,children:e.jsxs(T,{style:{width:"100%"},type:"dashed",children:[(((L=x.type)==null?void 0:L.length)||0)>0?`${(N=x.type)==null?void 0:N.length} נבחרו`:"בחר קטגוריות",e.jsx(Wt,{style:{marginLeft:"8px"}})]})})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"ספק"}),e.jsx(Ut,{content:e.jsx(S,{options:((_=n.find(w=>w.value==="supplierId"))==null?void 0:_.options)||[],filterKey:"supplierId"}),trigger:"click",getPopupContainer:w=>w.parentElement,children:e.jsxs(T,{style:{width:"100%"},type:"dashed",children:[(((R=x.supplierId)==null?void 0:R.length)||0)>0?`${(P=x.supplierId)==null?void 0:P.length} נבחרו`:"בחר ספקים",e.jsx(Wt,{style:{marginLeft:"8px"}})]})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"סטטוס"}),e.jsx(ce,{style:{width:"100%"},value:((v=x.is_active)==null?void 0:v.toString())||"all",onChange:f,options:[{label:"הכל",value:"all"},{label:"פעיל",value:"true"},{label:"לא פעיל",value:"false"}]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(T,{onClick:()=>m({type:[],supplierId:[],is_active:null}),children:"איפוס הכל"}),e.jsx(T,{type:"primary",onClick:g,children:"החל סינון"})]})]})}const{Search:Cr}=xe;function rt({title:t,titleView:r,dataPrint:s,data:i,groups:n,tableKeys:x,newTitle:m,setDataPrint:u,searchKeys:g,sortKeys:f,mobileKeys:S,Dtitle:C,Dcontent:L,onAdd:N,onEdit:_,onDelete:R,width:P,ingredientsArr:v,iconADD:w,floatAction:c,type:p,openModalProduct:I,filters:j,saveFilters:a,filtersArr:o}){const[h,b]=d.useState([]),[E,F]=d.useState(!1),[y,W]=d.useState(!1),[J,G]=d.useState("add"),[re,ae]=d.useState(null),[ie,k]=d.useState(!1),[A,l]=d.useState(j),$=Te({query:"(max-width: 500px)"}),H=f.map(U=>({key:U==null?void 0:U.key,label:e.jsx("span",{className:"width-100",onClick:()=>{const ne=[...s].sort((ee,Q)=>{const se=ee[U==null?void 0:U.key],oe=Q[U==null?void 0:U.key];return typeof se=="number"&&typeof oe=="number"?oe-se:se==null?void 0:se.toString().localeCompare(oe==null?void 0:oe.toString())});u(ne)},children:U==null?void 0:U.title})})),K=U=>{if(U==="all")b(x);else{let ne=h.findIndex(Q=>Q.key===U),ee=[...h];ne!==-1?ee=ee.filter(Q=>Q.key!==U):ee=[...ee,x.find(Q=>Q.key===U)],b(ee)}},he=[{key:"all",label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:h.length===x.length,disabled:h.length===x.length,onChange:()=>K("all"),onClick:U=>U.stopPropagation(),children:"הכל"})},...x.filter(U=>!(U!=null&&U.required)).map(({title:U,dataIndex:ne})=>({key:ne,label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:h.some(ee=>ee.key===ne),disabled:h.length<=3&&h.some(ee=>ee.key===ne),onChange:()=>K(ne),onClick:ee=>ee.stopPropagation(),children:U})}))],Ne=(U,ne=null)=>{if(p==="P")return I(U,ne);G(U),ae(ne),W(!0)},Re=()=>{W(!1),ae(null)},ve=U=>{fe.confirm({title:C,content:L,okText:"מחק",cancelText:"בטל",onOk:()=>R(U==null?void 0:U._id)})},ke=()=>{let U=[...i];Object.entries(j).forEach(([ne,ee])=>{if(ee!=null)switch(ne){case"search":U=U.filter(Q=>g.some(se=>{var oe;return(oe=Q[se])==null?void 0:oe.toString().toLowerCase().includes(ee.toLowerCase())}));break;case"is_active":U=U.filter(Q=>Q.is_active===ee);break;case"type":case"supplierId":Array.isArray(ee)&&(U=U.filter(Q=>ee.includes(Q[ne])));break}}),u(U)};return d.useEffect(()=>{j&&(ke(),l(j))},[j]),d.useEffect(()=>{b(x)},[x]),e.jsxs(B,{flex:1,vertical:!0,style:{maxWidth:"100%"},gap:"1em",className:"container",children:[$&&e.jsx(O,{justify:"center",children:e.jsxs(Y.Title,{level:3,style:{margin:"0"},children:[w," ",t]})}),e.jsxs(O,{align:"middle",style:{flexFlow:""},justify:"space-between",children:[!$&&e.jsx(O,{align:"",children:e.jsxs(Y.Title,{level:3,style:{margin:"0"},children:[w," ",t]})}),e.jsx(O,{style:{},children:e.jsx(Cr,{placeholder:"חיפוש ...",allowClear:!0,onChange:({target:U})=>{u(i==null?void 0:i.filter(ne=>g.some(ee=>{var Q,se,oe;return(oe=(se=(Q=ne[ee])==null?void 0:Q.toString())==null?void 0:se.toLowerCase())==null?void 0:oe.includes(U.value.toLowerCase())})))},style:{width:200}})}),e.jsxs(O,{style:{gap:"0.5em"},children:[o&&e.jsxs(T,{onClick:()=>k(!0),children:[e.jsx(wn,{}),!$&&"סינון","(",Object.keys(j).length,")"]}),!$&&e.jsx(e.Fragment,{children:e.jsx(Ht,{menu:{items:he},trigger:["click"],open:E,onOpenChange:U=>F(U),children:e.jsxs(T,{children:[e.jsx(D,{icon:xn,style:{marginLeft:"8px"}}),$?e.jsx(e.Fragment,{children:`${h.length} / ${x.length}`}):e.jsx(e.Fragment,{children:`בחרת ${h.length} מתוך ${x.length}`})]})})}),e.jsx(Ht,{menu:{items:H},trigger:["click"],children:e.jsxs(T,{type:$?"link":"default",children:[e.jsx(D,{icon:pn,style:{marginLeft:"8px"}}),"מיון"]})}),!$&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{type:"vertical",style:{height:"auto"}}),e.jsx(O,{style:{},children:e.jsx(T,{onClick:()=>Ne("add"),type:"primary",children:m})})]})]})]}),e.jsxs(jt.Group,{trigger:"click",type:"primary",icon:e.jsx(D,{icon:mn}),children:[e.jsx(jt,{type:"primary",onClick:()=>Ne("add"),icon:w}),c==null?void 0:c.map((U,ne)=>e.jsx(Pt.Fragment,{children:U},`float-action-${ne}`))]}),e.jsx(fr,{data:s,tableKeys:[{title:"פעולות",key:"action",minWidth:130,maxWidth:130,render:(U,ne)=>e.jsxs(O,{className:"card-actions",align:"middle",justify:"center",style:{maxWidth:130},children:[e.jsx(T,{type:"text",onClick:()=>ve(ne),children:e.jsx(D,{icon:Qe})}),e.jsx(T,{type:"text",onClick:()=>Ne("edit",ne),children:e.jsx(D,{icon:Ye})}),e.jsx(T,{type:"text",onClick:()=>Ne("view",ne),children:e.jsx(D,{icon:os})})]})},...h],openModal:Ne,mobileKeys:S,type:p,Dtitle:C,Dcontent:L,onDelete:R}),ie&&e.jsx(br,{open:ie,onClose:()=>k(!1),filtersArr:o,filters:A,setFilters:U=>{l(U),a(U),ke()}}),e.jsx(fe,{style:{top:$?"3em":""},title:J==="add"?`הוסף ${r} חדש`:J==="edit"?`ערוך ${r}`:`צפייה ב${r}`,open:y,onCancel:Re,footer:null,destroyOnClose:!0,width:$?"100%":P||600,children:p!=="P"&&e.jsx(wr,{mode:J,groups:n,type:p,tableKeys:h,ingredientsArr:v,fields:x.filter(U=>U.editable||J==="view"),onSubmit:U=>{J==="add"&&N(U),J==="edit"&&_({...re,...U}),Re()},initialValues:re||{},onClose:Re})})]})}const at="https://menu-server-c2b952e2c698.herokuapp.com/api",Sr=t=>X.post(`${at}/categories`,t),Ir=t=>{const r=encodeURIComponent(t._id);return X.put(`${at}/categories/${r}`,t)},Nr=t=>X.delete(`${at}/categories/${t}`),kr=()=>X.get(`${at}/categories`),Is=d.createContext(),Fr=()=>d.useContext(Is),Pr=({children:t})=>{const[r,s]=d.useState(!1),i=async m=>{s(!0);try{await Sr(m),q.success("הקטגוריה נוספה בהצלחה"),s(!1)}catch(u){console.error("Error adding category:",u),q.error("שגיאה בהוספת הקטגוריה"),s(!1)}},n=async m=>{s(!0);try{await Ir(m),q.success("הקטגוריה עודכנה בהצלחה"),s(!1)}catch(u){console.error("Error updating category:",u),q.error("שגיאה בעדכון הקטגוריה"),s(!1)}},x=async m=>{s(!0);try{await Nr(m),q.success("הקטגוריה נמחקה בהצלחה"),s(!1)}catch(u){console.error("Error deleting category:",u),q.error("שגיאה במחיקת הקטגוריה"),s(!1)}};return e.jsx(Is.Provider,{value:{addCategory:i,updateCategory:n,deleteCategory:x,loading:r},children:t})},{Title:Jt,Text:_r}=Y,Tr=({isCategoryModalVisible:t,setIsCategoryModalVisible:r})=>{const{addCategory:s,updateCategory:i,deleteCategory:n}=Fr(),x=V(v=>v.categories),[m,u]=d.useState(""),[g,f]=d.useState(null),[S,C]=d.useState(""),L=()=>{if(m.trim()===""){C("אנא הזן שם קטגוריה תקין");return}if(x.some(v=>v.name===m.trim()&&v!==g)){C("קטגוריה זו כבר קיימת");return}g?i({...g,name:m.trim()}):s({name:m.trim()}),u(""),f(null),C("")},N=v=>{f(v),u(v.name)},_=()=>{if(m.trim()===""){C("אנא הזן שם קטגוריה תקין");return}i({...g,name:m.trim()}),u(""),f(null),C("")},R=v=>{n(v)},P=()=>{u(""),f(null),C(""),r(!1)};return e.jsxs(fe,{title:g?"ערוך קטגוריה":"הוסף קטגוריה חדשה",open:t,onCancel:P,footer:null,className:"category-modal popup-modal",children:[e.jsxs("div",{className:"category-form-section",children:[e.jsx(Jt,{level:4,children:g?"ערוך קטגוריה":"הוסף קטגוריה חדשה"}),e.jsx(xe,{placeholder:"הזן שם קטגוריה",value:m,onChange:v=>u(v.target.value),onPressEnter:L}),S&&e.jsx(_r,{type:"danger",className:"error-message",children:S}),e.jsx(T,{type:"primary",onClick:L,style:{marginTop:"10px"},children:g?"עדכן קטגוריה":"הוסף קטגוריה"})]}),e.jsxs("div",{className:"category-list-section",children:[e.jsx(Jt,{level:4,style:{marginTop:"20px"},children:"קטגוריות קיימות:"}),e.jsx(ue,{dataSource:x,renderItem:v=>e.jsx(ue.Item,{className:g&&g._id===v._id?"editing-item":"",actions:[g&&g._id===v._id?e.jsx(T,{type:"link",onClick:_,children:"שמור"}):e.jsx(T,{type:"link",onClick:()=>N(v),children:"ערוך"}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את הקטגוריה?",onConfirm:()=>R(v._id),okText:"כן",cancelText:"לא",children:e.jsx(T,{icon:e.jsx(_e,{}),type:"text",danger:!0})})],children:g&&g._id===v._id?e.jsx(xe,{value:m,onChange:w=>u(w.target.value),onPressEnter:_,autoFocus:!0}):v.name})})]})]})},{Text:Gt}=Y,Er=({ingredients:t,sizes:r,add:s,remove:i,indexSize:n,form:x,onChange:m,getUnitDisplay:u,setDisabledSave:g})=>{var re,ae,ie;const f=d.useRef(null),[S,C]=d.useState(null),[L,N]=d.useState(!1),[_,R]=d.useState(!1),[P,v]=d.useState(null),[w,c]=d.useState(null),[p,I]=d.useState(""),j=d.useCallback(()=>{setTimeout(()=>{f.current&&f.current.scroll({top:f.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(re=f.current)==null?void 0:re.scrollHeight]),a=k=>{C(k),g(!0)},o=()=>{C(null),g(!1),R(!1),N(!1),I("")},h=()=>{x.validateFields().then(()=>{C(null),g(!1),R(!1),N(!1),I("")})},b=k=>{const A=[...r];A[n]={...A[n],ingredients:k},m(A)},E=(k,A)=>{v({ingredientId:k,unit:A.unit,name:A.label})},F=k=>{c(k)},y=()=>{if(!P||!w)return;const k={...P,quantity:w},l=[...x.getFieldValue("ingredients")||[],k];x.setFieldsValue({ingredients:l}),b(l),v(null),c(null),R(!1),C(null),g(!1),N(!1)},W=k=>{const l=(x.getFieldValue("ingredients")||[]).filter(($,H)=>H!==k);x.setFieldsValue({...l}),b(l),i(k)},J=k=>{if(!k)return"";if(k.name)return k.name;if(k.ingredientId&&t){const A=t.find(l=>l._id===k.ingredientId);return(A==null?void 0:A.name)||""}return""},G=()=>{const k=x.getFieldValue("ingredients");return Array.isArray(k)?k:[]};return d.useEffect(()=>{G().length>0&&j()},[(ae=x.getFieldValue("ingredients"))==null?void 0:ae.length]),e.jsxs(e.Fragment,{children:[_?e.jsxs(O,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsxs(z,{span:10,children:[" ",e.jsx(ce,{placeholder:"בחר רכיב",style:{width:"100%"},filterOption:(k,A)=>{var l;return(l=A==null?void 0:A.label)==null?void 0:l.toLowerCase().includes(k.toLowerCase())},showSearch:!0,options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:E})]}),e.jsxs(z,{span:10,children:[" ",e.jsx(de,{onChange:F,addonAfter:u((P==null?void 0:P.unit)||""),placeholder:"כמות",style:{width:"100%"}})]}),e.jsxs(z,{children:[" ",e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:y}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:o})]})]}):e.jsx(T,{type:"dashed",onClick:()=>{R(!0),N(!0),C(G().length),g(!0)},disabled:S!==null,children:"הוסף מרכיב"}),e.jsx(le,{ref:f,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:(ie=r[n])==null?void 0:ie.ingredients,renderItem:(k,A)=>{var l;return e.jsx(ue.Item,{children:S!==A?e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:2,children:e.jsx(Gt,{children:J(k)})}),e.jsx(B,{flex:1,children:e.jsxs(Gt,{children:[k==null?void 0:k.quantity," ",u(k==null?void 0:k.unit)]})}),e.jsxs(z,{children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ye}),onClick:()=>a(A)}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Qe}),onClick:()=>W(A)})]})]}):!L&&e.jsxs(O,{style:{width:"100%"},gutter:16,children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((l=k.ingredientId)==null?void 0:l._id)||k.ingredientId,children:e.jsx(ce,{placeholder:"בחר רכיב",showSearch:!0,filterOption:($,H)=>{var K;return(K=H==null?void 0:H.label)==null?void 0:K.toLowerCase().includes($.toLowerCase())},options:t==null?void 0:t.map($=>({value:$._id,label:$.name,unit:$.unit})),onChange:E})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(de,{addonAfter:u(k==null?void 0:k.unit),onChange:F})})}),e.jsxs(z,{span:4,children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:h}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:o})]})]})},A)}})})]})},{Text:Xt}=Y,$r=({mixes:t,sizes:r,add:s,remove:i,indexSize:n,form:x,onChange:m,getUnitDisplay:u,setDisabledSave:g})=>{var re,ae,ie;const f=d.useRef(null),[S,C]=d.useState(null),[L,N]=d.useState(!1),[_,R]=d.useState(!1),[P,v]=d.useState(null),[w,c]=d.useState(null),[p,I]=d.useState(""),j=d.useCallback(()=>{setTimeout(()=>{f.current&&f.current.scroll({top:f.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(re=f.current)==null?void 0:re.scrollHeight]),a=k=>{C(k),g(!0)},o=()=>{C(null),g(!1),R(!1),N(!1),I("")},h=()=>{x.validateFields().then(()=>{C(null),g(!1),R(!1),N(!1),I("")})},b=k=>{const A=[...r];A[n]={...A[n],mixes:k},m(A)},E=(k,A)=>{v({mixId:k,unit:(A==null?void 0:A.unit)||"weight",name:A.label})},F=k=>{c(k)},y=()=>{if(!P||!w)return;const k={...P,quantity:w},l=[...x.getFieldValue("mixes")||[],k];x.setFieldsValue({mixes:l}),b(l),v(null),c(null),R(!1),I(""),C(null),g(!1),N(!1)},W=k=>{const l=(x.getFieldValue("mixes")||[]).filter(($,H)=>H!==k);x.setFieldsValue({...l}),b(l),i(k)},J=k=>{if(!k)return"";if(k.name)return k.name;if(k.mixId&&t){const A=t.find(l=>l._id===k.mixId);return(A==null?void 0:A.name)||""}return""},G=()=>{const k=x.getFieldValue("mixes");return Array.isArray(k)?k:[]};return d.useEffect(()=>{G().length>0&&j()},[(ae=x.getFieldValue("mixes"))==null?void 0:ae.length]),e.jsxs(e.Fragment,{children:[_?e.jsxs(O,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsx(z,{span:10,children:e.jsx(ce,{placeholder:"בחר רכיב",filterOption:(k,A)=>{var l;return(l=A==null?void 0:A.label)==null?void 0:l.toLowerCase().includes(k.toLowerCase())},showSearch:!0,style:{width:"100%"},options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:E})}),e.jsx(z,{span:10,children:e.jsx(de,{onChange:F,addonAfter:u(p),placeholder:"כמות",style:{width:"100%"}})}),e.jsxs(z,{children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:y}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:o})]})]}):e.jsx(T,{type:"dashed",onClick:()=>{R(!0),N(!0),C(G().length),g(!0)},disabled:S!==null,children:"הוסף מרכיב"}),e.jsx(le,{ref:f,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:(ie=r[n])==null?void 0:ie.mixes,renderItem:(k,A)=>{var l;return e.jsx(ue.Item,{children:S!==A?e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:1,children:e.jsx(Xt,{children:J(k)})}),e.jsx(B,{flex:1,children:e.jsxs(Xt,{children:[k==null?void 0:k.quantity," ",u(k==null?void 0:k.unit)]})}),e.jsxs(O,{children:[e.jsx(T,{type:"text",onClick:()=>a(A),children:e.jsx(D,{icon:Ye})}),e.jsx(T,{type:"text",onClick:()=>W(A),children:e.jsx(D,{icon:Qe})})]})]}):!L&&e.jsxs(e.Fragment,{children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"mixId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((l=k.mixId)==null?void 0:l._id)||k.mixId,children:e.jsx(ce,{placeholder:"בחר רכיב",showSearch:!0,filterOption:($,H)=>{var K;return(K=H==null?void 0:H.label)==null?void 0:K.toLowerCase().includes($.toLowerCase())},options:t==null?void 0:t.map($=>({value:$._id,label:$.name,unit:$.unit})),onChange:E})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(de,{addonAfter:u(k==null?void 0:k.unit),onChange:F})})}),e.jsxs(z,{span:4,children:[e.jsx(T,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:h}),e.jsx(T,{type:"text",icon:e.jsx(D,{icon:Ae}),onClick:o})]})]})},A)}})})]})};function Ar({size:t,sizes:r,indexSize:s,handleCancelEdit:i,handleRemoveSize:n,newSizeId:x,form:m,ingredients:u,mixes:g,onChange:f,getUnitDisplay:S,activeSubTab:C,setActiveSubTab:L,setNewSizeId:N,onSubmit:_}){var w,c;const[R,P]=d.useState(!1),v=async()=>{var p;try{const I=await m.validateFields();N(null),f(r==null?void 0:r.map((j,a)=>a===s?{...j,...I,edit:!1}:j)),_(I)}catch(I){const a=(p=I.errorFields[0])==null?void 0:p.name;a!=null&&a.includes("ingredients")?L("1"):a!=null&&a.includes("mixes")&&L("2")}};return e.jsxs("div",{className:t.idNew===x?"highlight-new":"",style:{border:`1px ${t!=null&&t.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(O,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsxs(B,{flex:2,children:[e.jsx(M.Item,{name:["_id"],hidden:!0,children:e.jsx(xe,{})}),e.jsx(M.Item,{name:["label"],label:"שם הגודל",rules:[{required:!0,message:"חייב למלא שם גודל"},{min:1,message:"שם גודל חייב להיות לפחות 1 תווים"},{max:25,message:"שם גודל לא יכול לחרוג מ-25 תווים"}],children:e.jsx(xe,{placeholder:"שם הגודל",size:"middle",showCount:!0,style:{width:"auto",minWidth:"200px"},maxLength:25})})]}),e.jsxs(B,{flex:1,style:{alignSelf:"flex-start"},justify:"end",children:[e.jsx(T,{type:"text",icon:e.jsx($t,{}),onClick:()=>i(s)}),e.jsx(T,{type:"text",danger:!0,icon:e.jsx(_e,{}),title:"מחק גודל",onClick:()=>n(s)})]})]}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{span:12,children:e.jsx(M.Item,{name:["price"],label:"מחיר",rules:[{required:!0,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(de,{placeholder:"מחיר",style:{width:"100%"},addonAfter:"₪"})})}),e.jsx(z,{span:12,children:e.jsx(M.Item,{label:"זמן הכנה (דקות)",name:["preparationTime"],rules:[{required:!0,message:"חייב לציין זמן הכנה"}],children:e.jsx(de,{placeholder:"זמן הכנה",style:{width:"100%"},addonAfter:e.jsx(D,{style:{fontSize:"0.9em"},icon:Tt})})})})]}),e.jsxs(be,{activeKey:C,onChange:p=>L(p),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:[e.jsxs(Bt,{tab:`מרכיבים (${((w=t==null?void 0:t.ingredients)==null?void 0:w.length)||0})`,children:[e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx(M.List,{name:["ingredients"],children:(p,{add:I,remove:j})=>e.jsx(Er,{add:I,remove:j,fields:p,form:m,indexSize:s,setDisabledSave:P,ingredients:u,onChange:f,getUnitDisplay:S,sizes:r})})]},1),e.jsxs(Bt,{tab:`מתכונים (${((c=t==null?void 0:t.mixes)==null?void 0:c.length)||0})`,children:[e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מתכונים:"}),e.jsx(M.List,{name:["mixes"],children:(p,{add:I,remove:j})=>e.jsx($r,{add:I,remove:j,fields:p,form:m,indexSize:s,setDisabledSave:P,mixes:g,onChange:f,getUnitDisplay:S,sizes:r})})]},2)]}),e.jsx(T,{type:"primary",htmlType:"submit",disabled:R,onClick:()=>v(),children:"שמור"})]},t.idNew||s)}const{Text:Vt}=Y;function Ns({size:t,index:r,sizeInfo:s,type:i,handleEditSize:n,handleRemoveSize:x,ingredients:m,mixes:u,sizeSummary:g,priceExcludingVAT:f}){const S=Te({query:"(max-width: 500px)"}),C=V(_=>{var R,P;return(P=(R=_.settings.settings)==null?void 0:R.hourlyRate)==null?void 0:P.value}),L=(_,R)=>{const P=_;if(!P)return null;const v=R;return e.jsx(O,{children:e.jsxs(B,{flex:1,style:{flexDirection:"column"},children:[e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:'מחיר ללא מע"מ:'}),e.jsxs(Y.Text,{style:{marginRight:8},children:["₪",v," (₪",((t==null?void 0:t.price)-v).toFixed(2),")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"סך הכל עלות:"}),e.jsxs(Y.Text,{style:{marginRight:8},children:["₪",P==null?void 0:P.totalCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"אחוז רווח:"}),e.jsx(nn,{percent:P==null?void 0:P.profitMargin})]}),i!=="P"&&e.jsxs(le,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs(O,{justify:"space-between",style:{marginTop:"1vh"},children:[e.jsx(Y.Text,{strong:!0,children:"עלות עבודה:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.laborCost," (₪",C,")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות מרכיבים:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.ingredientCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות מתכונים:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.mixCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות הוצאות קבועות:"}),e.jsx(Y.Text,{children:"₪"})]})]})]})})},N=({type:_,size:R,ingredients:P,mixes:v})=>{const[w,c]=d.useState("ingredients"),p=()=>{var a;const j=(a=R==null?void 0:R.ingredients)==null?void 0:a.map(o=>{var E;const h=(()=>{switch(o==null?void 0:o.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((E=P==null?void 0:P.find(F=>(F==null?void 0:F._id)===(o==null?void 0:o.ingredientId)))==null?void 0:E.name)||"לא ידוע",quantity:o==null?void 0:o.quantity,unitDisplay:h,cost:o==null?void 0:o.costForQuantity}});return e.jsx(ue,{dataSource:j,style:{paddingLeft:"20px",margin:"0",maxHeight:S?"25vh":"22vh",overflow:"auto"},renderItem:(o,h)=>e.jsx(ue.Item,{style:{marginBottom:"4px"},children:e.jsxs(Vt,{children:[o.name," - ",o.quantity," ",o.unitDisplay," - ₪",o.cost]})},h)})},I=()=>{var a;const j=(a=R==null?void 0:R.mixes)==null?void 0:a.map(o=>{var E;const h=(()=>{switch(o.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((E=v==null?void 0:v.find(F=>(F==null?void 0:F._id)===(o==null?void 0:o.mixId)))==null?void 0:E.name)||"לא ידוע",quantity:o.quantity,unitDisplay:h,cost:o==null?void 0:o.costForQuantity}});return e.jsx(ue,{dataSource:j,style:{paddingLeft:"20px",margin:"0",maxHeight:S?"25vh":"22vh",overflow:"auto"},renderItem:(o,h)=>e.jsx(ue.Item,{style:{marginBottom:"4px"},children:e.jsxs(Vt,{children:[o.name," - ",o.quantity," ",o.unitDisplay," - ₪",o.cost]})},h)})};return e.jsx(e.Fragment,{children:_!=="P"&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{style:{gap:"1.5vw",height:S?"30vh":"12vw"},children:[e.jsx(B,{align:"center",justify:"center",children:e.jsx(rn,{vertical:!0,options:[{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(D,{icon:We}),e.jsx("div",{children:"מרכיבים"})]}),value:"ingredients"},{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(D,{icon:Et}),e.jsx("div",{children:"מתכונים"})]}),value:"mixes"}],onChange:j=>c(j),style:{marginBottom:"12px",direction:""}})}),e.jsx(B,{flex:1,children:e.jsx(le,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:w==="ingredients"?p():I()})})]})]})})};return e.jsxs("div",{children:[e.jsx(B,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(z,{className:"width-100",style:{display:"flex",flexDirection:"column",gap:"0.3em"},children:[e.jsx(B,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(O,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,style:{fontSize:"1.6em"},children:t==null?void 0:t.label}),e.jsxs(B,{children:[n&&e.jsx(T,{type:"text",icon:e.jsx(At,{}),onClick:()=>n(r)}),x&&e.jsx(T,{type:"text",danger:!0,icon:e.jsx(_e,{}),onClick:()=>x(r)}),i==="P"&&e.jsx(T,{type:"text",size:"large",icon:e.jsx(cs,{}),onClick:()=>s(r)})]})]})}),e.jsx(B,{flex:1,align:"start",style:{gap:"12px",marginBottom:"8px",flexDirection:"column"},children:e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",t==null?void 0:t.price]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(ds,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[t==null?void 0:t.preparationTime," דקות"]})]})]})}),L(g,f)]})}),e.jsx(N,{ingredients:m,mixes:u,size:t,type:i})]},t.idNew||r)}Se.locale("he");const Rr=us("employeeHours/buildMonthData",async({selectedDate:t,employees:r,employeeHours:s},{dispatch:i})=>{const n=Se(t,"YYYY-MM").daysInMonth(),x=Array.from({length:n},(m,u)=>{const g=Se(t,"YYYY-MM").date(u+1),f=g.format("dddd"),S=f==="שישי"||f==="שבת",C=r.map(_=>{const R=s.find(v=>{var w;return((w=v==null?void 0:v.employeeId)==null?void 0:w._id)===(_==null?void 0:_._id)&&Se(v==null?void 0:v.date).isSame(g,"day")});if(!R)return null;const P=!R.startTime||!R.endTime;return{hoursId:R._id,employeeId:_._id,name:_.name,hourlyRate:_.hourlyRate,hoursWorked:R.hoursWorked,hours:{start:R.startTime,end:R.endTime},hasError:P}}).filter(Boolean),L=C.reduce((_,R)=>_+R.hoursWorked,0),N=C.length;return{date:g.format("YYYY-MM-DD"),dayOfWeek:f,status:S&&f==="שישי"?"חצי יום":"יום מלא",isPast:g.isBefore(Se(),"day"),isToday:g.isSame(Se(),"day"),employees:C,totalHours:L,employeesCount:N}});i(Mr(x))}),ks=Ie({name:"employeeHours",initialState:{data:[],selectedDate:Se().startOf("month").format("YYYY-MM")},reducers:{setEmployeeHoursState:(t,r)=>{t.data=r.payload},setSelectedDate:(t,r)=>{t.selectedDate=r.payload},addOrUpdateEmployeeHoursState:(t,r)=>{const s=r.payload,i=t.data.findIndex(n=>n._id===s._id);i!==-1?t.data[i]=s:t.data.unshift(s)},updateEmployeeHoursState:(t,r)=>{const s=r.payload;t.data=t.data.map(i=>i._id===s._id?s:i)},deleteEmployeeHoursState:(t,r)=>{const s=r.payload._id;t.data=t.data.filter(i=>i._id!==s)}}}),{setEmployeeHoursState:Mr,addOrUpdateEmployeeHoursState:qr,updateEmployeeHoursState:Lr,deleteEmployeeHoursState:Or,setSelectedDate:Dr}=ks.actions,Ur=ks.reducer,Fs=Ie({name:"products",initialState:[],reducers:{setProductsState:(t,r)=>{const{products:s,ingredientsState:i,mixesState:n,averageHourlyRate:x}=r.payload;return s},addOrUpdateProductState:(t,r)=>{const{newProduct:s,ingredientsState:i,mixesState:n,averageHourlyRate:x}=r.payload,m=s,u=t.findIndex(g=>g._id===s._id);u!==-1?t[u]=m:t.unshift(m)},updateProductState:(t,r)=>{const{updatedProduct:s,ingredientsState:i,mixesState:n,averageHourlyRate:x}=r.payload,m=s;return t.map(u=>u._id===s._id?m:u)},deleteProductState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{setProductsState:Ps,addOrUpdateProductState:bt,updateProductState:Ao,deleteProductState:Hr}=Fs.actions,Br=Fs.reducer,Wr=d.forwardRef(({size:t,indexSize:r,getProductById:s,sizes:i,onChange:n,onDelete:x,newSizeId:m,setSelectedUpdateSize:u,setNewSizeId:g,transformValueToForm:f,setActiveTabKey:S,ingredients:C,mixes:L,sizeSummary:N,priceExcludingVAT:_,activeSubTab:R,setActiveSubTab:P,onSubmit:v},w)=>{const[c]=M.useForm(),p=ze();d.useImperativeHandle(w,()=>({setFieldsValue:h=>c.setFieldsValue(h),getFieldsValue:()=>c.getFieldsValue(),resetFields:()=>c.resetFields()}));const I=()=>{const h=[...i];h[r]={...h[r],edit:!1,ingredients:t.ingredients.filter(b=>b==null?void 0:b._id),mixes:t.mixes.filter(b=>b==null?void 0:b._id)},n(h)},j=h=>{const b=[...i];b[h]={...b[h],edit:!0},n(b),u(h)},a=h=>{const b=i[h];if(b!=null&&b._id)fe.confirm({title:"האם אתה בטוח שברצונך למחוק את הגודל הזה?",content:`המחיקה תסיר לצמיתות את ${b.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{x(b==null?void 0:b.productId,b._id).then(()=>{const E=[...i];E.splice(h,1),n(E),c.setFieldsValue({...E[h]}),S(Math.max(0,h-1).toString()||"0"),s(b==null?void 0:b.productId).then(F=>{p(bt({newProduct:F}))})}).catch(E=>{console.error("Error deleting size:",E)})}});else{const E=[...i];E.splice(h,1),n(E),c.setFieldsValue({...t}),S(Math.max(0,h-1).toString()||"0"),g(null)}},o=h=>{switch(h){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return d.useEffect(()=>{console.log(c.getFieldsValue()),console.log(t)},[c,t]),!(t!=null&&t._id)||t!=null&&t.edit?e.jsx(M,{form:c,initialValues:{...t},children:e.jsx(Ar,{handleCancelEdit:I,handleRemoveSize:a,newSizeId:m,size:t,indexSize:r,onChange:n,form:c,ingredients:C,mixes:L,setNewSizeId:g,setActiveSubTab:P,activeSubTab:R,sizes:i,getUnitDisplay:o,onSubmit:v})}):e.jsx(Ns,{handleEditSize:j,handleRemoveSize:a,index:r,size:t,ingredients:C,mixes:L,priceExcludingVAT:_,sizeSummary:N})}),{TabPane:zr}=be,Zt=d.forwardRef(({value:t=[],onChange:r,getProductById:s,setSelectedUpdateSize:i,ingredients:n,activeTabKey:x,setActiveTabKey:m,mixes:u,onSubmit:g,onDelete:f,sizeSummary:S,priceExcludingVAT:C},L)=>{const[N,_]=d.useState(null),[R,P]=d.useState("1"),v=d.useRef([]),w=p=>({value:p}),c=()=>{var j;const p={idNew:Date.now(),label:`גודל ${t.length+1}`,price:null,preparationTime:null,ingredients:[],mixes:[],edit:!0},I=[...t,p];r(I),(j=v.current[+x])==null||j.setFieldsValue({...p}),_(p.idNew),m(t.length.toString()||"0"),P("1")};return e.jsxs(B,{style:{flexDirection:"column"},children:[e.jsx(T,{type:"default",icon:e.jsx(Rt,{}),onClick:c,children:"הוסף גודל"}),e.jsx(be,{activeKey:x,onChange:p=>m(p||"0"),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:t==null?void 0:t.map((p,I)=>{var j;return e.jsx(zr,{tab:(p==null?void 0:p.label)||`גודל ${I+1}`,children:e.jsx(Wr,{ref:a=>v.current[I]=a,size:p,indexSize:I,setSelectedUpdateSize:i,sizes:t,onChange:r,onDelete:f,getProductById:s,ingredients:n,transformValueToForm:w,setActiveTabKey:m,setActiveSubTab:P,activeSubTab:R,mixes:u,onSubmit:g,newSizeId:N,setNewSizeId:_,sizeSummary:S&&S[I],priceExcludingVAT:C&&((j=C[I])==null?void 0:j.priceExcludingVAT)})},I.toString())})})]})}),{TabPane:Kt}=be,es=d.forwardRef(({value:t=[],sizes:r,onChange:s,ingredients:i,onSubmit:n,onDelete:x},m)=>{const[u,g]=d.useState(null),[f,S]=d.useState("0"),[C]=M.useForm(),L=()=>({value:t}),N=()=>{const v={idNew:Date.now(),label:`וריאציה - ${t.length+1}`,sizeAdjustments:[...r==null?void 0:r.map(c=>({sizeId:c==null?void 0:c._id,label:c==null?void 0:c.label,priceAdjustment:null,preparationTimeAdjustment:null,ingredients:c==null?void 0:c.ingredients,mixes:c==null?void 0:c.mixes,add:[],remove:[],update:[]}))]},w=[...t,v];s(w),C.setFieldsValue({variations:w}),g(v.idNew),S(t.length.toString())},_=v=>{const w=t[v];if(w!=null&&w._id)fe.confirm({title:"האם אתה בטוח שברצונך למחוק את הוריאציה הזו?",content:`המחיקה תסיר לצמיתות את ${w.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{x(w==null?void 0:w.productId,w._id).then(()=>{const c=[...t];c.splice(v,1),s(c),C.setFieldsValue({sizes:c}),S(Math.max(0,v-1).toString())}).catch(c=>{console.error("Error deleting vatiation:",c)})}});else{const c=[...t];c.splice(v,1),s(c),C.setFieldsValue(L()),S(Math.max(0,v-1).toString()),g(null)}},R=v=>{const w=[...t];w[v]={...w[v],edit:!0},s(w)},P=v=>{switch(v){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return e.jsxs(M,{form:C,initialValues:{variations:t},onFinish:(v,w)=>{var c;n({variations:(c=v==null?void 0:v.variations)==null?void 0:c.filter(p=>p)})},children:[!r.length&&e.jsx(an,{message:"לא ניתן להוסיף וריאציות",description:"יש להוסיף לפחות גודל אחד לפני שניתן להוסיף וריאציות.",type:"warning",showIcon:!0,style:{marginBottom:"16px"}}),e.jsx(T,{type:"default",icon:e.jsx(Rt,{}),disabled:(r==null?void 0:r.length)===0||!r,onClick:N,children:"הוסף וריאציה"}),e.jsx(M.List,{name:["variations","sizeAdjustments"],children:(v,{add:w,remove:c})=>{be,v.map(({key:p,name:I,fieldKey:j})=>{var o;const a=C.getFieldValue(["variations","sizeAdjustments",p]);return e.jsx(Kt,{tab:(a==null?void 0:a.label)||`גודל ${p+1}`,children:!(a!=null&&a._id)||a!=null&&a.edit?e.jsxs("div",{className:a.idNew===u?"highlight-new":"",style:{border:`1px ${a!=null&&a.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(O,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsx(M.Item,{name:["variations","sizeAdjustments",p,"_id"],hidden:!0,children:e.jsx(xe,{})}),e.jsx(M.Item,{name:["variations","sizeAdjustments",p,"label"],label:"שם הוריאציה",rules:[{required:!0,message:"חייב למלא שם גודל"}],children:e.jsx(xe,{placeholder:"שם הוריאציה",size:"middle",style:{width:"auto",minWidth:"200px"}})}),e.jsx(T,{type:"text",style:{alignSelf:"flex-start"},danger:!0,icon:e.jsx(_e,{}),title:"מחק וריאציה",onClick:()=>_(p),children:"מחק וריאציה"})]}),e.jsx(M.List,{name:["variations","sizeAdjustments",p],children:(h,{add:b,remove:E})=>e.jsx(be,{tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:h.map(({key:F,name:y,fieldKey:W})=>{const J=C.getFieldValue(["variations",index,"sizeAdjustments",y]);return e.jsxs(Kt,{tab:(J==null?void 0:J.label)||`Size ${y}`,children:[e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{span:12,children:e.jsx(M.Item,{name:["variations",index,"price"],label:"תוספת מחיר",rules:[{required:!1,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(de,{placeholder:"מחיר",style:{width:"100%"}})})}),e.jsx(z,{span:12,children:e.jsx(M.Item,{label:"תוספת זמן הכנה (דקות)",name:["sizes",index,"preparationTime"],rules:[{required:!1,message:"חייב לציין זמן הכנה"}],children:e.jsx(de,{placeholder:"זמן הכנה",style:{width:"100%"}})})})]}),e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx(M.List,{name:["sizes",index,"ingredients"],children:(G,{add:re,remove:ae})=>e.jsxs(e.Fragment,{children:[e.jsx(T,{type:"dashed",style:{marginBottom:"0.5vw"},onClick:()=>re({ingredientId:null,quantity:null,unit:null}),children:"הוסף מרכיב"}),e.jsx("div",{style:{maxHeight:"12vw",overflowY:"auto",overflowX:"hidden"},children:G.map(({key:ie,name:k,fieldKey:A})=>e.jsxs(O,{gutter:16,children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[k,"ingredientId"],fieldKey:[A,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(ce,{placeholder:"בחר מרכיב",showSearch:!0,filterOption:(l,$)=>{var H;return(H=$==null?void 0:$.label)==null?void 0:H.toLowerCase().includes(l.toLowerCase())},options:i.map(l=>({value:l._id,label:l.name,unit:l==null?void 0:l.unit}))})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[k,"quantity"],fieldKey:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(de,{placeholder:"כמות",addonAfter:P(C.getFieldValue(["sizes",index,"ingredients",k,"unit"])||"")})})}),e.jsx(z,{span:4,children:e.jsx(T,{type:"text",danger:!0,icon:e.jsx($t,{}),onClick:()=>ae(k)})})]},ie))})]})})]},F)})})}),e.jsx(Z,{style:{margin:"12px 0"}})]},a.idNew||p):e.jsxs("div",{style:{border:"1px solid #e6e6e6",borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",marginBottom:"16px"},children:[e.jsx(B,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(z,{className:"width-100",children:[e.jsx(B,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(O,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,style:{fontSize:"1.2em"},children:size==null?void 0:size.label}),e.jsxs(B,{children:[e.jsx(T,{type:"text",icon:e.jsx(At,{}),onClick:()=>R(index)}),e.jsx(T,{type:"text",danger:!0,icon:e.jsx(_e,{}),onClick:()=>_(index)})]})]})}),e.jsxs(B,{flex:1,align:"middle",style:{gap:"12px",marginBottom:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Y.Text,{style:{color:"#007acc",fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:["₪",size==null?void 0:size.price]}),e.jsx(D,{style:{fontSize:"0.9em",color:"#007acc"},icon:hn})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Y.Text,{style:{fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:[size==null?void 0:size.preparationTime," דקות"]}),e.jsx(D,{style:{fontSize:"0.9em"},icon:Tt})]})]})]})}),e.jsx(Z,{style:{margin:"12px 0"}}),e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:(o=size==null?void 0:size.ingredients)==null?void 0:o.map((h,b)=>{var F;const E=(()=>{switch(h.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(Y.Text,{children:[(F=i==null?void 0:i.find(y=>(y==null?void 0:y._id)===(h==null?void 0:h.ingredientId)))==null?void 0:F.name," -"," ",h.quantity," ",E]})},b)})})]},size.idNew||index)},p)})}}),e.jsx(T,{type:"primary",htmlType:"submit",disabled:t.length===0,onClick:()=>g(null),children:"שמור"})]})}),{Title:Ro,Text:ts}=Y,{TabPane:Qr}=be,Yr=({})=>{var F;const{isModalVisible:t,setIsModalVisible:r,modalMode:s,setModalMode:i,selectedItem:n,setSelectedItem:x,selectedUpdateSize:m,setSelectedUpdateSize:u,getProductById:g,addProduct:f,updateProduct:S,deleteProduct:C,addSize:L,updateSize:N,deleteSize:_}=Ss(),R=Te({query:"(max-width: 500px)"}),P=V(y=>y.categories),v=(F=V(y=>y.ingredients))==null?void 0:F.filter(y=>y==null?void 0:y.is_active),w=V(y=>y.mixes),c=V(y=>y.products),[p,I]=d.useState("0"),j=d.useCallback(()=>{if(!n||!c)return;const y=c.find(W=>W._id===n._id);y&&x({...y})},[n,c]);d.useEffect(()=>{j()},[c]);const[a]=M.useForm(),o=(y,W,J)=>{if(y==="product")switch(W){case"add":return"הוספת מוצר";case"edit":return"עדכון מוצר";case"view":return"צפייה במוצר";default:return"הוספת מוצר"}else switch(y){case"size":return`ניהול גדלים - ${J==null?void 0:J.name}`;case"variation":return`ניהול וריאציות - ${J==null?void 0:J.name}`}};d.useEffect(()=>{n?a.setFieldsValue(n):a.resetFields()},[n]);const h=y=>{var W,J,G,re;switch(t){case"product":const ae=a.getFieldsValue();s==="edit"?S({...ae,_id:n==null?void 0:n._id}).then(()=>{r(!1),x(null)}).catch(A=>{console.error("שגיאה בעריכת מוצר:",A)}):f(ae).then(()=>{r(!1),x(null)}).catch(A=>{console.error("שגיאה בהוספת מוצר:",A)});break;case"size":const ie=y,k={productId:n==null?void 0:n._id,label:ie.label,price:ie.price,preparationTime:ie.preparationTime,ingredients:((J=(W=ie.ingredients)==null?void 0:W.filter(A=>A))==null?void 0:J.map(A=>{var l;return{ingredientId:((l=A.ingredientId)==null?void 0:l._id)||A.ingredientId,quantity:A.quantity,unit:A.unit}}))||[],mixes:((re=(G=ie.mixes)==null?void 0:G.filter(A=>A))==null?void 0:re.map(A=>({mixId:A.mixId,quantity:A.quantity,unit:A.unit})))||[],_id:ie._id};new Promise((A,l)=>k._id?N(k._id,k):L(n==null?void 0:n._id,k)).then(()=>{}).catch(A=>{console.error("Error managing sizes:",A)});break}},b=()=>{switch(t){case"product":return e.jsxs(M,{form:a,layout:"vertical",onFinish:h,children:[e.jsx(M.Item,{name:"name",label:"שם מוצר",rules:[{required:!0,message:"אנא הזן שם מוצר"},{max:25,message:"שם המוצר לא יכול להיות יותר מ-25 תווים"}],children:e.jsx(xe,{maxLength:25,showCount:!0})}),e.jsx(M.Item,{name:"category",label:"קטגוריה",rules:[{required:!0,message:"אנא בחר קטגוריה"}],children:e.jsx(ce,{showSearch:!0,placeholder:"בחר קטגוריה",optionFilterProp:"children",filterOption:(y,W)=>W.children.toLowerCase().indexOf(y.toLowerCase())>=0,children:P.map(y=>e.jsx(ce.Option,{value:y._id,children:y==null?void 0:y.name},y._id))})}),e.jsx(M.Item,{name:"isFeatured",label:"פעיל",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx(M.Item,{name:"isOnSale",label:"מוצר מכירה",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx(M.Item,{name:"notes",label:"הערות",rules:[{required:!1,message:"אנא הזן הערות"},{max:250,message:"ההערות לא יכולות להיות יותר מ-250 תווים"}],children:e.jsx(xe.TextArea,{rows:4,maxLength:250,showCount:!0})}),e.jsx(M.Item,{children:e.jsx(T,{type:"primary",htmlType:"submit",children:"שמור מוצר"})})]});case"size":return e.jsx(Zt,{value:n==null?void 0:n.sizes,setValue:x,ingredients:v,sizeSummary:n==null?void 0:n.sizeSummary,setSelectedUpdateSize:u,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,getProductById:g,mixes:w,onDelete:_,activeTabKey:p,setActiveTabKey:I,onSubmit:h,onChange:y=>x({...n,sizes:y})});case"variation":return e.jsx(es,{value:n==null?void 0:n.variations,form:formVariation,setValue:x,sizes:n==null?void 0:n.sizes,ingredients:v,onChange:y=>x({...n,variations:y})});default:return null}},E=()=>{var y,W,J;switch(t){case"product":return e.jsxs("div",{styles:{body:{display:"flex",flexDirection:"column"}},children:[e.jsxs(B,{style:{gap:"1em",flexDirection:"column",margin:"1em 0em"},children:[e.jsx(ts,{strong:!0,style:{fontSize:"1.5em"},children:n==null?void 0:n.name}),e.jsx(Pe,{style:{width:"fit-content"},children:(y=P==null?void 0:P.find(G=>G._id===(n==null?void 0:n.category)))==null?void 0:y.name}),e.jsxs(B,{style:{gap:"0.5em",flexDirection:"column"},children:[e.jsx(Ke,{status:n!=null&&n.isFeatured?"success":"default",text:n!=null&&n.isFeatured?"פעיל":"לא פעיל"}),e.jsx(Ke,{status:n!=null&&n.isOnSale?"processing":"default",text:n!=null&&n.isOnSale?"במבצע":"לא במבצע"})]})]}),((W=n==null?void 0:n.notes)==null?void 0:W.length)>0&&e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(ts,{strong:!0,children:["הערות",":"]})}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:n==null?void 0:n.notes})})]}),e.jsx(B,{flex:1,children:e.jsx(be,{style:{width:"100%"},type:"card",children:(J=n==null?void 0:n.sizes)==null?void 0:J.map((G,re)=>e.jsx(Qr,{tab:G.label,children:e.jsx(Ns,{handleEditSize:!1,handleRemoveSize:!1,index:re,size:G,type:"P",sizeInfo:ae=>{r("size"),I((ae==null?void 0:ae.toString())||"0")},ingredients:v,mixes:w,priceExcludingVAT:(n==null?void 0:n.priceExcludingVAT)&&(n==null?void 0:n.priceExcludingVAT[re].priceExcludingVAT),sizeSummary:(n==null?void 0:n.sizeSummary)&&(n==null?void 0:n.sizeSummary[re])})},re))})})]});case"size":return e.jsx(Zt,{value:n==null?void 0:n.sizes,setValue:x,ingredients:v,sizeSummary:n==null?void 0:n.sizeSummary,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,setSelectedUpdateSize:u,getProductById:g,mixes:w,onDelete:_,activeTabKey:p,setActiveTabKey:I,onSubmit:h,onChange:G=>x({...n,sizes:G})});case"variation":return e.jsx(es,{value:n==null?void 0:n.variations,mode:"view",ingredients:v,onChange:G=>x({...n,variations:G})});default:return null}};return e.jsx(fe,{style:{top:R?"3em":""},title:o(t,s,n),open:t,onCancel:()=>{r(!1),x()},footer:null,destroyOnClose:!0,height:R?"85vh":600,width:R?"100%":600,styles:{body:{height:"85vh"}},children:s==="view"?E():b()})},Jr=({categories:t,isMobile:r,selectedCategory:s,setSelectedCategory:i,setIsCategoryModalVisible:n})=>{const x=d.useRef(null),m=d.useRef({}),u=()=>{x.current.scrollBy({left:200,behavior:"smooth"})},g=()=>{x.current.scrollBy({left:-200,behavior:"smooth"})},f=S=>{i(S),m.current[S]&&m.current[S].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})};return e.jsx("div",{style:{padding:"16px",backgroundColor:"#f0f2f5"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(T,{icon:e.jsx(bn,{}),onClick:u}),e.jsxs("div",{ref:x,style:{display:"flex",overflowX:"auto",flexGrow:1,gap:"8px",padding:"8px 0",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx(T,{type:s==="all"?"primary":"default",onClick:()=>f("all"),children:"הכל"}),t.map(S=>e.jsx(T,{ref:C=>m.current[S._id]=C,type:s===S._id?"primary":"default",onClick:()=>f(S._id),children:S.name},S._id))]}),e.jsx(T,{icon:e.jsx(Cn,{}),onClick:g}),!r&&e.jsx(T,{type:"primary",icon:e.jsx(Rt,{}),onClick:()=>n(!0)})]})})};function Gr(){var E;const{addProduct:t,updateProduct:r,deleteProduct:s,isModalVisible:i,setIsModalVisible:n,modalMode:x,setModalMode:m,selectedItem:u,setSelectedItem:g}=Ss(),f=Te({query:"(max-width: 500px)"});d.useRef(null);const[S,C]=d.useState([]),[L,N]=d.useState([]),[_,R]=d.useState("all"),[P,v]=d.useState(!1),[w,c]=d.useState({}),p=V(F=>F.products),I=V(F=>F.categories),j=(E=V(F=>F.ingredients))==null?void 0:E.filter(F=>F==null?void 0:F.is_active),a=["name","category"],o=["name","category","detailes","sizes","productSummary","actions"],h=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"category",dataIndex:"category",title:"קטגוריה"},{key:"profitMargin",dataIndex:"profitMargin",title:"אחוז רווח"}],b=d.useMemo(()=>[{key:"name",dataIndex:"name",title:"שם המוצר",editable:!0,type:"text",rules:[{required:!0,message:"חייב להיות שם מוצר"},{min:2,message:"שם חייב להיות לפחות 2 תווים"}]},{key:"category",dataIndex:"category",title:"קטגוריה",editable:!0,type:"select",render:(F,y)=>{var W;return e.jsx(Pe,{children:(W=I==null?void 0:I.find(J=>J._id===(y==null?void 0:y.category)))==null?void 0:W.name})},options:I.map(F=>({value:F._id,label:F.name})),rules:[{required:!0,message:"יש לבחור קטגוריה"}]},{key:"detailes",dataIndex:"actions",width:100,render:(F,y)=>e.jsxs(O,{style:{gap:"0.5em"},align:"middle",justify:"center",children:[e.jsx(Pe,{className:y!=null&&y.isFeatured?"green":"red",children:y!=null&&y.isFeatured?"פעיל":"לא פעיל"}),e.jsx(Pe,{className:y!=null&&y.isOnSale?"blue":"yellow",children:y!=null&&y.isOnSale?"במבצע":"לא במבצע"})]})},{key:"sizes",title:"גדלים",type:"custom",editable:!0,render:(F,y,W="view",J)=>{var G;return(G=y==null?void 0:y.sizes)==null?void 0:G.length}},{key:"variations",title:"ווריאציות",type:"custom",editable:!0,render:(F,y,W="view",J)=>{var G;return(G=y==null?void 0:y.variations)==null?void 0:G.length}},{key:"productSummary",dataIndex:"productSummary",title:"אחוז רווח (ממוצע)",width:150,render:(F,y)=>{var W;return`${((W=y==null?void 0:y.productSummary)==null?void 0:W.averageProfitMargin)||0}%`}},{key:"actions",dataIndex:"actions",width:200,render:(F,y)=>e.jsx("div",{className:"",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(T,{type:"text",onClick:()=>{n("size"),g(y)},children:[e.jsx("p",{children:"גדלים"}),e.jsx(D,{icon:et})]})})}],[I]);return I==null||I.map(F=>({label:F.name,value:F._id})),d.useEffect(()=>{const F=JSON.parse(localStorage.getItem("filtersMenu")||"{}");c(F)},[]),d.useEffect(()=>{if(p){const F=_&&_!=="all"?p.filter(y=>y.category===_):p;C(F),N(F)}},[p,_]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",maxWidth:"100%",height:"100%",width:"100%",overflow:"hidden","- webkit - overflow - scrolling":"touch"},children:[e.jsx(Jr,{categories:I,isMobile:f,selectedCategory:_,setIsCategoryModalVisible:v,setSelectedCategory:R}),e.jsx(B,{flex:1,children:e.jsx(rt,{title:"תפריט",type:"P",data:S,mobileKeys:o,dataPrint:L,sortKeys:h,tableKeys:b,newTitle:"הוסף מוצר חדש",searchKeys:a,setDataPrint:N,onAdd:t,onEdit:r,onDelete:s,ingredientsArr:j,Dtitle:"אישור מחיקה",Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את המוצר?"}),e.jsx("p",{children:"שים לב! מחיקת מוצר עשויה להשפיע על מכירות ותערובות קשורות."})]}),iconADD:e.jsx(D,{icon:tt}),floatAction:[e.jsx(jt,{type:"primary",onClick:()=>v(!0),icon:e.jsx(D,{icon:et})})],openModalProduct:(F,y)=>{n("product"),m(F),y&&g(y)}})}),e.jsx(Tr,{isCategoryModalVisible:P,setIsCategoryModalVisible:v}),e.jsx(Yr,{})]})}const it="https://menu-server-c2b952e2c698.herokuapp.com/api",Xr=t=>X.post(`${it}/suppliers`,t),Vr=t=>{const r=encodeURIComponent(t._id);return X.put(`${it}/suppliers/${r}`,t)},Zr=t=>X.delete(`${it}/suppliers/${t}`),Kr=()=>X.get(`${it}/suppliers`),_s=d.createContext(),ea=()=>d.useContext(_s),ta=({children:t})=>{const[r,s]=d.useState(!1),i=async m=>{s(!0);try{await Xr(m),q.success("הספק נוסף בהצלחה"),s(!1)}catch(u){console.error("Error adding supplier:",u),q.error("שגיאה בהוספת הספק"),s(!1)}},n=async m=>{s(!0);try{await Vr(m),q.success("הספק עודכן בהצלחה"),s(!1)}catch(u){console.error("Error updating supplier:",u),q.error("שגיאה בעדכון הספק"),s(!1)}},x=async m=>{s(!0);try{await Zr(m),q.success("הספק נמחק בהצלחה"),s(!1)}catch(u){console.error("Error deleting supplier:",u),q.error("שגיאה במחיקת הספק"),s(!1)}};return e.jsx(_s.Provider,{value:{addSupplier:i,updateSupplier:n,deleteSupplier:x,loading:r},children:t})};function sa(){const{addSupplier:t,updateSupplier:r,deleteSupplier:s}=ea(),i=V(v=>v.suppliers),n=V(v=>v.ingredients),[x,m]=d.useState([]),[u,g]=d.useState([]),[f,S]=d.useState({}),C=["name"],L=["name","phone","email","contact_name","address",,"second_phone","notes"],N=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים"}],_=[{key:"name",dataIndex:"name",title:"שם הספק",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות שם ספק"},{min:3,message:"שם ספק חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים",editable:!1},{key:"phone",dataIndex:"phone",title:"טלפון",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות מספר טלפון"},{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"email",dataIndex:"email",title:"אימייל",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות אימייל"},{type:"email",message:"אימייל לא תקין"}]},{key:"contact_name",dataIndex:"contact_name",title:"איש קשר",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות איש קשר"},{min:3,message:"איש קשר חייב להיות לפחות 3 תווים"}]},{key:"address",dataIndex:"address",title:"כתובת",editable:!0,type:"text",width:150,rules:[{required:!0,message:"חייבת להיות כתובת"},{min:5,message:"כתובת חייבת להיות לפחות 5 תווים"}]},{key:"second_phone",dataIndex:"second_phone",title:"טלפון נוסף",editable:!0,type:"text",width:100,rules:[{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"notes",dataIndex:"notes",title:"הערות",editable:!0,type:"textArea",maxLength:120,width:150,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}],render:(v,w)=>{const c=(w==null?void 0:w.notes)||"—";return e.jsx(st,{title:c,children:e.jsx("span",{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px"},children:c})})}}],R=[{name:"רשימת ספקים",value:"name",type:"select",options:i.map(v=>({label:v.name,value:v.name}))},{name:"סטטוס רכיבים",value:"usedCount",type:"slider",min:0,max:Math.max(...x.map(v=>v.usedCount||0))}];d.useEffect(()=>{if(i){const v=i.map(w=>{const c=n==null?void 0:n.filter(p=>p.supplierId===w._id).length;return{...w,usedCount:c}});m(v),g(v)}},[i,n]),d.useEffect(()=>{const v=JSON.parse(localStorage.getItem("filtersSuppliers")||"{}");S(v)},[]);const P=v=>{S(v),localStorage.setItem("filtersSuppliers",JSON.stringify(v))};return e.jsx(rt,{title:"ספקים",titleView:"ספק",data:x,mobileKeys:L,dataPrint:u,sortKeys:N,tableKeys:_,newTitle:"הוסף ספק חדש",searchKeys:C,setDataPrint:g,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",filters:f,saveFilters:P,filtersArr:R,iconADD:e.jsx(D,{icon:nt}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הספק?"}),e.jsx("p",{children:"שים לב! במחיקת ספק אתה תמחוק את כל הרכיבים שלו וכן הם כמובן ימחקו מכל התערובות והמוצרים."})]})})}const lt="https://menu-server-c2b952e2c698.herokuapp.com/api",na=t=>X.post(`${lt}/ingredients`,t),ra=t=>{const r=encodeURIComponent(t._id);return X.put(`${lt}/ingredients/${r}`,t)},aa=t=>X.delete(`${lt}/ingredients/${t}`),ia=()=>X.get(`${lt}/ingredients`),Ts=d.createContext(),la=()=>d.useContext(Ts),oa=({children:t})=>{const[r,s]=d.useState(!1),i=async m=>{s(!0);try{await na(m),q.success("החומר גלם נוסף בהצלחה"),s(!1)}catch{q.error("שגיאה בהוספת חומר הגלם"),s(!1)}},n=async m=>{s(!0);const u=["unitQuantity","unitDescription","unitPrice","processedPrice"],g=Object.keys(m).filter(f=>!u.includes(f)).reduce((f,S)=>(f[S]=m[S],f),{});try{await ra(g),q.success("החומר גלם עודכן בהצלחה")}catch{q.error("שגיאה בעדכון חומר הגלם")}finally{s(!1)}},x=async m=>{s(!0);try{await aa(m),q.success("החומר גלם נמחק בהצלחה"),s(!1)}catch{q.error("שגיאה במחיקת חומר הגלם"),s(!1)}};return e.jsx(Ts.Provider,{value:{addIngredient:i,updateIngredient:n,deleteIngredient:x,loading:r},children:t})},Je="https://menu-server-c2b952e2c698.herokuapp.com/api",da=()=>X.get(`${Je}/settings`),ca=t=>X.put(`${Je}/settings`,{settings:t}),ua=t=>X.post(`${Je}/settings/categories`,t),xa=(t,r)=>X.put(`${Je}/settings/categories/${t}`,r),pa=t=>X.delete(`${Je}/settings/categories/${t}`),Es=Ie({name:"settings",initialState:{settings:null,loading:!1},reducers:{setSettings:(t,r)=>{t.settings=r.payload},updateSettingValue:(t,r)=>{const{key:s,value:i}=r.payload;t.settings&&t.settings[s]&&(t.settings[s].value=i,t.settings[s].lastUpdated=new Date().toISOString())},addCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value.push(s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},updateCategory:(t,r)=>{const s=r.payload;if(t.settings&&t.settings.materialCategories){const i=t.settings.materialCategories.value.findIndex(n=>n._id===s._id);i!==-1&&(t.settings.materialCategories.value[i]=s,t.settings.materialCategories.lastUpdated=new Date().toISOString())}},deleteCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value=t.settings.materialCategories.value.filter(i=>i._id!==s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},setLoading:(t,r)=>{t.loading=r.payload}}}),{setSettings:ma,updateSettingValue:Mo,addCategory:ha,updateCategory:ga,deleteCategory:ja,setLoading:je}=Es.actions,fa=Es.reducer,$s=d.createContext(),As=()=>d.useContext($s),ya=({children:t})=>{const r=ze(),{settings:s,loading:i}=V(f=>f.settings),n=async()=>{r(je(!0));try{const{data:f}=await da();r(ma(f))}catch(f){console.error("Error fetching settings:",f)}finally{r(je(!1))}},x=async f=>{var S;r(je(!0));try{await ca(f);const[C]=await Promise.all([bs()]);r(Ps({products:(S=C.data)==null?void 0:S.reverse()})),q.success("הגדרות נשמרו בהצלחה"),r(je(!1))}catch{q.error("שגיאה בשמירת ההגדרות"),r(je(!1))}},m=async f=>{r(je(!0));try{const{data:S}=await ua(f);r(ha(S)),q.success("הקטגוריה נוספה בהצלחה")}catch(S){console.error("Error adding category:",S),q.error("שגיאה בהוספת הקטגוריה")}finally{r(je(!1))}},u=async(f,S)=>{r(je(!0));try{await xa(f,S),r(ga(S)),q.success("הקטגוריה עודכנה בהצלחה")}catch(C){console.error("Error updating category:",C),q.error("שגיאה בעדכון הקטגוריה")}finally{r(je(!1))}},g=async f=>{r(je(!0));try{await pa(f),r(ja(f)),q.success("הקטגוריה נמחקה בהצלחה")}catch(S){console.error("Error deleting category:",S),q.error("שגיאה במחיקת הקטגוריה")}finally{r(je(!1))}};return d.useEffect(()=>{n()},[]),e.jsx($s.Provider,{value:{settings:s,loading:i,fetchSettings:n,updateSetting:x,addCategoryContext:m,updateCategoryContext:u,deleteCategoryContext:g},children:t})},{Text:va}=Y;function wa(){var I;const{settings:t}=As(),r=d.useMemo(()=>{var j,a;return((a=(j=t==null?void 0:t.materialCategories)==null?void 0:j.value)==null?void 0:a.map(o=>({value:o==null?void 0:o._id,label:o==null?void 0:o.name,color:(o==null?void 0:o.color)||"blue"})))||[]},[(I=t==null?void 0:t.materialCategories)==null?void 0:I.value]),s=V(j=>j.suppliers),i=V(j=>j.ingredients),n=V(j=>j.products),x=V(j=>j.mixes),{addIngredient:m,updateIngredient:u,deleteIngredient:g}=la(),[f,S]=d.useState([]),[C,L]=d.useState([]),[N,_]=d.useState({});d.useState(!1);const R=["name","type","supplierId"],P=["unit","unitPrice","supplierId","usedInMixes","usedInProducts"],v=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"type",dataIndex:"type",title:"סוג"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"},{key:"unit",dataIndex:"unit",title:"יחידת מידה"},{key:"supplierName",dataIndex:"supplierName",title:"שם ספק"}],w=[{key:"SKU",dataIndex:"SKU",title:'מק"ט',editable:!0,type:"number",width:100,group:1,rules:[{validator:async(j,a,o)=>a?typeof a!="number"?Promise.reject('מק"ט חייב להיות מספר תקין'):a.toString().length===0?Promise.reject('מק"ט חייב להיות מינימום תו אחד '):f.some(b=>b.SKU===a&&b._id!==(o==null?void 0:o._id))?Promise.reject('מק"ט זה כבר קיים במערכת'):Promise.resolve():Promise.resolve()}]},{key:"name",dataIndex:"name",title:"שם",required:!0,editable:!0,group:1,type:"text",width:200,minWidth:200,rules:[{required:!0,message:"השדה חובה"},{min:3,message:"השם חייב להיות לפחות 3 תווים"},{pattern:/^[א-תa-zA-Z\s0-9%-]+$/,message:"השם יכול להכיל אותיות בעברית או אנגלית, מספרים והתווים הבאים: ' % ', ' - '"}]},{key:"supplierId",dataIndex:"supplierId",title:"שם ספק",editable:!0,group:1,type:"select",required:!0,width:100,render:(j,a,o)=>{var h;return e.jsxs(O,{align:"middle",style:{gap:5},children:[o==="view"&&e.jsx(D,{icon:nt})," ",(h=s==null?void 0:s.find(b=>(b==null?void 0:b._id)===(a==null?void 0:a.supplierId)))==null?void 0:h.name]})},options:s==null?void 0:s.map(j=>({value:j._id,label:j==null?void 0:j.name})),rules:[{required:!0,message:"יש לבחור ספק"},{validator:(j,a)=>(s==null?void 0:s.some(h=>h._id===a))?Promise.resolve():Promise.reject("ספק לא חוקי נבחר")}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"is_active",dataIndex:"is_active",title:"פעיל",editable:!0,group:1,type:"custom",render:(j,a,o,h)=>o==="edit"?e.jsx(e.Fragment,{children:e.jsx(M.Item,{name:"is_active",label:"פעיל",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})},"is_active")}):e.jsx(Ke,{status:a!=null&&a.is_active?"success":"error",text:a!=null&&a.is_active?"פעיל":"לא פעיל"}),minWidth:120,width:120},{key:"type",dataIndex:"type",title:"סוג",render:(j,a)=>{const o=r.find(h=>h.value===(a==null?void 0:a.type));return e.jsx(Pe,{color:o==null?void 0:o.color,children:o==null?void 0:o.label})},type:"select",required:!0,editable:!0,group:2,options:r,divider:!0,width:100,rules:[{required:!0,message:"יש לבחור סוג"},{validator:(j,a)=>(r==null?void 0:r.some(h=>h.value===a))?Promise.resolve():Promise.reject("סוג לא חוקי נבחר")}]},{key:"unit",dataIndex:"unit",title:"יחידת מידה",editable:!0,group:2,type:"select",options:we,width:100,render:(j,a)=>{var o;return e.jsx("p",{children:((o=we.find(h=>h.value===(a==null?void 0:a.unit)))==null?void 0:o.label)||(a==null?void 0:a.unit)})},rules:[{required:!0,message:"יש לבחור יחידת מידה"},{validator:(j,a)=>(we==null?void 0:we.some(h=>h.value===a))?Promise.resolve():Promise.reject("יחידת מידה לא חוקית")}]},{key:"quantity",dataIndex:"quantity",title:"כמות",editable:!0,group:2,type:"custom",width:100,render:(j,a,o,h)=>{if(o=="edit")return e.jsx(M.Item,{name:"quantity",label:"כמות",rules:[{required:!0,message:"אנא הזן כמות"},{validator:(F,y)=>(h.getFieldValue("subUnit"),y==null?Promise.reject("כמות נדרשת"):y<0?Promise.reject("הכמות לא יכולה להיות שלילית"):(h.getFieldValue("subUnit")==="g"||h.getFieldValue("subUnit")==="ml")&&(y<.001||y>999)?Promise.reject('עבור גרם או מ"ל הכמות חייבת להיות בין 0.001 ל-999'):(h.getFieldValue("subUnit")==="kg"||h.getFieldValue("subUnit")==="liter")&&(y<1||y>1e6)?Promise.reject('עבור ק"ג או ליטר הכמות חייבת להיות מ-1 ומעלה, ובתוך הטווח המותר'):Promise.resolve())}],children:e.jsx(de,{style:{width:"100%"}})},"quantity");let b=a.unit,E="";return b==="weight"?E=a.quantity>=1?'ק"ג':"גרם":b==="volume"?E=a.quantity>=1?"ליטר":'מ"ל':b==="units"&&(E="יחידות"),e.jsxs("p",{children:[a.quantity<1?a.quantity*1e3:a.quantity," ",E]})}},{key:"price",dataIndex:"price",title:"מחיר כולל מעמ",editable:!0,group:2,type:"price",width:100,show:!1,divider:!0,render:(j,a,o,h)=>{var b;if(o!=="edit")return e.jsxs("p",{children:["₪",(b=a==null?void 0:a.price)==null?void 0:b.toFixed(2)]})}},{key:"priceExcludingVAT",dataIndex:"priceExcludingVAT",width:100,title:"מחיר ללא מעמ",render:(j,a)=>e.jsxs("p",{children:["₪",a==null?void 0:a.priceExcludingVAT]}),editable:!1,hiddenInForm:!0},{key:"unitPrice",dataIndex:"unitPrice",title:"כמות מינימלית",width:100,render:(j,a)=>e.jsxs(z,{children:[e.jsxs(O,{children:[e.jsxs("p",{children:[a.unitQuantity<1?a.unitQuantity*1e3:a.unitQuantity," ",a==null?void 0:a.unitDescription]}),e.jsx("br",{})]}),e.jsxs("p",{children:["₪",a==null?void 0:a.unitPrice]})]})},{key:"juiceRatio",dataIndex:"juiceRatio",title:"יחס עיבוד (תפוקת חומר מעובד)",editable:!0,group:2,width:100,type:"custom",render:(j,a,o,h)=>o=="view"||o!=="edit"?e.jsx("p",{children:a!=null&&a.juiceRatio?`${((a==null?void 0:a.juiceRatio)*100).toFixed(0)}%`:""}):e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:"isJuice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(Be,{onChange:b=>{h.setFieldsValue({isJuice:b.target.checked}),b.target.checked||h.setFieldsValue({juiceRatio:void 0})},children:"האם הרכיב דורש עיבוד?"})}),e.jsx(M.Item,{noStyle:!0,shouldUpdate:(b,E)=>b.isJuice!==E.isJuice,children:({getFieldValue:b})=>b("isJuice")&&e.jsx(M.Item,{name:"juiceRatio",label:"יחס המיץ (0.1 עד 0.99)",rules:[{required:!0,message:"אנא הזן יחס מיץ"},{type:"number",min:.1,max:.99,message:"היחס חייב להיות בין 0.1 ל-0.99"}],children:e.jsx(de,{style:{width:"100%"}})})})]})},{key:"processedPrice",dataIndex:"processedPrice",title:"מחיר לכמות מינימלית מעובדת",width:100,render:(j,a)=>e.jsx("p",{children:a!=null&&a.processedPrice?`₪${a==null?void 0:a.processedPrice}`:""}),editable:!1,hiddenInForm:!0},{key:"notes",dataIndex:"notes",title:"הערות",width:100,editable:!0,group:1,render:(j,a)=>{const o=(a==null?void 0:a.notes)||"—";return e.jsx(st,{title:o,children:e.jsx(va,{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px",direction:"rtl"},children:o})})},type:"textArea",maxLength:120,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}]}],c=[{name:"סוג",value:"type",options:r},{name:"ספק",value:"supplierId",options:s.map(j=>({label:j.name,value:j._id}))},{name:"סטטוס",value:"is_active",options:[{label:"פעיל",value:!0},{label:"לא פעיל",value:!1}]}];d.useEffect(()=>{if(i)if(s){let j=[...i==null?void 0:i.map(a=>{let o=s==null?void 0:s.find(E=>(E==null?void 0:E._id)===(a==null?void 0:a.supplierId));const h=(n==null?void 0:n.reduce((E,F)=>{var y;return E+((y=F.ingredients)==null?void 0:y.filter(W=>W.ingredientId===a._id).length)},0))||0,b=(x==null?void 0:x.reduce((E,F)=>{var y;return E+((y=F.ingredients)==null?void 0:y.filter(W=>W.ingredientId===a._id).length)},0))||0;return{...a,supplierName:o==null?void 0:o.name,usedCount:h+b}})];S(j),L(j)}else S([...i]),L([...i])},[s,i]),d.useEffect(()=>{const j=JSON.parse(localStorage.getItem("filtersIngredients")||"{}");_(j)},[]);const p=j=>{_(j),localStorage.setItem("filtersIngredients",JSON.stringify(j))};return e.jsx(e.Fragment,{children:e.jsx(rt,{title:"חומרי גלם",titleView:"חומר גלם",type:"ingredient",data:f,groups:!0,mobileKeys:P,dataPrint:C,sortKeys:v,tableKeys:w,newTitle:"הוסף חומר גלם חדש",searchKeys:R,setDataPrint:L,onAdd:m,onEdit:u,onDelete:g,Dtitle:"אישור מחיקה",filters:N,saveFilters:p,filtersArr:c,iconADD:e.jsx(D,{icon:We}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הרכיב?"}),e.jsx("p",{children:"שים לב! הרכיב יימחק מכל המוצרים והתערובות בהם הוא נמצא."})]})})})}Fn.register(Pn,_n,Tn,En,$n,An);const{Text:ba}=Y,Ca=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F"];function Sa(){const t=V(N=>N.categories),r=V(N=>N.products),s=V(N=>N.suppliers),i=V(N=>N.ingredients),n=V(N=>N.mixes),x=V(N=>N.employees),m=Te({query:"(max-width: 500px)"}),u=d.useMemo(()=>{const N=r.reduce((_,R)=>{var v;const P=((v=t.find(w=>w._id===R.category))==null?void 0:v.name)||"לא מוגדר";return _[P]=(_[P]||0)+1,_},{});return{labels:Object.keys(N),datasets:[{data:Object.values(N),backgroundColor:Ca}]}},[r,t]),g=d.useMemo(()=>[...i].sort((N,_)=>(_.unitPrice||0)-(N.unitPrice||0)).slice(0,5).map(N=>({name:N.name,price:N.unitPrice})),[i]),f=d.useMemo(()=>[...n].map(N=>{const _=N.totalCost/N.totalWeight;return{name:N.name,costPerLiter:_}}).sort((N,_)=>(_.costPerLiter||0)-(N.costPerLiter||0)).slice(0,5),[n]),S={labels:g.map(N=>N.name),datasets:[{label:"מחיר ל-100 גרם",data:g.map(N=>N.price),backgroundColor:"#FF8042"}]},C={labels:f.map(N=>N.name),datasets:[{label:"עלות לליטר",data:f.map(N=>N.costPerLiter),backgroundColor:"#8884d8"}]},L=d.useMemo(()=>r.filter(N=>N.profitMargin<=90).slice(0,3).map(N=>({key:N._id,name:N.name,profitMargin:N.profitMargin})),[r]);return e.jsxs("div",{className:"dashboard-container",style:{padding:m?"10px":"20px"},children:[e.jsxs(O,{gutter:[5,5],wrap:!0,children:[e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/menu",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle green",children:e.jsx(D,{icon:tt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"מוצרים"}),e.jsx("div",{className:"stat-value",children:r.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/suppliers",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle red",children:e.jsx(D,{icon:nt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"ספקים"}),e.jsx("div",{className:"stat-value",children:s.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/ingredients",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle blue",children:e.jsx(D,{icon:We})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"חומרי גלם"}),e.jsx("div",{className:"stat-value",children:i.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/menu",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle yellow",children:e.jsx(D,{icon:et})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"קטגוריות"}),e.jsx("div",{className:"stat-value",children:t.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/mixes",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle purple",children:e.jsx(D,{icon:xt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"תערובות"}),e.jsx("div",{className:"stat-value",children:n.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/employees",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle aqua",children:e.jsx(D,{icon:xt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"עובדים"}),e.jsx("div",{className:"stat-value",children:x==null?void 0:x.length})]})]})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:et,style:{marginLeft:"8px"}}),"מוצרים לפי קטגוריה"]}),children:e.jsx(kn,{data:u,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:We,style:{marginLeft:"8px"}}),"חומרי הגלם היקרים ביותר"]}),children:e.jsx(Qt,{data:S,options:{responsive:!0,maintainAspectRatio:!1}})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:xt,style:{marginLeft:"8px"}}),"התערובות היקרות ביותר"]}),children:e.jsx(Qt,{data:C,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:tt,style:{marginLeft:"8px"}}),"מוצרים עם רווחיות נמוכה"]}),children:e.jsx(O,{gutter:[16,16],children:L.map(N=>e.jsx(z,{xs:24,sm:8,children:e.jsxs(le,{children:[e.jsx(Ze,{title:N.name,value:N.profitMargin,suffix:"%",valueStyle:{color:"#cf1322"}}),e.jsx(ba,{type:"secondary",children:"רווחיות"})]})},N.key))})})})]})]})}const ot="https://menu-server-c2b952e2c698.herokuapp.com/api",Ia=t=>X.post(`${ot}/mixes`,t),Na=t=>{const r=encodeURIComponent(t._id);return X.put(`${ot}/mixes/${r}`,t)},ka=t=>X.delete(`${ot}/mixes/${t}`),Fa=()=>X.get(`${ot}/mixes`),Rs=d.createContext(),Pa=()=>d.useContext(Rs),_a=({children:t})=>{const[r,s]=d.useState(!1),i=async m=>{s(!0);try{await Ia(m),q.success("התערובת נוספה בהצלחה"),s(!1)}catch(u){console.error("Error adding mix:",u),q.error("שגיאה בהוספת התערובת"),s(!1)}},n=async m=>{s(!0);try{await Na(m),q.success("התערובת עודכנה בהצלחה"),s(!1)}catch(u){console.error("Error updating mix:",u),q.error("שגיאה בעדכון התערובת"),s(!1)}},x=async m=>{s(!0);try{await ka(m),q.success("התערובת נמחקה בהצלחה"),s(!1)}catch(u){console.error("Error deleting mix:",u),q.error("שגיאה במחיקת התערובת"),s(!1)}};return e.jsx(Rs.Provider,{value:{addMix:i,updateMix:n,deleteMix:x,loading:r},children:t})};function Ta(){var v;const{addMix:t,updateMix:r,deleteMix:s}=Pa(),[i,n]=d.useState([]),[x,m]=d.useState([]),[u,g]=d.useState({}),f=V(w=>w.mixes),S=(v=V(w=>w.ingredients))==null?void 0:v.filter(w=>w.is_active);V(w=>w.products);const C=V(w=>{var c,p;return(p=(c=w.settings.settings)==null?void 0:c.hourlyRate)==null?void 0:p.value}),L=({ingredients:w})=>{const[p,I]=d.useState(!1),j=w.slice(0,2);return w.slice(2).map((o,h)=>e.jsx("div",{style:{marginBottom:"5px"},children:`${o==null?void 0:o.name} (${o.quantity} ${o.unit}) - ₪${o==null?void 0:o.costForQuantity}`},h)),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",alignItems:"center"},children:[e.jsx("span",{style:{color:"blue",cursor:"pointer",fontWeight:"bold",marginLeft:"5px"},onClick:()=>I(!0),children:e.jsx(Sn,{style:{fontSize:"16px",color:"#000"}})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",maxWidth:"400px"},children:j.map((o,h)=>e.jsx("span",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",fontSize:"0.7vw"},children:`${o==null?void 0:o.name} (${o.quantity} ${o.unit}) - ₪${o==null?void 0:o.costForQuantity}`},h))}),e.jsx(fe,{title:"רשימת מרכיבים",open:p,onCancel:()=>I(!1),footer:[e.jsx(T,{onClick:()=>I(!1),children:"סגור"},"close")],children:w.map((o,h)=>e.jsx("div",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",width:"fit-content",fontSize:"0.7vw",marginBottom:".5vw"},children:`${o==null?void 0:o.name} (${o.quantity} ${o.unit}) - ₪${o==null?void 0:o.costForQuantity}`},h))})]})},N=["name","ingredients"],_=["name","preparationTime","totalCost","totalWeight","usedCount"],R=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה"},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת"},{key:"totalWeight",dataIndex:"totalWeight",title:"משקל כולל"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"}],P=[{key:"name",dataIndex:"name",title:"שם התערובת",editable:!0,type:"text",minWidth:100,rules:[{required:!0,message:"חייב להיות שם תערובת"},{min:3,message:"שם חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה (דקות)",editable:!0,minWidth:100,type:"number",rules:[{required:!0,message:"זמן הכנה נדרש"},{type:"number",min:0,message:"זמן הכנה חייב להיות מספר חיובי"}]},{key:"unitCost",dataIndex:"unitCost",title:"עלות ל-100 גרם (₪)",minWidth:100,render:(w,c)=>(c==null?void 0:c.totalWeight)!=null&&(c==null?void 0:c.totalCost)!=null?`₪${((Number(c.totalCost)+Number(c.laborCost||0))/(Number(c.totalWeight)*10)).toFixed(2)} / 100 גרם`:"—",editable:!1},{key:"laborCost",dataIndex:"laborCost",title:"עלות עבודה (₪)",minWidth:100,render:(w,c)=>{var p;return`₪${(p=c==null?void 0:c.laborCost)==null?void 0:p.toFixed(2)} (₪${C})`||"—"},editable:!1},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת (₪)",minWidth:100,render:(w,c)=>(c==null?void 0:c.totalCost)!=null&&(c==null?void 0:c.laborCost)!=null?`₪${(Number(c.totalCost)+Number(c.laborCost)).toFixed(2)}`:"—",editable:!1},{key:"totalWeight",dataIndex:"totalWeight",title:'משקל כולל (ק"ג)',minWidth:100,render:(w,c)=>{var p;return((p=c.totalWeight)==null?void 0:p.toFixed(2))||"—"},editable:!1},{key:"ingredients",title:"רכיבים",type:"ingredientsManager",editable:!0,width:500,minWidth:500,column:!0,fields:[{key:"ingredientId",type:"select",title:"רכיב",placeholder:"בחר רכיב",options:S.map(w=>({value:w._id,label:w.name})),required:!0,rules:[{required:!0,message:"יש לבחור רכיב"}]},{key:"quantity",type:"number",title:"כמות",placeholder:"הזן כמות",required:!0,rules:[{required:!0,message:"יש להזין כמות"},{type:"number",min:0,message:"כמות חייבת להיות חיובית"}]},{key:"unit",type:"text",title:"יחידה",readonly:!0},{key:"weightOrVolumePerUnit",type:"number",title:"נפח/משקל ליחידה (אם רלוונטי)",placeholder:"הזן נפח ליחידה",required:!1,visible:w=>w.unit==="units",rules:[{type:"number",min:0,message:"ערך חייב להיות חיובי"}]}],render:(w,c,p,I)=>{let j=[...(c==null?void 0:c.ingredients)||[]].sort((a,o)=>o.quantity-a.quantity);return j=j==null?void 0:j.map(a=>{var o;return{name:a==null?void 0:a.ingredientData.name,quantity:((a==null?void 0:a.rawQuantityForJuice)||a.quantity)<1&&a.unit!=="units"?((a==null?void 0:a.rawQuantityForJuice)||a.quantity)*100:(a==null?void 0:a.rawQuantityForJuice)||a.quantity,unit:(o=we==null?void 0:we.find(h=>h.value===a.unit))==null?void 0:o.display((a==null?void 0:a.rawQuantityForJuice)||a.quantity),costForQuantity:a==null?void 0:a.costForQuantity}}),I?e.jsx("ul",{style:{display:"flex",flexDirection:"column",gap:"5px",padding:0,margin:0,listStyleType:"none"},children:j==null?void 0:j.map((a,o)=>e.jsxs("li",{style:{whiteSpace:"normal",display:"flex"},children:[e.jsx(st,{title:a==null?void 0:a.name,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:a==null?void 0:a.name})}),` (${a.quantity} ${a.unit}) - ₪${a==null?void 0:a.costForQuantity}`]},o))}):e.jsx(L,{ingredients:j})},rules:[{required:!0,message:"יש לבחור לפחות רכיב אחד"}]}];return S==null||S.map(w=>({label:w.name,value:w._id})),d.useEffect(()=>{f&&(n(f),m(f))},[f,S,C]),d.useEffect(()=>{const w=JSON.parse(localStorage.getItem("filtersMenu")||"{}");g(w)},[]),e.jsx(rt,{title:"מתכונים",titleView:"מיקס",type:"mix",data:i,mobileKeys:_,dataPrint:x,sortKeys:R,tableKeys:P,newTitle:"הוסף תערובת חדשה",searchKeys:N,setDataPrint:m,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",ingredientsArr:S,iconADD:e.jsx(D,{icon:Et}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את התערובת?"}),e.jsx("p",{children:"שים לב! מחיקת תערובת עשויה להשפיע על מוצרים המשתמשים בה."})]})})}const{Text:Ea}=Y,{Option:Xe}=ce,Ms=({addEmployee:t,initialValues:r,onClose:s})=>{const[i]=M.useForm(),n=V(g=>g.employees),[x,m]=d.useState("");d.useEffect(()=>{r&&i.setFieldsValue(r)},[r,i]);const u=g=>{if(n.some(f=>f.name===g.name.trim()&&(!r||f._id!==r._id))){m("קיים כבר עובד בעל שם דומה");return}t({...r,...g}),i.resetFields(),s()};return e.jsx(le,{className:"employee-form-card",children:e.jsxs(M,{form:i,layout:"vertical",onFinish:u,initialValues:r,children:[e.jsx(M.Item,{label:"שם עובד",name:"name",rules:[{required:!0,message:"אנא הזן שם עובד"}],children:e.jsx(xe,{})}),e.jsx(M.Item,{label:"תפקיד",name:"position",children:e.jsx(xe,{placeholder:"הזן תפקיד"})}),e.jsx(M.Item,{label:"תעריף שעתי",name:"hourlyRate",rules:[{required:!0,message:"אנא הזן תעריף שעתי"}],children:e.jsx(de,{min:0,style:{width:"100%"}})}),e.jsx(M.Item,{label:"סטטוס",name:"status",initialValue:"active",rules:[{required:!0}],children:e.jsxs(ce,{children:[e.jsx(Xe,{value:"active",children:"פעיל"}),e.jsx(Xe,{value:"inactive",children:"לא פעיל"}),e.jsx(Xe,{value:"on_leave",children:"בחופשה"}),e.jsx(Xe,{value:"terminated",children:"סיים העסקה"})]})}),x&&e.jsx(ln,{style:{display:"block",marginBottom:"10px"},children:e.jsx(Ea,{type:"danger",className:"error-message",children:x})}),e.jsxs(M.Item,{children:[e.jsx(T,{type:"primary",htmlType:"submit",className:"employee-form-button",children:r?"עדכן עובד":"הוסף עובד"}),e.jsx(T,{className:"employee-form-button",onClick:s,style:{marginLeft:"8px"},children:"ביטול"})]})]})})},dt="https://menu-server-c2b952e2c698.herokuapp.com/api",$a=t=>X.post(`${dt}/employees`,t),Aa=t=>{const r=encodeURIComponent(t._id);return X.put(`${dt}/employees/${r}`,t)},Ra=t=>X.delete(`${dt}/employees/${t}`),Ma=(t,r)=>X.get(`${dt}/employees?`),qs=d.createContext(),Ls=()=>d.useContext(qs),qa=({children:t})=>{const[r,s]=d.useState(!1),i=async m=>{s(!0);try{await $a(m),q.success("העובד נוסף בהצלחה"),s(!1)}catch(u){console.error("Error adding employee:",u),q.error("שגיאה בהוספת עובד"),s(!1)}},n=async m=>{s(!0);try{await Aa(m),q.success("העובד עודכן בהצלחה"),s(!1)}catch(u){console.error("Error updating employee:",u),q.error("שגיאה בעדכון עובד"),s(!1)}},x=async m=>{s(!0);try{await Ra(m),q.success("העובד נמחק בהצלחה"),s(!1)}catch(u){console.error("Error deleting employee:",u),q.error("שגיאה במחיקת עובד"),s(!1)}};return e.jsx(qs.Provider,{value:{addEmployee:i,updateEmployee:n,deleteEmployee:x,loading:r},children:t})},{Text:mt}=Y,La=({sortKey:t})=>{const{updateEmployee:r,deleteEmployee:s}=Ls(),i=V(C=>C.employees),[n,x]=d.useState(!1),[m,u]=d.useState(null),g=C=>{u(C),x(!0)},f=()=>{u(null),x(!1)},S=[...i].sort((C,L)=>t==="name"?C.name.localeCompare(L.name):0);return e.jsxs(le,{title:"רשימת עובדים",className:"employee-list-card",children:[e.jsx(ue,{itemLayout:"vertical",dataSource:S,renderItem:C=>e.jsx(ue.Item,{className:"employee-item",actions:[e.jsx(T,{type:"link",onClick:()=>g(C),children:"ערוך"}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את העובד הנוכחי?",onConfirm:()=>s(C._id),okText:"כן",cancelText:"לא",children:e.jsx(T,{icon:e.jsx(_e,{}),danger:!0})})],children:e.jsx(ue.Item.Meta,{title:e.jsx(mt,{strong:!0,children:C.name}),description:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(mt,{strong:!0,children:"תפקיד:"})," ",C.position||"לא הוגדר"]}),e.jsxs("p",{children:[e.jsx(mt,{strong:!0,children:"תעריף שעתי:"})," ",C.hourlyRate," ₪"]}),e.jsx("p",{children:e.jsx(Ke,{color:Da(C.status),text:Oa(C.status),style:{marginLeft:"8px"}})})]})})},C._id)}),e.jsx(fe,{title:m?"ערוך עובד":"הוסף עובד חדש",open:n,onCancel:f,footer:null,children:e.jsx(Ms,{addEmployee:r,initialValues:m,onClose:f})})]})},Oa=t=>{switch(t){case"active":return"פעיל";case"inactive":return"לא פעיל";case"on_leave":return"בחופשה";case"terminated":return"סיים העסקה";default:return"לא ידוע"}},Da=t=>{switch(t){case"active":return"green";case"inactive":return"grey";case"on_leave":return"orange";case"terminated":return"red";default:return"blue"}};function Ua(){const{addEmployee:t}=Ls(),[r,s]=d.useState(!1),[i,n]=d.useState(""),x=()=>{s(!0)},m=()=>{s(!1)};return e.jsxs("div",{style:{padding:"20px"},className:"scrollable-content employees-page-container",children:[e.jsxs("div",{className:"employees-controls",children:[e.jsx(T,{type:"primary",onClick:x,className:"add-employee-button",children:"הוסף עובד חדש"}),e.jsxs(ce,{value:i,onChange:u=>n(u),className:"sort-select",children:[e.jsx(ce.Option,{value:"",children:"מיין"}),e.jsx(ce.Option,{value:"name",children:"מיין לפי שם"})]})]}),e.jsx(La,{sortKey:i}),e.jsx(fe,{title:"הוסף עובד חדש",open:r,onCancel:m,footer:null,destroyOnClose:!0,children:e.jsx(Ms,{addEmployee:t,onClose:m})})]})}const Ge="https://menu-server-c2b952e2c698.herokuapp.com/api",Ha=(t,r)=>X.post(`${Ge}/employees/${t}/hours`,r),Ba=(t,r)=>X.put(`${Ge}/employees/hours/${t}`,r),Wa=t=>X.delete(`${Ge}/employees/hours/${t}`),za=t=>X.get(`${Ge}/employees/${t}/hours`),Qa=(t,r)=>X.get(`${Ge}/employees/hours/${r}/${t}`),Os=d.createContext(),Ya=()=>d.useContext(Os),Ja=({children:t})=>{const[r,s]=d.useState(!1),i=async(u,g)=>new Promise(async(f,S)=>{var C;s(!0);try{const L=await Ha(u,g);if((L==null?void 0:L.status)===200){q.error((C=L.data)==null?void 0:C.message),S(!1);return}q.success("שעות העבודה נוספו בהצלחה"),f(!0)}catch(L){console.error("Error adding employee hours:",L),q.error("שגיאה בהוספת שעות עבודה"),S(!1)}finally{s(!1)}}),n=async(u,g)=>new Promise(async(f,S)=>{s(!0);try{(await Ba(u,g)).status!==201?S(!1):(q.success("שעות העבודה עודכנו בהצלחה"),f(!0))}catch(C){console.error("Error updating employee hours:",C),q.error("שגיאה בעדכון שעות עבודה"),S(!1)}finally{s(!1)}}),x=async u=>{s(!0);try{const g=await za(u);return q.success("שעות העבודה נשלפו בהצלחה"),g.data}catch(g){console.error("Error fetching employee hours:",g),q.error("שגיאה בשליפת שעות עבודה")}finally{s(!1)}},m=async u=>{s(!0);try{await Wa(u),q.success("שעות העבודה נמחקו בהצלחה")}catch(g){console.error("Error deleting employee hours:",g),q.error("שגיאה במחיקת שעות עבודה")}finally{s(!1)}};return e.jsx(Os.Provider,{value:{loading:r,addEmployeeHours:i,updateEmployeeHours:n,deleteEmployeeHours:m,fetchEmployeeHours:x},children:t})},{Option:Ga}=ce,Xa=({visible:t,onClose:r,dayData:s})=>{const{addEmployeeHours:i,updateEmployeeHours:n,deleteEmployeeHours:x}=Ya(),m=V(c=>c.employees),[u,g]=d.useState(),[f,S]=d.useState(),[C,L]=d.useState(!1),[N]=M.useForm();if(!s)return null;const _=()=>{const c=C?n:i,p=C?f:u;c(C?p==null?void 0:p.hoursId:p.employeeId,p).then(()=>{g(),L(!1),N.resetFields()}).catch(()=>{})},R=c=>{S({...c,employeeId:c.employeeId,startTime:c.hours.start,endTime:c.hours.end,date:s.date}),L(!0)},P=()=>{g(null),L(!1)},v=c=>{x(c)},w=m==null?void 0:m.filter(c=>!s.employees.some(p=>p.employeeId===c._id));return e.jsxs(fe,{title:`ניהול שעות עבודה ליום ${s.date}`,open:t,onCancel:r,footer:null,width:800,style:{top:"1em"},destroyOnClose:!0,children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"סיכום יום"}),e.jsxs("p",{children:["תאריך: ",s.date]}),e.jsxs("p",{children:["יום בשבוע: ",s.dayOfWeek]}),e.jsx(Pe,{color:(s==null?void 0:s.status)==="חצי יום"?"orange":"green",children:s==null?void 0:s.status})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:C?"עריכת עובד":"הוספת עובד חדש"}),e.jsx(M,{form:N,layout:"vertical",onFinish:_,children:e.jsx(M.Item,{label:"בחר עובד",style:{maxWidth:"400px"},children:e.jsx(ce,{showSearch:!0,placeholder:"חיפוש והוספת עובד",optionFilterProp:"children",value:(u==null?void 0:u.employeeId)||null,onChange:c=>{const p=w.find(I=>I._id===c);g({name:p==null?void 0:p.name,startTime:"",endTime:"",date:s==null?void 0:s.date,employeeId:p._id})},filterOption:(c,p)=>p.children.toLowerCase().includes(c.toLowerCase()),children:w==null?void 0:w.map(c=>e.jsx(Ga,{value:c._id,children:c.name},c._id))})})})]}),e.jsx(Z,{}),u&&e.jsxs(M,{layout:"inline",onFinish:_,initialValues:{startTime:u==null?void 0:u.startTime,endTime:u==null?void 0:u.endTime},children:[e.jsx(M.Item,{label:"שעת כניסה",children:e.jsx(xe,{placeholder:"HH:mm",value:u==null?void 0:u.startTime,onChange:c=>g(p=>({...p,startTime:c.target.value}))})}),e.jsx(M.Item,{label:"שעת יציאה",children:e.jsx(xe,{placeholder:"HH:mm",value:u==null?void 0:u.endTime,onChange:c=>g(p=>({...p,endTime:c.target.value}))})}),!(u!=null&&u._id)&&e.jsx(T,{type:"primary",onClick:_,children:"שמור שעות עבודה"})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"עובדים שנוספו"}),e.jsx(ue,{bordered:!0,className:"scroll-content",style:{maxHeight:"25em",overflow:"auto"},dataSource:s==null?void 0:s.employees,renderItem:c=>{var p,I,j;return e.jsx(ue.Item,{children:e.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{fontWeight:"500",width:"6em"},children:c.name}),C&&c.employeeId===(f==null?void 0:f.employeeId)?e.jsxs(e.Fragment,{children:[e.jsx(xe,{placeholder:"שעת כניסה",value:f==null?void 0:f.startTime,onChange:a=>S(o=>({...o,startTime:a.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsx(xe,{placeholder:"שעת יציאה",value:f==null?void 0:f.endTime,onChange:a=>S(o=>({...o,endTime:a.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsxs(O,{style:{gap:"0.5em"},children:[e.jsx(T,{type:"primary",icon:e.jsx(In,{}),onClick:_}),e.jsx(T,{icon:e.jsx($t,{}),onClick:P,style:{marginLeft:"5px"}})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:"כניסה",value:(p=c==null?void 0:c.hours)==null?void 0:p.start}),e.jsx(Ze,{title:"יציאה",value:(I=c==null?void 0:c.hours)==null?void 0:I.end}),e.jsx(Ze,{title:"סך שעות",value:(j=c==null?void 0:c.hoursWorked)==null?void 0:j.toFixed(2)}),e.jsxs(O,{style:{gap:"0.5em"},children:[e.jsx(T,{icon:e.jsx(At,{}),onClick:()=>R(c)}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את העובד?",onConfirm:()=>v(c.hoursId),okText:"כן",cancelText:"לא",children:e.jsx(T,{icon:e.jsx(_e,{}),danger:!0})})]})]})]})})}})]})]})},Va=({monthData:t})=>{const[r,s]=d.useState(!1),[i,n]=d.useState(null),x=g=>{n(g),s(!0)},m=[{title:"תאריך",dataIndex:"date",key:"date"},{title:"יום בשבוע",dataIndex:"dayOfWeek",key:"dayOfWeek"},{title:"סטטוס",dataIndex:"status",key:"status",render:g=>e.jsx(Pe,{color:g==="חצי יום"?"orange":"green",children:g})},{title:"מספר עובדים",dataIndex:"employeesCount",key:"employeesCount",render:g=>g??"לא ידוע"},{title:"סך הכל שעות",dataIndex:"totalHours",key:"totalHours",render:g=>(g==null?void 0:g.toFixed(2))??"לא ידוע"}],u=g=>{let f="";return g!=null&&g.hasError&&(f+="workhours-error "),g.isToday?f+="today-row":g.isPast&&(f+="past-row"),f};return e.jsxs(e.Fragment,{children:[e.jsx(as,{columns:m,dataSource:t,rowKey:"date",pagination:!1,rowClassName:u,onRow:(g,f)=>({onClick:()=>(g.isToday||g.isPast)&&x(f)})}),e.jsx(Xa,{visible:r,onClose:()=>s(!1),dayData:t[i]})]})},{MonthPicker:Za}=on;Se.locale("he");const Ka=()=>{const t=ze(),r=V(n=>n.employeeHours.data),s=V(n=>n.employeeHours.selectedDate),i=n=>{t(Dr(n.format("YYYY-MM")))};return e.jsxs("div",{className:"workhours-container",children:[e.jsx("h1",{children:"ניהול שעות עבודה חודשיות"}),e.jsx(Za,{onChange:i,placeholder:"בחר חודש ושנה",disabledDate:n=>n&&n>Se().endOf("month")},s),e.jsx(Va,{monthData:r})," "]})},Ds=Ie({name:"suppliers",initialState:[],reducers:{addSuppliersState:(t,r)=>r.payload,addOrUpdateSupplierState:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateSupplierState:(t,r)=>{const s=r.payload;return t.map(i=>i._id===s._id?s:i)},deleteSupplierState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{addSuppliersState:ei,addOrUpdateSupplierState:ti,updateSupplierState:si,deleteSupplierState:ni}=Ds.actions,ri=Ds.reducer;function ht(t){let r,s,i,n;const x=t.price/1.17;return t.unit==='ק"ג'||t.unit==="weight"?(r=.1,s="גרם",i=x/t.quantity*r):t.unit==="ליטר"||t.unit==="volume"?(r=.1,s='מ"ל',i=x/t.quantity*r):(t.unit==="יחידות"||t.unit==="units")&&(r=1,s="יחידה",i=x/t.quantity),t.isJuice&&(n=i/(t.juiceRatio||1)),{...t,priceExcludingVAT:x.toFixed(2),unitQuantity:r,unitDescription:s,unitPrice:i.toFixed(2),processedPrice:n?n.toFixed(2):null}}const Us=Ie({name:"ingredients",initialState:[],reducers:{addIngerdientsState:(t,r)=>r.payload.map(ht),addOrUpdateIngredientState:(t,r)=>{const s=ht(r.payload),i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateIngredientState:(t,r)=>{const s=ht(r.payload);return t.map(i=>i._id===s._id?s:i)},deleteIngredientState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{addIngerdientsState:ai,addOrUpdateIngredientState:ii,updateIngredientState:li,deleteIngredientState:oi}=Us.actions,di=Us.reducer,Hs=Ie({name:"mixes",initialState:[],reducers:{setMixesState:(t,r)=>{const{mixes:s,ingredientsState:i}=r.payload;return s},addOrUpdateMixState:(t,r)=>{const{newMix:s,ingredientsState:i}=r.payload,n=s,x=t.findIndex(m=>m._id===s._id);x!==-1?t[x]=n:t.unshift(n)},updateMixState:(t,r)=>{const{updatedMix:s,ingredientsState:i}=r.payload,n=s,x=t.findIndex(m=>m._id===s._id);x!==-1&&(t[x]=n)},deleteMixState:(t,r)=>t.filter(s=>s._id!==r.payload._id)}}),{setMixesState:ci,addOrUpdateMixState:ui,updateMixState:xi,deleteMixState:pi}=Hs.actions,mi=Hs.reducer,Bs=Ie({name:"categories",initialState:[],reducers:{setCategories:(t,r)=>r.payload,addOrUpdateCategory:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateCategory:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1&&(t[i]=s)},deleteCategory:(t,r)=>{const s=r.payload;return t.filter(i=>i._id!==s)}}}),{setCategories:hi,addOrUpdateCategory:gi,updateCategory:ji,deleteCategory:fi}=Bs.actions,yi=Bs.reducer,Ws=Ie({name:"employees",initialState:[],reducers:{setEmployees:(t,r)=>r.payload,addOrUpdateEmployee:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.push(s)},updateEmployee:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1&&(t[i]=s)},deleteEmployee:(t,r)=>t.filter(s=>s._id!==r.payload)}}),{setEmployees:vi,addOrUpdateEmployee:wi,updateEmployee:bi,deleteEmployee:Ci}=Ws.actions,Si=Ws.reducer,Ii=(t,r)=>{t.on("ingredientAdded",s=>{r(ii(s))}),t.on("ingredientUpdated",s=>{r(li(s))}),t.on("ingredientDeleted",s=>{r(oi(s))}),t.on("supplierAdded",s=>{r(ti(s))}),t.on("supplierUpdated",s=>{r(si(s))}),t.on("supplierDeleted",s=>{r(ni(s))}),t.on("productAdded",s=>{r((i,n)=>{const x=n().ingredients,m=n().mixes;i(bt({newProduct:s,ingredientsState:x,mixesState:m}))})}),t.on("productUpdated",s=>{r((i,n)=>{const x=n().ingredients,m=n().mixes;i(bt({newProduct:s,ingredientsState:x,mixesState:m}))})}),t.on("productDeleted",s=>{r(Hr(s))}),t.on("categoryAdded",s=>{r(gi(s))}),t.on("categoryUpdated",s=>{r(ji(s))}),t.on("categoryDeleted",s=>{r(fi(s._id))}),t.on("mixAdded",s=>{r((i,n)=>{const x=n().ingredients;i(ui({newMix:s,ingredientsState:x}))})}),t.on("mixUpdated",s=>{r((i,n)=>{const x=n().ingredients;i(xi({updatedMix:s,ingredientsState:x}))})}),t.on("mixDeleted",s=>{r(pi(s))}),t.on("employeeAdded",s=>{r(wi(s))}),t.on("employeeUpdated",s=>{r(bi(s))}),t.on("employeeDeleted",s=>{r(Ci(s._id))}),t.on("employeeHoursAdded",s=>{r(qr(s))}),t.on("employeeHoursUpdated",s=>{r(Lr(s))}),t.on("employeeHoursDeleted",s=>{r(Or({_id:s._id}))})},ss="https://menu-server-c2b952e2c698.herokuapp.com/",Ni=d.createContext(),ki=({children:t})=>{const r=ze();return console.log(ss),d.useEffect(()=>{const s=Mn(ss);return Ii(s,r),()=>s.disconnect()},[r]),e.jsx(Ni.Provider,{value:{},children:t})};q.config({prefixCls:"my-message"});const Fi=({children:t,setLoading:r})=>{const s=ze(),i=V(x=>x.employeeHours.selectedDate),n=V(x=>{var m,u;return(u=(m=x.settings.settings)==null?void 0:m.hourlyRate)==null?void 0:u.value});return d.useEffect(()=>{(async()=>{var g,f;r(!0);const m=zt(i).year(),u=zt(i).month()+1;try{const[S,C,L,N,_,R,P]=await Promise.all([ia(),Kr(),bs(),kr(),Fa(),Ma(),Qa(u,m)]);s(ai((g=S==null?void 0:S.data)==null?void 0:g.reverse())),s((v,w)=>{var p;const c=w().ingredients;v(ci({mixes:(p=_==null?void 0:_.data)==null?void 0:p.reverse(),ingredientsState:c}))}),s((v,w)=>{var I;const c=w().ingredients,p=w().mixes;v(Ps({products:(I=L.data)==null?void 0:I.reverse(),ingredientsState:c,mixesState:p,averageHourlyRate:n}))}),s(hi(N.data)),s(ei((f=C==null?void 0:C.data)==null?void 0:f.reverse())),s(vi(R.data)),s(Rr({selectedDate:i,employees:R.data,employeeHours:P==null?void 0:P.data})),r(!1)}catch(S){console.error("Error fetching data:",S),r(!1)}})()},[s,r,i]),e.jsx(ki,{children:e.jsx(oa,{children:e.jsx(ta,{children:e.jsx(jr,{children:e.jsx(_a,{children:e.jsx(Pr,{children:e.jsx(qa,{children:e.jsx(Ja,{children:e.jsx(ya,{children:t})})})})})})})})})},Ct="/assets/logo-Ha-8mVYV.png";function te(...t){return Qn(zn(t))}const zs=On,Pi=Ln,Qs=d.forwardRef(({className:t,...r},s)=>e.jsx(xs,{ref:s,className:te("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));Qs.displayName=xs.displayName;const qt=d.forwardRef(({className:t,children:r,...s},i)=>e.jsxs(Pi,{children:[e.jsx(Qs,{}),e.jsxs(ps,{ref:i,className:te("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[r,e.jsxs(qn,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(wt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qt.displayName=ps.displayName;const Lt=({className:t,...r})=>e.jsx("div",{className:te("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Lt.displayName="DialogHeader";const Ot=d.forwardRef(({className:t,...r},s)=>e.jsx(ms,{ref:s,className:te("text-lg font-semibold leading-none tracking-tight",t),...r}));Ot.displayName=ms.displayName;const _i=d.forwardRef(({className:t,...r},s)=>e.jsx(hs,{ref:s,className:te("text-sm text-muted-foreground",t),...r}));_i.displayName=hs.displayName;const Ti=Mt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ee=d.forwardRef(({className:t,...r},s)=>e.jsx(gs,{ref:s,className:te(Ti(),t),...r}));Ee.displayName=gs.displayName;const Ei=tr,Ys=d.createContext({}),Ve=({...t})=>e.jsx(Ys.Provider,{value:{name:t.name},children:e.jsx(sr,{...t})}),ct=()=>{const t=d.useContext(Ys),r=d.useContext(Js),{getFieldState:s,formState:i}=er(),n=s(t.name,i);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:x}=r;return{id:x,name:t.name,formItemId:`${x}-form-item`,formDescriptionId:`${x}-form-item-description`,formMessageId:`${x}-form-item-message`,...n}},Js=d.createContext({}),Le=d.forwardRef(({className:t,...r},s)=>{const i=d.useId();return e.jsx(Js.Provider,{value:{id:i},children:e.jsx("div",{ref:s,className:te("space-y-2",t),...r})})});Le.displayName="FormItem";const Oe=d.forwardRef(({className:t,...r},s)=>{const{error:i,formItemId:n}=ct();return e.jsx(Ee,{ref:s,className:te(i&&"text-destructive",t),htmlFor:n,...r})});Oe.displayName="FormLabel";const De=d.forwardRef(({...t},r)=>{const{error:s,formItemId:i,formDescriptionId:n,formMessageId:x}=ct();return e.jsx(js,{ref:r,id:i,"aria-describedby":s?`${n} ${x}`:`${n}`,"aria-invalid":!!s,...t})});De.displayName="FormControl";const $i=d.forwardRef(({className:t,...r},s)=>{const{formDescriptionId:i}=ct();return e.jsx("p",{ref:s,id:i,className:te("text-[0.8rem] text-muted-foreground",t),...r})});$i.displayName="FormDescription";const Ue=d.forwardRef(({className:t,children:r,...s},i)=>{const{error:n,formMessageId:x}=ct(),m=n?String(n==null?void 0:n.message):r;return m?e.jsx("p",{ref:i,id:x,className:te("text-[0.8rem] font-medium text-destructive",t),...s,children:m}):null});Ue.displayName="FormMessage";const St=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("rounded-xl border bg-card text-card-foreground shadow",t),...r}));St.displayName="Card";const It=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("flex flex-col space-y-1.5 p-6",t),...r}));It.displayName="CardHeader";const Nt=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("font-semibold leading-none tracking-tight",t),...r}));Nt.displayName="CardTitle";const Ai=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("text-sm text-muted-foreground",t),...r}));Ai.displayName="CardDescription";const He=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("p-6 pt-0",t),...r}));He.displayName="CardContent";const Ri=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("flex items-center p-6 pt-0",t),...r}));Ri.displayName="CardFooter";const Mi=Mt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ge=d.forwardRef(({className:t,variant:r,size:s,asChild:i=!1,...n},x)=>{const m=i?js:"button";return e.jsx(m,{className:te(Mi({variant:r,size:s,className:t})),ref:x,...n})});ge.displayName="Button";const Ce=d.forwardRef(({className:t,type:r,...s},i)=>e.jsx("input",{type:r,className:te("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:i,...s}));Ce.displayName="Input";const qi=Mt("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Gs=d.forwardRef(({className:t,variant:r,...s},i)=>e.jsx("div",{ref:i,role:"alert",className:te(qi({variant:r}),t),...s}));Gs.displayName="Alert";const Li=d.forwardRef(({className:t,...r},s)=>e.jsx("h5",{ref:s,className:te("mb-1 font-medium leading-none tracking-tight",t),...r}));Li.displayName="AlertTitle";const Xs=d.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("text-sm [&_p]:leading-relaxed",t),...r}));Xs.displayName="AlertDescription";const Oi=Dn,Vs=d.forwardRef(({className:t,...r},s)=>e.jsx(fs,{ref:s,className:te("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));Vs.displayName=fs.displayName;const kt=d.forwardRef(({className:t,...r},s)=>e.jsx(ys,{ref:s,className:te("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));kt.displayName=ys.displayName;const Ft=d.forwardRef(({className:t,...r},s)=>e.jsx(vs,{ref:s,className:te("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Ft.displayName=vs.displayName;const Di=Hn,Ui=Bn,Zs=d.forwardRef(({className:t,align:r="center",sideOffset:s=4,...i},n)=>e.jsx(Un,{children:e.jsx(ws,{ref:n,align:r,sideOffset:s,className:te("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})}));Zs.displayName=ws.displayName;const ns=({value:t,onChange:r})=>{const s=["#2196F3","#1976D2","#0D47A1","#4FC3F7","#4CAF50","#2E7D32","#81C784","#26A69A","#F44336","#D32F2F","#FF7043","#FF5722","#9C27B0","#7B1FA2","#E91E63","#6A1B9A"];return e.jsxs(Di,{children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(ge,{variant:"outline",className:"w-[140px] flex items-center justify-between gap-2 rtl",children:[e.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm border border-zinc-200",style:{backgroundColor:t||"#ffffff"}}),e.jsx("span",{className:"flex-1 text-right",children:"בחר צבע"}),e.jsx(Yn,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Zs,{className:"w-[256px] p-3",align:"start",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.map(i=>e.jsx("button",{className:te("h-10 w-10 rounded-md relative","transition-all duration-100 ease-in-out","hover:scale-110 hover:shadow-lg","focus:outline-none focus:ring-2 focus:ring-zinc-400",t===i&&"ring-2 ring-zinc-800"),style:{backgroundColor:i,transform:t===i?"scale(1.1)":"scale(1)"},onClick:()=>r(i),children:t===i&&e.jsx(Jn,{className:te("absolute inset-0 m-auto","w-4 h-4 text-white","drop-shadow-[0_2px_3px_rgba(0,0,0,0.3)]")})},i))})})]})},Hi=Me.object({hourlyRate:Me.number().positive("עלות שעת עבודה חייבת להיות מספר חיובי").min(0),fixedExpensesRate:Me.number().min(0,"האחוז חייב להיות בין 0 ל-100").max(100,"האחוז חייב להיות בין 0 ל-100"),profitRate:Me.number().min(0,"האחוז חייב להיות בין 0 ל-100").max(100,"האחוז חייב להיות בין 0 ל-100"),vatRate:Me.number().min(0,'מע"מ חייב להיות מספר חיובי').max(100,'מע"מ חייב להיות מספר חיובי')});function Bi({open:t,onConfirm:r,onCancel:s,itemName:i}){return e.jsx(zs,{open:t,onOpenChange:s,children:e.jsxs(qt,{className:"max-w-sm",children:[e.jsx(Lt,{children:e.jsx(Ot,{children:"מחיקת קטגוריה"})}),e.jsxs("p",{children:['האם אתה בטוח שברצונך למחוק את הקטגוריה "',i,'"?']}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(ge,{variant:"outline",onClick:s,children:"ביטול"}),e.jsx(ge,{variant:"destructive",onClick:r,children:"מחיקה"})]})]})})}function Wi({flag:t,setFlag:r}){var re,ae,ie,k,A;const{settings:s,loading:i,updateSetting:n,fetchSettings:x,addCategoryContext:m,updateCategoryContext:u,deleteCategoryContext:g}=As(),f=nr({resolver:rr(Hi),defaultValues:{hourlyRate:((re=s==null?void 0:s.hourlyRate)==null?void 0:re.value)||0,fixedExpensesRate:((ae=s==null?void 0:s.fixedExpensesRate)==null?void 0:ae.value)||0,profitRate:((ie=s==null?void 0:s.profitRate)==null?void 0:ie.value)||0,vatRate:parseFloat((k=s==null?void 0:s.vatRate)==null?void 0:k.value)||0}}),[S,C]=d.useState({name:"",description:"",color:""}),[L,N]=d.useState(!1),[_,R]=d.useState(null),[P,v]=d.useState(null),[w,c]=d.useState(!1),[p,I]=d.useState(null),[j,a]=d.useState(null);d.useEffect(()=>{t&&(x(),a(null))},[t]),d.useEffect(()=>{var l,$,H,K;s&&f.reset({hourlyRate:parseFloat((l=s==null?void 0:s.hourlyRate)==null?void 0:l.value)||0,fixedExpensesRate:parseFloat(($=s==null?void 0:s.fixedExpensesRate)==null?void 0:$.value)||0,profitRate:parseFloat((H=s==null?void 0:s.profitRate)==null?void 0:H.value)||0,vatRate:parseFloat((K=s==null?void 0:s.vatRate)==null?void 0:K.value)||0})},[s,f]);const o=l=>{R(l),v({name:l.name,description:l.description}),a(null)},h=()=>{R(null),v(null),a(null)},b=(l,$)=>{v(H=>({...H,[l]:$}))},E=async()=>{var l;if(!((l=P==null?void 0:P.name)!=null&&l.trim())){a("שם הקטגוריה הוא שדה חובה");return}try{await u(_._id,{..._,...P}),h(),await x()}catch{a("שגיאה בעדכון הקטגוריה")}},F=async()=>{var l;if(!((l=S.name)!=null&&l.trim())){a("שם הקטגוריה הוא שדה חובה");return}try{await m(S),C({name:"",description:"",color:""}),N(!1),a(null),await x()}catch{a("שגיאה בהוספת הקטגוריה")}},y=l=>{var $;return($=s==null?void 0:s.materialCategories)==null?void 0:$.value.some(H=>H.color===l)},W=async()=>{try{await g(p._id),await x(),c(!1)}catch{a("שגיאה במחיקת הקטגוריה")}},J=l=>{I(l),c(!0)},G=async l=>{try{const $={hourlyRate:{value:parseFloat(l.hourlyRate)},fixedExpensesRate:{value:parseFloat(l.fixedExpensesRate)},profitRate:{value:parseFloat(l.profitRate)},vatRate:{value:parseFloat(l.vatRate)}};await n($)}catch{}};return e.jsxs(zs,{open:t,onOpenChange:r,className:"rtl",children:[e.jsxs(qt,{className:"max-w-4xl h-[90vh] overflow-hidden",children:[e.jsx(Lt,{children:e.jsx(Ot,{className:"text-2xl font-bold",children:"הגדרות מערכת"})}),e.jsxs(Oi,{defaultValue:"general",className:"h-full rtl",children:[e.jsxs(Vs,{className:"grid w-full grid-cols-2 rtl",children:[e.jsxs(kt,{value:"general",className:"flex items-center gap-2 rtl",children:[e.jsx(Gn,{className:"w-4 h-4 rtl"}),"הגדרות כלליות"]}),e.jsxs(kt,{value:"categories",className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),"קטגוריות"]})]}),e.jsxs("div",{className:"px-1 rtl",style:{height:"calc(90vh - 140px)"},children:[j&&e.jsx(Gs,{variant:"destructive",className:"mb-4",children:e.jsx(Xs,{children:j})}),e.jsxs(Ft,{value:"general",className:"mt-4 rtl flex flex-col w-full",children:[e.jsx(It,{className:"rtl",children:e.jsx(Nt,{children:"הגדרות תמחור"})}),e.jsx(He,{className:"space-y-4 flex-1 rtl",children:e.jsx(Ei,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(G),className:"space-y-4",children:[e.jsx(Ve,{control:f.control,name:"hourlyRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"עלות שעת עבודה (₪)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",placeholder:"הכנס עלות שעת עבודה",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"fixedExpensesRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"אחוז השתתפות בהוצאות קבועות (%)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",max:"100",placeholder:"הכנס אחוז הוצאות",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"profitRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"אחוז רווח רצוי (%)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",max:"100",placeholder:"הכנס אחוז רווח",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"vatRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:' מע"מ (%)'}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.01",min:"0.10",max:"100",placeholder:'מע"מ',onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx("div",{className:"flex justify-center text-center",children:e.jsxs(ge,{type:"submit",className:"flex items-center gap-2",disabled:i,children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור הגדרות"]})})]})})})]}),e.jsxs(Ft,{value:"categories",className:"mt-4 rtl flex flex-col w-full",children:[e.jsxs(It,{className:"flex flex-row items-center justify-between",children:[e.jsx(Nt,{children:"קטגוריות חומרי גלם"}),!L&&e.jsxs(ge,{variant:"outline",onClick:()=>N(!0),className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"}),"הוסף קטגוריה"]})]}),e.jsxs(He,{className:"space-y-4",children:[L&&e.jsx(St,{className:"border-2 border-zinc-200",children:e.jsxs(He,{className:"space-y-4 p-4",children:[e.jsxs("div",{children:[e.jsx(Ee,{children:"שם הקטגוריה"}),e.jsx(Ce,{value:S.name,onChange:l=>C({...S,name:l.target.value}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Ee,{children:"תיאור"}),e.jsx(Ce,{value:S.description,onChange:l=>C({...S,description:l.target.value}),className:"mt-1"})]}),e.jsx(ns,{value:S.color,onChange:l=>{y(l)?a("צבע זה כבר בשימוש"):C({...S,color:l})}}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(ge,{onClick:F,className:"flex items-center gap-2",disabled:i,children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור"]}),e.jsxs(ge,{variant:"outline",onClick:()=>{N(!1),C({name:"",description:"",color:""})},className:"flex items-center gap-2",disabled:i,children:[e.jsx(wt,{className:"w-4 h-4"}),"ביטול"]})]})]})}),e.jsx("div",{className:"space-y-2 max-h-[59vh] overflow-y-auto pr-2",children:(A=s==null?void 0:s.materialCategories)==null?void 0:A.value.map(l=>e.jsx(St,{className:"border border-zinc-200",children:e.jsx(He,{className:"p-4",children:(_==null?void 0:_._id)===l._id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ee,{children:"שם"}),e.jsx(Ce,{value:P==null?void 0:P.name,onChange:$=>b("name",$.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Ee,{children:"תיאור"}),e.jsx(Ce,{value:P==null?void 0:P.description,onChange:$=>b("description",$.target.value),className:"mt-1"})]}),e.jsx(ns,{value:(P==null?void 0:P.color)||(l==null?void 0:l.color),onChange:$=>{y($)?a("צבע זה כבר בשימוש"):b("color",$)}}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(ge,{onClick:E,disabled:i,className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור"]}),e.jsxs(ge,{variant:"outline",onClick:h,disabled:i,className:"flex items-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4"}),"ביטול"]})]})]}):e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex flex-row items-center gap-2",style:{},children:[l.name,e.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm border border-zinc-200",style:{backgroundColor:l==null?void 0:l.color}})]}),e.jsx("div",{className:"text-sm text-zinc-500",style:{},children:l.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ge,{variant:"outline",size:"sm",onClick:()=>o(l),className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"}),"ערוך"]}),e.jsxs(ge,{variant:"destructive",size:"sm",onClick:()=>J(l._id),className:"flex items-center gap-2",children:[e.jsx(Kn,{className:"w-4 h-4"}),"מחק"]})]})]})})},l._id))})]})]})]})]})]}),e.jsx(Bi,{open:w,onConfirm:W,onCancel:()=>c(!1),itemName:p==null?void 0:p.name})]})}function zi({drawerVisible:t,setDrawerVisible:r,isMobile:s}){const[i,n]=d.useState(!1);return e.jsxs("div",{className:"top-bar",children:[e.jsx(pe,{to:"/",children:e.jsx(yt,{className:"logo-mobile",src:Ct,alt:"GainGuard",preview:!1})}),e.jsxs("div",{children:[e.jsx("button",{className:"settings-button",onClick:()=>n(!i),children:e.jsx(D,{icon:gn})}),s&&e.jsx("button",{className:"menu-button",onClick:()=>r(!t),children:e.jsx(D,{icon:jn})}),e.jsx(Wi,{flag:i,setFlag:()=>n(!1)})]})]})}const{Header:Qi,Content:Yi,Footer:Ji}=ls;function Gi(){const[t,r]=d.useState(!1),[s,i]=d.useState(!1),n=Te({query:"(max-width: 1200px)"});return e.jsxs(Fi,{setLoading:i,children:[e.jsx(dn,{fullscreen:!0,spinning:s,size:"large"}),e.jsx(Rn,{children:e.jsxs(ls,{className:"app-container",style:{minHeight:n?"85vh":"100vh"},children:[e.jsxs("div",{className:"nav-container",children:[e.jsx("div",{className:"nav-top",children:e.jsx(yt,{className:"logo",src:Ct,alt:"GainGuard",preview:!1})}),e.jsx(rs,{})]}),e.jsxs("div",{className:"body-container",children:[e.jsxs(Qi,{className:"header",style:{padding:"0 20px"},children:[e.jsx(zi,{isMobile:n,drawerVisible:t,setDrawerVisible:r}),e.jsx(Z,{className:"no-margin"})]}),e.jsx(Yi,{className:"content",children:e.jsxs(ar,{children:[e.jsx(Fe,{path:"/",element:e.jsx(Sa,{})}),e.jsx(Fe,{path:"/menu",element:e.jsx(Gr,{})}),e.jsx(Fe,{path:"/suppliers",element:e.jsx(sa,{})}),e.jsx(Fe,{path:"/mixes",element:e.jsx(Ta,{})}),e.jsx(Fe,{path:"/ingredients",element:e.jsx(wa,{})}),e.jsx(Fe,{path:"/employees",element:e.jsx(Ua,{})}),e.jsx(Fe,{path:"/work-hours",element:e.jsx(Ka,{})})]})}),e.jsx(Ji,{className:"footer",children:"© 2024 מערכת ניהול תפריט ועץ מוצר"})]}),e.jsx(is,{title:e.jsxs(z,{children:[e.jsx(yt,{className:"logo",src:Ct,alt:"GainGuard",preview:!1}),e.jsx("p",{children:"ניווט"})]}),placement:"right",closable:!0,onClose:()=>r(!1),open:t,width:300,children:e.jsx(rs,{onClose:()=>r(!1)})})]})})]})}function rs({onClose:t}){const r=ir(),s=i=>r.pathname===i?"link-active":"link";return e.jsxs("div",{className:"nav-desktop-child",children:[e.jsx(Z,{}),e.jsx(T,{type:"link",onClick:t,className:s("/"),children:e.jsxs(pe,{to:"/",children:[e.jsx(D,{icon:fn})," ",e.jsx("p",{children:"לוח מחוונים"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/menu"),children:e.jsxs(pe,{to:"/menu",children:[e.jsx(D,{icon:tt})," ",e.jsx("p",{children:"תפריט"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/mixes"),children:e.jsxs(pe,{to:"/mixes",children:[e.jsx(D,{icon:Et})," ",e.jsx("p",{children:"מתכונים"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/ingredients"),children:e.jsxs(pe,{to:"/ingredients",children:[e.jsx(D,{icon:We})," ",e.jsx("p",{children:"חומרי גלם"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/suppliers"),children:e.jsxs(pe,{to:"/suppliers",children:[e.jsx(D,{icon:nt})," ",e.jsx("p",{children:"ספקים"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/employees"),children:e.jsxs(pe,{to:"/employees",children:[e.jsx(D,{icon:yn})," ",e.jsx("p",{children:"עובדים"})]})}),e.jsx(T,{type:"link",onClick:t,className:s("/work-hours"),children:e.jsxs(pe,{to:"/work-hours",children:[e.jsx(D,{icon:Tt})," ",e.jsx("p",{children:"ניהול שעות עבודה"})]})})]})}const gt=us("dashboard/fetchDashboardData",async(t,{getState:r})=>(r(),{})),Xi=Ie({name:"dashboard",initialState:[],reducers:{},extraReducers:t=>{t.addCase(gt.pending,r=>{}).addCase(gt.fulfilled,(r,s)=>{}).addCase(gt.rejected,r=>{})}}),Vi=Xi.reducer,Zi=Nn({reducer:{suppliers:ri,ingredients:di,products:Br,dashboard:Vi,mixes:mi,categories:yi,employees:Si,employeeHours:Ur,settings:fa}});Ks.createRoot(document.getElementById("root")).render(e.jsx(Pt.StrictMode,{children:e.jsx(en,{store:Zi,children:e.jsx(Wn,{children:e.jsx(Gi,{})})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(t=>{console.error("ServiceWorker registration failed: ",t)})});
