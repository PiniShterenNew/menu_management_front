import{r as c,j as e,a as ut}from"./react-BoqISt01.js";import{c as ls}from"./react-dom-Bk743r0W.js";import{u as V,a as Le,P as os}from"./react-redux-D3oi59tp.js";import{a as G}from"./axios-CCb-kr4I.js";import{s as M,L as ie,C as ae,R as L,F as D,D as Z,B as _,a as Nt,T as Ye,P as ds,d as cs,M as me,b as Y,c as $,S as oe,e as ue,f as Q,g as yt,h as ve,i as Be,I as de,j as ft,k as at,l as At,m as us,n as xs,o as xt,p as vt,q as ps,r as hs,A as ms,t as it,u as _e,v as De,w as Ue,x as gs,y as js,z as lt,E as ys,G as qt}from"./antd-DwdNwjZo.js";import{u as Ee}from"./react-responsive-B9DcSnuZ.js";import{L as fs}from"./rc-virtual-list-D8xMsbcw.js";import{F as O,f as $e,a as Me,b as Lt,c as Pe,d as Te,e as vs,g as ws,h as Ss,i as Cs,j as pt,k as qe,l as ht,m as bs,n as We,o as Qe,p as Je,q as tt,r as Is,s as ks,t as _s}from"./@fortawesome-IIZJM3_1.js";import{a2 as ot,A as Rt,a3 as Ht,a4 as Ps,a5 as Fe,R as mt,a1 as gt,v as jt,r as Ts,s as Fs,x as Es,a6 as $s}from"./@ant-design-kJ9GwZIM.js";import{c as Ot,a as Se,b as Ms}from"./@reduxjs-DkgbS889.js";import{m as we,h as wt}from"./moment-BAfwh5x7.js";import{D as Ns,B as St}from"./react-chartjs-2-0Z_sSmBf.js";import{C as As,A as qs,p as Ls,a as Rs,b as Hs,L as Os,c as Us}from"./chart.js-BkMDj0WH.js";import{L as xe,B as Bs}from"./react-router-dom-UU0TJEQ6.js";import{l as Ds}from"./socket.io-client-CDVIIGn8.js";import{d as Ws,e as ke,b as Qs}from"./react-router-CBguhhk8.js";import"./@babel-D3CJPhrF.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-BQxMxw6g.js";import"./rc-util-CNJZKBfo.js";import"./classnames-CAxFPVRb.js";import"./rc-resize-observer-DAFDewDD.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-DZL9tseL.js";import"./@rc-component-BW4t2GTl.js";import"./rc-overflow-BihHMfjR.js";import"./rc-picker-qwdiTNu7.js";import"./dayjs-DMN7meC7.js";import"./rc-tabs-DZ4yMar1.js";import"./rc-dropdown-DZ_uPejK.js";import"./rc-menu-CBizRVkK.js";import"./rc-select-DZlYG8G7.js";import"./rc-segmented-DWUgWqHo.js";import"./rc-input-number-BMQLEHaT.js";import"./rc-input-DGbryaDy.js";import"./@ctrl-DOFZgDuz.js";import"./rc-slider-CsKwHlrC.js";import"./rc-drawer-GkGOMuj8.js";import"./rc-field-form-Coa8WZdR.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-image-lgewo_SJ.js";import"./rc-dialog-BbpJe7PZ.js";import"./rc-notification-m3oA-fH0.js";import"./rc-tooltip-CNaoW7KG.js";import"./rc-steps-jTTkhuna.js";import"./rc-progress-BECVEO62.js";import"./rc-switch-B_QRjvBh.js";import"./rc-table-CFeDePSE.js";import"./rc-tree-BDK0sBoh.js";import"./rc-checkbox-XvbJzSrO.js";import"./rc-pagination-CZPuIcur.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-textarea-BF1YsysJ.js";import"./copy-to-clipboard-DN2oU9Yq.js";import"./toggle-selection-BHUZwh74.js";import"./matchmediaquery-9DU1HNkU.js";import"./css-mediaquery-DcYbJrVh.js";import"./hyphenate-style-name-HOLnhz8K.js";import"./shallow-equal-BQUY1Bas.js";import"./prop-types-Bq5K3Feg.js";import"./@emotion-CW87jbl0.js";import"./stylis-OW4gUFyn.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./@kurkle-BZxJdD1U.js";import"./@remix-run-Br25Cn4W.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const x of u.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function s(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerPolicy&&(u.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?u.credentials="include":n.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(n){if(n.ep)return;n.ep=!0;const u=s(n);fetch(n.href,u)}})();const ge="https://menu-server-c2b952e2c698.herokuapp.com/api",Ys=t=>G.post(`${ge}/products`,t),Js=t=>{const r=encodeURIComponent(t._id);return G.put(`${ge}/products/${r}`,t)},zs=t=>G.delete(`${ge}/products/${t}`),Gs=()=>G.get(`${ge}/products`),Xs=t=>G.get(`${ge}/products/${t}`),Zs=(t,r)=>G.post(`${ge}/sizes/${t}`,r),Vs=(t,r)=>G.put(`${ge}/sizes/${t}`,r),Ks=(t,r)=>G.delete(`${ge}/sizes/${t}/${r}`),en=t=>G.post(`${ge}/variations`,t),tn=(t,r)=>G.put(`${ge}/variations/${t}`,r),sn=t=>G.delete(`${ge}/variations/${t}`),Ut=c.createContext(),Bt=()=>c.useContext(Ut),nn=({children:t})=>{const[r,s]=c.useState(!1),[l,n]=c.useState(!1),[u,x]=c.useState("add"),[o,h]=c.useState(null),[g,S]=c.useState(null),f=j=>new Promise(async(w,d)=>{var m;try{const b=await Xs(j);(m=b==null?void 0:b.data)!=null&&m.error?d(!1):w(b==null?void 0:b.data)}catch(b){console.error("Error get product:",b)}}),U=j=>new Promise(async(w,d)=>{var m,b;s(!0);try{const C=await Ys(j);s(!1),(m=C==null?void 0:C.data)!=null&&m.error?(M.error((b=C==null?void 0:C.data)==null?void 0:b.error),d(!1)):(M.success("המוצר נוסף בהצלחה"),w(!0))}catch(C){console.error("Error adding product:",C),M.error("שגיאה בהוספת המוצר"),s(!1)}}),v=j=>new Promise(async(w,d)=>{var m;s(!0);try{const b=await Js(j);s(!1),(m=b==null?void 0:b.data)!=null&&m.error||(M.success("המוצר עודכן בהצלחה"),w(!0)),d(!1)}catch(b){console.error("Error updating product:",b),M.error("שגיאה בעדכון המוצר"),s(!1)}}),P=async j=>{s(!0);try{await zs(j),M.success("המוצר נמחק בהצלחה"),s(!1)}catch(w){console.error("Error deleting product:",w),M.error("שגיאה במחיקת המוצר"),s(!1)}},T=(j,w)=>(s(!0),new Promise(async(d,m)=>{try{const b=await Zs(j,w);M.success("הגודל נוסף בהצלחה"),s(!1),d(b.data)}catch(b){console.error("Error adding size:",b),M.error("שגיאה בהוספת הגודל"),s(!1),m(b)}})),H=(j,w)=>(s(!0),new Promise(async(d,m)=>{try{const b=await Vs(j,w);M.success("הגודל עודכן בהצלחה"),s(!1),d(b.data)}catch(b){console.error("Error updating size:",b),M.error("שגיאה בעדכון הגודל"),s(!1),m(b)}})),y=(j,w)=>(s(!0),new Promise(async(d,m)=>{try{await Ks(j,w),M.success("הגודל נמחק בהצלחה"),s(!1),d(!0)}catch(b){console.error("Error deleting size:",b),M.error("שגיאה במחיקת הגודל"),s(!1),m(b)}})),I=j=>(s(!0),new Promise(async(w,d)=>{try{const m=await en(j);M.success("הווריאציה נוספה בהצלחה"),s(!1),w(m.data)}catch(m){console.error("Error adding variation:",m),M.error("שגיאה בהוספת הווריאציה"),s(!1),d(m)}})),i=(j,w)=>(s(!0),new Promise(async(d,m)=>{try{const b=await tn(j,w);M.success("הווריאציה עודכנה בהצלחה"),s(!1),d(b.data)}catch(b){console.error("Error updating variation:",b),M.error("שגיאה בעדכון הווריאציה"),s(!1),m(b)}})),a=j=>(s(!0),new Promise(async(w,d)=>{try{await sn(j),M.success("הווריאציה נמחקה בהצלחה"),s(!1),w(!0)}catch(m){console.error("Error deleting variation:",m),M.error("שגיאה במחיקת הווריאציה"),s(!1),d(m)}}));return e.jsx(Ut.Provider,{value:{getProductById:f,addProduct:U,updateProduct:v,deleteProduct:P,addSize:T,updateSize:H,deleteSize:y,addVariation:I,updateVariation:i,deleteVariation:a,loading:r,isModalVisible:l,setIsModalVisible:n,modalMode:u,setModalMode:x,selectedItem:o,setSelectedItem:h,selectedUpdateSize:g,setSelectedUpdateSize:S},children:t})};function rn({data:t,type:r,tableKeys:s,mobileKeys:l,openModal:n,Dtitle:u,Dcontent:x,onDelete:o}){const h=Ee({query:"(max-width: 500px)"}),[g,S]=c.useState(0),[f,U]=c.useState(1),[v,P]=c.useState(6),[T,H]=c.useState([]),y=(a,j)=>{const w=(a-1)*j,d=w+j;return t.slice(w,d)},I=(a,j)=>{U(a),P(j)};c.useEffect(()=>{S(t.length),H(y(f,v))},[f,v,t]);const i=a=>{me.confirm({title:u,content:x,okText:"מחק",cancelText:"בטל",onOk:()=>o(a==null?void 0:a._id)})};return h?e.jsx(e.Fragment,{children:e.jsx(ie,{style:{maxHeight:"55vh",overflowY:"auto",minHeight:"80%",height:"80%"},children:e.jsx(fs,{data:t,itemHeight:47,itemKey:"_id",children:a=>{var j,w,d;return e.jsx(ie.Item,{className:"width-100",style:{padding:"0"},children:e.jsxs(ae,{className:"width-100 padding-card",style:{margin:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(D,{flex:1,children:e.jsx("strong",{style:{fontSize:"1.3em"},children:a==null?void 0:a.name})}),e.jsxs(D,{flex:1,style:{flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("strong",{children:(j=s==null?void 0:s.find(m=>m.key==="usedCount"))==null?void 0:j.title}),e.jsx("p",{children:a==null?void 0:a.usedCount})]}),(w=s==null?void 0:s.find(m=>m.key==="type"||m.key==="category"))==null?void 0:w.render("",a,"view")]}),s.filter(m=>m.key!=="name"&&m.key!=="type"&&(m==null?void 0:m.key)!=="category"&&(m==null?void 0:m.key)!=="actions"&&(l==null?void 0:l.includes(m==null?void 0:m.key))).map((m,b,C)=>e.jsxs(ut.Fragment,{children:[e.jsxs("div",{style:{fontSize:"0.9em",display:"flex",justifyContent:"space-between"},children:[m.title&&e.jsxs("strong",{children:[m.title,":"]}),e.jsx("span",{children:m.render?m.render(null,a,"view"):a[m.dataIndex]||"—"})]}),b<2&&e.jsx(Z,{style:{margin:"0.2em"}})]},`${a==null?void 0:a._id}-${m.key}`)),e.jsxs(L,{className:"card-actions",align:"middle",justify:"center",children:[(d=s==null?void 0:s.find(m=>m.key==="actions"))==null?void 0:d.render(null,a),r==="P"&&e.jsx(Z,{type:"vertical"}),e.jsxs(D,{align:"center",justify:"center",children:[e.jsx(_,{type:"text",onClick:()=>i(a),children:e.jsx(O,{icon:$e})}),e.jsx(_,{type:"text",onClick:()=>n("edit",a),children:e.jsx(O,{icon:Me})}),e.jsx(_,{type:"text",onClick:()=>n("view",a),children:e.jsx(O,{icon:Lt})})]})]})]})},a==null?void 0:a._id)}})})}):e.jsxs(D,{flex:1,style:{display:"flex",flexDirection:"column",overflow:"hidden",width:"100%"},children:[e.jsx(D,{flex:1,style:{maxWidth:"100%",maxHeight:"90%",overflowY:"auto",overflowX:"auto"},children:e.jsx(Nt,{style:{minWidth:"100%"},columns:s.map(a=>({...a,title:e.jsx(Ye,{title:a.title,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:a.title})})})),dataSource:T,pagination:!1,direction:"rtl"})}),e.jsx(D,{align:"center",justify:"center",style:{marginTop:"2vh"},children:e.jsx(ds,{current:f,total:g,pageSize:v,onChange:I,style:{direction:"ltr"},showSizeChanger:!0,pageSizeOptions:["6","10","20","50"],locale:cs})})]})}const{Text:Ct}=Q,an=({value:t=[],onChange:r,ingredientsArr:s=[],fields:l,add:n,remove:u,form:x})=>{var m,b;const[o,h]=c.useState(null),[g,S]=c.useState(!1);c.useState(null),c.useState(null);const[f,U]=c.useState(""),v=c.useRef(null),P=c.useCallback(()=>{setTimeout(()=>{v.current&&v.current.scroll({top:v.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(m=v.current)==null?void 0:m.scrollHeight]),T=(C,A)=>{const q=[...x.getFieldValue("ingredients")||[]];q[o]={...q[o],ingredientId:C,unit:A.unit,name:A.label},U(A.unit)},H=C=>{const W=[...x.getFieldValue("ingredients")||[]];W[o]={...W[o],quantity:C}},y=()=>{const A=d()[o];if(!A||!A.ingredientId||!A.quantity)return;const W=s.find(F=>F._id===A.ingredientId),q={...A,name:(W==null?void 0:W.name)||"---",unit:(W==null?void 0:W.unit)||A.unit},N=[...t,q];r(N),h(null),S(!1)},I=C=>{const A=t.filter((W,q)=>q!==C);r(A),h(null)},i=()=>{g&&I(o),h(null),S(!1)},a=()=>h(null),j=(C,A,W)=>{const q=[...t];if(q[C][A]=W,A==="ingredientId"){const N=s.find(F=>F._id===W);N&&(q[C].unit=N.unit,q[C].name=N.name)}r(q)},w=C=>{switch(C){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}},d=()=>{const C=x==null?void 0:x.getFieldValue("ingredients");return Array.isArray(C)?C:[]};return c.useEffect(()=>{d().length>0&&P()},[(b=x==null?void 0:x.getFieldValue("ingredients"))==null?void 0:b.length]),e.jsxs(e.Fragment,{children:[g?e.jsxs(L,{gutter:16,style:{marginBottom:"1vw"},children:[e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[o,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(oe,{placeholder:"בחר רכיב",filterOption:(C,A)=>{var W;return(W=A==null?void 0:A.label)==null?void 0:W.toLowerCase().includes(C.toLowerCase())},showSearch:!0,options:s==null?void 0:s.map(C=>({value:C._id,label:C.name,unit:C.unit})),onChange:T})})}),e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[o,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(ue,{onChange:H,addonAfter:w(f),placeholder:"כמות"})})}),e.jsxs(Y,{span:4,children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:y}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:i})]})]}):e.jsx(_,{type:"dashed",onClick:()=>{h(t.length),S(!0)},disabled:o!==null,style:{marginBottom:"8px"},children:"הוסף מרכיב"}),e.jsx(ae,{ref:v,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ie,{dataSource:t,renderItem:(C,A)=>{var F;const W=o===A,q=s.find(z=>z._id===C.ingredientId),N=w(C.unit||(q==null?void 0:q.unit));return e.jsx(ie.Item,{children:W&&!g?e.jsxs(e.Fragment,{children:[e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[A,"ingredientId"],children:e.jsx(oe,{placeholder:"בחר רכיב",value:C.ingredientId||null,onChange:z=>j(A,"ingredientId",z),options:s.map(z=>({value:z._id,label:z.name})),showSearch:!0})})}),e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[A,"quantity"],children:e.jsx(ue,{placeholder:"כמות",onChange:z=>j(A,"quantity",z),min:0,addonAfter:N,style:{width:"100%"}})})}),e.jsxs(Y,{children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:a}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:i})]})]}):e.jsxs(L,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(D,{flex:1,children:e.jsx(Ct,{children:(C==null?void 0:C.name)||((F=C==null?void 0:C.ingredientData)==null?void 0:F.name)||"---"})}),e.jsx(D,{flex:1,children:e.jsxs(Ct,{children:[C.quantity," ",N]})}),e.jsxs(L,{children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Me}),onClick:()=>h(A)}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:$e}),onClick:()=>I(A)})]})]})},A)}})})]})},Ce=[{color:"magenta",value:"פירות טריים"},{color:"aquamarine",value:"פירות קפואים"},{color:"orange",value:"תמציות, ממרחים ותוספות"},{color:"gold",value:"אבקות"},{color:"lime",value:"גלידות וסורבה"},{color:"green",value:"מאפים ועוגיות"},{color:"cyan",value:"אריזות וחד פעמי"},{color:"blue",value:"מוצרי חלב"},{color:"purple",value:"חומרי ניקוי"},{color:"teal",value:"נוזלים"}],fe=[{value:"weight",label:"משקל",display:t=>t>=1?'ק"ג':"גרם"},{value:"volume",label:"נפח",display:t=>t>=1?"ליטר":'מ"ל'},{value:"units",label:"יחידות",display:t=>t>1?"יחידות":"יחידה"}],{Option:Ae}=oe,{Text:pe}=Q,{TextArea:ln}=de;function on({mode:t="view",type:r,fields:s=[],onSubmit:l,initialValues:n={},onClose:u,groups:x,tableKeys:o,ingredientsArr:h}){var q,N,F,z,ne,se,le,k,E;const[g]=$.useForm(),[S]=$.useForm(),[f]=$.useForm(),U=V(p=>{var B,J;return(J=(B=p.settings.settings)==null?void 0:B.hourlyRate)==null?void 0:J.value}),[v,P]=c.useState(0),[T,H]=c.useState(["process","wait"]),[y,I]=c.useState({}),[i,a]=c.useState(n),[j,w]=c.useState(n.unit||null),[d,m]=c.useState(n.subUnit||null),b=p=>{console.log("onChange:",p),P(p)},C=async p=>{let B=p.quantity;u&&u(),(p.subUnit==="g"||p.subUnit==="ml")&&(B=p.quantity/1e3);const J={...n,...y,...p,quantity:B};l&&await l(J),await S.resetFields(),await f.resetFields()};c.useEffect(()=>{if(n){const p=n.quantity<1?n.quantity*1e3:n.quantity;g.setFieldsValue({...n,quantity:p}),w(n.unit),m(n.subUnit||"kg")}},[n,g]);const A=(p,B)=>p.map(J=>{const{key:te,title:he,type:be,options:Ne,rules:je,props:Ie,hiddenInForm:R,coin:ee,divider:K}=J;if(R)return null;switch(be){case"text":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:te,label:he,rules:je,validateTrigger:"onSubmit",children:e.jsx(de,{...Ie})},te),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"number":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:te,label:he,rules:je==null?void 0:je.map(X=>X.validator?{...X,validator:(re,ce)=>X.validator(re,ce,n)}:X),validateTrigger:"onSubmit",children:e.jsx(ue,{suffix:ee&&"₪",min:0,style:{width:"100%"},...Ie})},te),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"float":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:te,label:he,rules:je,validateTrigger:"onSubmit",children:e.jsx(ue,{suffix:ee&&"₪",min:0,step:.01,style:{width:"100%"},...Ie})},te),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"select":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:te,label:he,rules:je,validateTrigger:"onSubmit",children:e.jsx(oe,{...Ie,showSearch:!0,onChange:X=>{te==="unit"&&(w(X),a(re=>({...re,unit:X,subUnit:void 0})),B.setFieldsValue({subUnit:void 0}))},children:Ne.map(X=>e.jsx(Ae,{value:X.value,children:X.label},X.value))})},te),e.jsx($.Item,{noStyle:!0,shouldUpdate:(X,re)=>X.unit!==re.unit,children:()=>{const X=i==null?void 0:i.unit,re=i==null?void 0:i.subUnit;return te==="unit"&&(X==="weight"||X==="volume")?e.jsx($.Item,{name:"subUnit",initialValue:re||(X==="weight"?(i==null?void 0:i.quantity)>=1?"kg":"g":(i==null?void 0:i.quantity)>=1?"liter":"ml"),validateTrigger:"onSubmit",label:X==="weight"?'בחר יחידת משקל (ק"ג / גרם)':'בחר יחידת נפח (ליטר / מ"ל)',rules:[{required:!0,message:"אנא בחר יחידת משנה"}],children:e.jsx(oe,{onChange:ce=>a(et=>({...et,subUnit:ce})),children:X==="weight"?e.jsxs(e.Fragment,{children:[e.jsx(Ae,{value:"kg",children:'ק"ג'}),e.jsx(Ae,{value:"g",children:"גרם"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{value:"liter",children:"ליטר"}),e.jsx(Ae,{value:"ml",children:'מ"ל'})]})})}):null}}),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"ingredientsManager":return e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"0.5em"}}),e.jsx($.List,{name:te,label:he,rules:je,validateTrigger:"onSubmit",children:(X,{add:re,remove:ce})=>e.jsx(an,{fields:X,add:re,form:B,remove:ce,value:B.getFieldValue(te),onChange:et=>B.setFieldsValue({[te]:et}),ingredientsArr:h})},te)]});case"price":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:"withVATFlag",initialValue:!0,valuePropName:"checked",validateTrigger:"onSubmit",children:e.jsx(Be,{onChange:()=>{a(X=>({...X,price:void 0,priceExcludingVAT:void 0}))},children:'עלות כולל מע"מ'})},"withVATFlag"),e.jsx($.Item,{noStyle:!0,validateTrigger:"onSubmit",shouldUpdate:(X,re)=>X.withVATFlag!==re.withVATFlag,children:({getFieldValue:X})=>X("withVATFlag")?e.jsx($.Item,{name:"price",label:'עלות (כולל מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(ue,{addonAfter:"₪",onChange:re=>{a(ce=>({...ce,priceExcludingVAT:void 0,price:re}))},style:{width:"100%"}})},"price"):e.jsx($.Item,{name:"priceExcludingVAT",label:'עלות (ללא מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(ue,{style:{width:"100%"},addonAfter:"₪",onChange:re=>{a(ce=>({...ce,price:void 0,priceExcludingVAT:re}))}})},"priceExcludingVAT")})]});case"custom":return e.jsxs(e.Fragment,{children:[J.render&&J.render("",n,"edit",B),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"textArea":return e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:te,label:he,rules:je,validateTrigger:"onSubmit",children:e.jsx(ln,{style:{resize:"none"},showCount:!0,maxLength:J==null?void 0:J.maxLength})},te),K&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});default:return null}});if(t==="view")switch(r){case"mix":return e.jsxs("div",{children:[e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(pe,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(q=o==null?void 0:o.find(p=>p.key==="type"))==null?void 0:q.render("",n,"view")}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(N=o==null?void 0:o.find(p=>p.key==="is_active"))==null?void 0:N.render("",n,"view")}),e.jsxs(L,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(ot,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",n==null?void 0:n.totalCost]})]}),e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(Rt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.preparationTime," דקות"]})]})]}),e.jsxs(ae,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs("div",{style:{margin:"12px 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:["עלות עבודה (₪)",":"]})}),e.jsx(D,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.laborCost," (₪",U,")"]})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:["עלות ל-100 גרם (₪)",":"]})}),e.jsx(D,{children:e.jsx("p",{style:{},children:(F=o==null?void 0:o.find(p=>p.key==="unitCost"))==null?void 0:F.render("",n,"view")})})]})]}),e.jsxs(ae,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:[e.jsx(pe,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0",maxHeight:"5vw",overflow:"auto"},children:(z=n==null?void 0:n.ingredients)==null?void 0:z.map((p,B)=>{var te;const J=(()=>{switch(p==null?void 0:p.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(pe,{children:[(te=h==null?void 0:h.find(he=>(he==null?void 0:he._id)===(p==null?void 0:p.ingredientId)))==null?void 0:te.name," -"," ",p.quantity," ",J," - ₪",p==null?void 0:p.costForQuantity]})},B)})})]})]});case"ingredient":return e.jsxs("div",{children:[e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(pe,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(ne=o==null?void 0:o.find(p=>p.key==="type"))==null?void 0:ne.render("",n,"view")}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(Q.Text,{strong:!0,children:n==null?void 0:n.SKU})}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(se=o==null?void 0:o.find(p=>p.key==="is_active"))==null?void 0:se.render("",n,"view")}),e.jsx(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(le=o==null?void 0:o.find(p=>p.key==="supplierId"))==null?void 0:le.render("",n,"view")}),e.jsxs(L,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(ot,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y,{children:[e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.priceExcludingVAT,' (ללא מע"מ)']}),e.jsxs(Q.Text,{style:{fontSize:"1em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.price,' (כולל מע"מ)']})]})]}),e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(O,{icon:vs}),e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.quantity," ",fe.find(p=>p.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)]})]})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:["כמות מינימלית",":"]})}),e.jsx(D,{children:e.jsxs("p",{style:{},children:[n==null?void 0:n.unitQuantity," ",fe.find(p=>p.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)," - ₪",n==null?void 0:n.unitPrice]})})]}),(n==null?void 0:n.juiceRatio)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:["יחס עיבוד",":"]})}),e.jsx(D,{children:e.jsx("p",{style:{},children:(k=o==null?void 0:o.find(p=>p.key==="juiceRatio"))==null?void 0:k.render("",n,"view")})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:["מחיר ליחידה מעובדת",":"]})}),e.jsx(D,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.processedPrice]})})]})]}),(n==null?void 0:n.notes)&&e.jsx(ae,{type:"inner",style:{backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:e.jsxs(Y,{children:[e.jsx(L,{style:{marginBottom:"4px"},children:e.jsxs(pe,{strong:!0,style:{fontSize:"1.2em",color:"#333"},children:["הערות",":"]})}),e.jsx(Q.Text,{style:{fontSize:"1em",color:"#555"},children:n==null?void 0:n.notes})]})})]});default:return e.jsxs("div",{style:{},children:[e.jsxs(L,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(pe,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name}),(E=o==null?void 0:o.find(p=>p.key==="type"))==null?void 0:E.render("",n,"view")]}),o==null?void 0:o.filter(p=>p.key!=="type"&&(p==null?void 0:p.key)!=="name"&&!p.column).map((p,B,J)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(pe,{strong:!0,children:[p.title,":"]})}),e.jsx(D,{flex:1,children:e.jsx("p",{style:{},children:(p==null?void 0:p.render)&&(p==null?void 0:p.render("",n,t,"view"))||n[p.key]||"—"})})]},p.key),B<(J==null?void 0:J.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]})),o==null?void 0:o.filter(p=>p.column).map((p,B,J)=>e.jsxs(e.Fragment,{children:[B===0&&e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[e.jsxs(pe,{strong:!0,style:{fontSize:"1.4em"},children:[p.title,":"]}),e.jsx(D,{flex:1,children:e.jsx("p",{style:{},children:(p==null?void 0:p.render)&&(p==null?void 0:p.render("",n,t,"view"))||n[p.key]||"—"})})]},p.key),B<(J==null?void 0:J.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]}))]})}const W=[{title:"מידע",icon:e.jsx(Ht,{}),content:e.jsxs($,{form:S,layout:"vertical",onValuesChange:(p,B)=>{a(J=>({...J,...p}))},onFinish:async p=>{await S.validateFields(),a({...i,...p}),P(v+1)},initialValues:n,children:[A(s==null?void 0:s.filter(p=>p.group===1),S),x&&!(n!=null&&n._id)&&e.jsx(_,{type:"primary",htmlType:"submit",children:"הבא"}),t!=="add"&&e.jsx(_,{type:"primary",onClick:()=>C(i),children:"עדכן"})]})},{title:"עלויות",icon:e.jsx(Ps,{}),content:e.jsxs($,{layout:"vertical",form:f,onValuesChange:(p,B)=>{a(J=>({...J,...p}))},onFinish:p=>{const B={...i,...p};a(B),l&&l(B)},initialValues:n,children:[A(s==null?void 0:s.filter(p=>p.group===2),f),x&&!(n!=null&&n._id)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"24px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[v>0&&e.jsx(_,{onClick:()=>P(v-1),children:"הקודם"}),e.jsx(_,{type:"primary",htmlType:"submit",children:t!=="add"?"עדכן":"סיום"})]})]}),t!=="add"&&e.jsx(_,{type:"primary",onClick:()=>{console.log(f==null?void 0:f.getFieldsValue()),C(i)},children:"עדכן"})]})}];return e.jsxs(e.Fragment,{children:[x&&!(n!=null&&n._id)&&e.jsx(D,{wrap:"wrap",justify:"space-between",align:"center",style:{gap:"8px"},children:e.jsx(yt,{current:v,onChange:b,status:T[v],style:{width:"100%"},children:W==null?void 0:W.map((p,B)=>e.jsx(yt.Step,{title:p.title,icon:p.icon},B))})}),x&&(n==null?void 0:n._id)&&e.jsx(D,{flex:1,wrap:"wrap",justify:"center",align:"center",style:{gap:"8px"},children:e.jsx(ve,{current:v,onChange:b,status:T[v],style:{width:"100%"},children:W==null?void 0:W.map((p,B)=>e.jsx(ve.TabPane,{tab:p.title,icon:p.icon},B))})}),x&&W[v].content,!x&&e.jsxs($,{form:g,layout:"vertical",onFinish:C,onValuesChange:p=>{console.log(p)},initialValues:n,children:[!x&&A(s,g),t!=="view"&&(!x||x&&(n==null?void 0:n._id))&&e.jsx($.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"1vw"},children:t==="add"?"הוסף":"עדכן"})})]})]})}const{Search:dn}=de;function ze({title:t,titleView:r,dataPrint:s,data:l,groups:n,tableKeys:u,newTitle:x,setDataPrint:o,searchKeys:h,sortKeys:g,mobileKeys:S,Dtitle:f,Dcontent:U,onAdd:v,onEdit:P,onDelete:T,width:H,ingredientsArr:y,iconADD:I,floatAction:i,type:a,openModalProduct:j,filters:w,saveFilters:d,filtersArr:m}){const[b,C]=c.useState([]),[A,W]=c.useState(!1),[q,N]=c.useState(!1),[F,z]=c.useState("add"),[ne,se]=c.useState(null),[le,k]=c.useState(!1),[E,p]=c.useState(w),B=Ee({query:"(max-width: 500px)"}),J=g.map(R=>({key:R==null?void 0:R.key,label:e.jsx("span",{className:"width-100",onClick:()=>{const ee=[...s].sort((K,X)=>{const re=K[R==null?void 0:R.key],ce=X[R==null?void 0:R.key];return typeof re=="number"&&typeof ce=="number"?ce-re:re==null?void 0:re.toString().localeCompare(ce==null?void 0:ce.toString())});o(ee)},children:R==null?void 0:R.title})})),te=R=>{if(R==="all")C(u);else{let ee=b.findIndex(X=>X.key===R),K=[...b];ee!==-1?K=K.filter(X=>X.key!==R):K=[...K,u.find(X=>X.key===R)],C(K)}},he=[{key:"all",label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:b.length===u.length,disabled:b.length===u.length,onChange:()=>te("all"),onClick:R=>R.stopPropagation(),children:"הכל"})},...u.filter(R=>!(R!=null&&R.required)).map(({title:R,dataIndex:ee})=>({key:ee,label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:b.some(K=>K.key===ee),disabled:b.length<=3&&b.some(K=>K.key===ee),onChange:()=>te(ee),onClick:K=>K.stopPropagation(),children:R})}))],be=(R,ee=null)=>{if(a==="P")return j(R,ee);z(R),se(ee),N(!0)},Ne=()=>{N(!1),se(null)},je=R=>{me.confirm({title:f,content:U,okText:"מחק",cancelText:"בטל",onOk:()=>T(R==null?void 0:R._id)})},Ie=()=>{let R=[...l];m.forEach(ee=>{const K=w[ee.value];K&&K.length>0&&(R=R.filter(X=>ee.filterFunction(X,K)))}),o(R)};return c.useEffect(()=>{w&&(Ie(),p(w))},[w]),c.useEffect(()=>{C(u)},[u]),e.jsxs(D,{flex:1,vertical:!0,style:{maxWidth:"100%"},gap:"1em",className:"container",children:[B&&e.jsx(L,{justify:"center",children:e.jsxs(Q.Title,{level:3,style:{margin:"0"},children:[I," ",t]})}),e.jsxs(L,{align:"middle",style:{flexFlow:""},justify:"space-between",children:[!B&&e.jsx(L,{align:"",children:e.jsxs(Q.Title,{level:3,style:{margin:"0"},children:[I," ",t]})}),e.jsx(L,{style:{},children:e.jsx(dn,{placeholder:"חיפוש ...",allowClear:!0,onChange:({target:R})=>{o(l==null?void 0:l.filter(ee=>h.some(K=>{var X,re,ce;return(ce=(re=(X=ee[K])==null?void 0:X.toString())==null?void 0:re.toLowerCase())==null?void 0:ce.includes(R.value.toLowerCase())})))},style:{width:200}})}),e.jsxs(L,{style:{gap:"0.5em"},children:[!B&&e.jsx(e.Fragment,{children:e.jsx(ft,{menu:{items:he},trigger:["click"],open:A,onOpenChange:R=>W(R),children:e.jsxs(_,{children:[e.jsx(O,{icon:ws,style:{marginLeft:"8px"}}),B?e.jsx(e.Fragment,{children:`${b.length} / ${u.length}`}):e.jsx(e.Fragment,{children:`בחרת ${b.length} מתוך ${u.length}`})]})})}),e.jsx(ft,{menu:{items:J},trigger:["click"],children:e.jsxs(_,{type:B?"link":"default",children:[e.jsx(O,{icon:Ss,style:{marginLeft:"8px"}}),"מיון"]})}),!B&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{type:"vertical",style:{height:"auto"}}),e.jsx(L,{style:{},children:e.jsx(_,{onClick:()=>be("add"),type:"primary",children:x})})]})]})]}),e.jsxs(at.Group,{trigger:"click",type:"primary",icon:e.jsx(O,{icon:Cs}),children:[e.jsx(at,{type:"primary",onClick:()=>be("add"),icon:I}),i==null?void 0:i.map((R,ee)=>e.jsx(ut.Fragment,{children:R},`float-action-${ee}`))]}),e.jsx(rn,{data:s,tableKeys:[{title:"פעולות",key:"action",minWidth:130,maxWidth:130,render:(R,ee)=>e.jsxs(L,{className:"card-actions",align:"middle",justify:"center",style:{maxWidth:130},children:[e.jsx(_,{type:"text",onClick:()=>je(ee),children:e.jsx(O,{icon:$e})}),e.jsx(_,{type:"text",onClick:()=>be("edit",ee),children:e.jsx(O,{icon:Me})}),e.jsx(_,{type:"text",onClick:()=>be("view",ee),children:e.jsx(O,{icon:Lt})})]})},...b],openModal:be,mobileKeys:S,type:a,Dtitle:f,Dcontent:U,onDelete:T}),le&&e.jsxs(At,{title:e.jsx(Q.Title,{level:4,children:"סינון נתונים"}),placement:"right",onClose:()=>k(!1),open:le,width:360,children:[m.map(R=>e.jsx(L,{gutter:[16,16],style:{marginBottom:"1em"},children:e.jsxs(Y,{span:24,children:[e.jsx(Q.Text,{strong:!0,children:R.name}),R.type==="select"&&e.jsx(oe,{mode:"multiple",allowClear:!0,placeholder:`בחר ${R.name}`,options:R.options,value:E[R.value]||[],onChange:ee=>p(K=>({...K,[R.value]:ee})),style:{width:"100%"}}),R.type==="radio"&&e.jsx(us.Group,{options:R.options,value:E[R.value],onChange:ee=>p(K=>({...K,[R.value]:[ee.target.value]})),optionType:"button",buttonStyle:"solid"}),R.type==="range"&&e.jsx(xs,{range:!0,defaultValue:[0,100],onChange:ee=>p(K=>({...K,[R.value]:ee}))})]})},R.value)),e.jsxs(L,{justify:"space-between",children:[e.jsx(_,{onClick:()=>p({}),children:"נקה הכל"}),e.jsx(_,{type:"primary",onClick:()=>{k(!1),d(E),Ie()},children:"החל סינון"})]})]}),e.jsx(me,{style:{top:B?"3em":""},title:F==="add"?`הוסף ${r} חדש`:F==="edit"?`ערוך ${r}`:`צפייה ב${r}`,open:q,onCancel:Ne,footer:null,destroyOnClose:!0,width:B?"100%":H||600,children:a!=="P"&&e.jsx(on,{mode:F,groups:n,type:a,tableKeys:b,ingredientsArr:y,fields:u.filter(R=>R.editable||F==="view"),onSubmit:R=>{F==="add"&&v(R),F==="edit"&&P({...ne,...R}),Ne()},initialValues:ne||{},onClose:Ne})})]})}const Ge="https://menu-server-c2b952e2c698.herokuapp.com/api",cn=t=>G.post(`${Ge}/categories`,t),un=t=>{const r=encodeURIComponent(t._id);return G.put(`${Ge}/categories/${r}`,t)},xn=t=>G.delete(`${Ge}/categories/${t}`),pn=()=>G.get(`${Ge}/categories`),Dt=c.createContext(),hn=()=>c.useContext(Dt),mn=({children:t})=>{const[r,s]=c.useState(!1),l=async x=>{s(!0);try{await cn(x),M.success("הקטגוריה נוספה בהצלחה"),s(!1)}catch(o){console.error("Error adding category:",o),M.error("שגיאה בהוספת הקטגוריה"),s(!1)}},n=async x=>{s(!0);try{await un(x),M.success("הקטגוריה עודכנה בהצלחה"),s(!1)}catch(o){console.error("Error updating category:",o),M.error("שגיאה בעדכון הקטגוריה"),s(!1)}},u=async x=>{s(!0);try{await xn(x),M.success("הקטגוריה נמחקה בהצלחה"),s(!1)}catch(o){console.error("Error deleting category:",o),M.error("שגיאה במחיקת הקטגוריה"),s(!1)}};return e.jsx(Dt.Provider,{value:{addCategory:l,updateCategory:n,deleteCategory:u,loading:r},children:t})},{Title:bt,Text:gn}=Q,jn=({isCategoryModalVisible:t,setIsCategoryModalVisible:r})=>{const{addCategory:s,updateCategory:l,deleteCategory:n}=hn(),u=V(y=>y.categories),[x,o]=c.useState(""),[h,g]=c.useState(null),[S,f]=c.useState(""),U=()=>{if(x.trim()===""){f("אנא הזן שם קטגוריה תקין");return}if(u.some(y=>y.name===x.trim()&&y!==h)){f("קטגוריה זו כבר קיימת");return}h?l({...h,name:x.trim()}):s({name:x.trim()}),o(""),g(null),f("")},v=y=>{g(y),o(y.name)},P=()=>{if(x.trim()===""){f("אנא הזן שם קטגוריה תקין");return}l({...h,name:x.trim()}),o(""),g(null),f("")},T=y=>{n(y)},H=()=>{o(""),g(null),f(""),r(!1)};return e.jsxs(me,{title:h?"ערוך קטגוריה":"הוסף קטגוריה חדשה",open:t,onCancel:H,footer:null,className:"category-modal popup-modal",children:[e.jsxs("div",{className:"category-form-section",children:[e.jsx(bt,{level:4,children:h?"ערוך קטגוריה":"הוסף קטגוריה חדשה"}),e.jsx(de,{placeholder:"הזן שם קטגוריה",value:x,onChange:y=>o(y.target.value),onPressEnter:U}),S&&e.jsx(gn,{type:"danger",className:"error-message",children:S}),e.jsx(_,{type:"primary",onClick:U,style:{marginTop:"10px"},children:h?"עדכן קטגוריה":"הוסף קטגוריה"})]}),e.jsxs("div",{className:"category-list-section",children:[e.jsx(bt,{level:4,style:{marginTop:"20px"},children:"קטגוריות קיימות:"}),e.jsx(ie,{dataSource:u,renderItem:y=>e.jsx(ie.Item,{className:h&&h._id===y._id?"editing-item":"",actions:[h&&h._id===y._id?e.jsx(_,{type:"link",onClick:P,children:"שמור"}):e.jsx(_,{type:"link",onClick:()=>v(y),children:"ערוך"}),e.jsx(xt,{title:"האם אתה בטוח שברצונך למחוק את הקטגוריה?",onConfirm:()=>T(y._id),okText:"כן",cancelText:"לא",children:e.jsx(_,{icon:e.jsx(Fe,{}),type:"text",danger:!0})})],children:h&&h._id===y._id?e.jsx(de,{value:x,onChange:I=>o(I.target.value),onPressEnter:P,autoFocus:!0}):y.name})})]})]})},{Text:It}=Q,yn=({ingredients:t,sizes:r,add:s,remove:l,indexSize:n,form:u,onChange:x,getUnitDisplay:o,setDisabledSave:h})=>{var ne,se,le;const g=c.useRef(null),[S,f]=c.useState(null),[U,v]=c.useState(!1),[P,T]=c.useState(!1),[H,y]=c.useState(null),[I,i]=c.useState(null),[a,j]=c.useState(""),w=c.useCallback(()=>{setTimeout(()=>{g.current&&g.current.scroll({top:g.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(ne=g.current)==null?void 0:ne.scrollHeight]),d=k=>{f(k),h(!0)},m=()=>{f(null),h(!1),T(!1),v(!1),j("")},b=()=>{u.validateFields().then(()=>{f(null),h(!1),T(!1),v(!1),j("")})},C=k=>{const E=[...r];E[n]={...E[n],ingredients:k},x(E)},A=(k,E)=>{y({ingredientId:k,unit:E.unit,name:E.label})},W=k=>{i(k)},q=()=>{if(!H||!I)return;const k={...H,quantity:I},p=[...u.getFieldValue("ingredients")||[],k];u.setFieldsValue({ingredients:p}),C(p),y(null),i(null),T(!1),f(null),h(!1),v(!1)},N=k=>{const p=(u.getFieldValue("ingredients")||[]).filter((B,J)=>J!==k);u.setFieldsValue({...p}),C(p),l(k)},F=k=>{if(!k)return"";if(k.name)return k.name;if(k.ingredientId&&t){const E=t.find(p=>p._id===k.ingredientId);return(E==null?void 0:E.name)||""}return""},z=()=>{const k=u.getFieldValue("ingredients");return Array.isArray(k)?k:[]};return c.useEffect(()=>{z().length>0&&w()},[(se=u.getFieldValue("ingredients"))==null?void 0:se.length]),e.jsxs(e.Fragment,{children:[P?e.jsxs(L,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsxs(Y,{span:10,children:[" ",e.jsx(oe,{placeholder:"בחר רכיב",style:{width:"100%"},filterOption:(k,E)=>{var p;return(p=E==null?void 0:E.label)==null?void 0:p.toLowerCase().includes(k.toLowerCase())},showSearch:!0,options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:A})]}),e.jsxs(Y,{span:10,children:[" ",e.jsx(ue,{onChange:W,addonAfter:o((H==null?void 0:H.unit)||""),placeholder:"כמות",style:{width:"100%"}})]}),e.jsxs(Y,{children:[" ",e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:q}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:m})]})]}):e.jsx(_,{type:"dashed",onClick:()=>{T(!0),v(!0),f(z().length),h(!0)},disabled:S!==null,children:"הוסף מרכיב"}),e.jsx(ae,{ref:g,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ie,{dataSource:(le=r[n])==null?void 0:le.ingredients,renderItem:(k,E)=>{var p;return e.jsx(ie.Item,{children:S!==E?e.jsxs(L,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(D,{flex:2,children:e.jsx(It,{children:F(k)})}),e.jsx(D,{flex:1,children:e.jsxs(It,{children:[k==null?void 0:k.quantity," ",o(k==null?void 0:k.unit)]})}),e.jsxs(Y,{children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Me}),onClick:()=>d(E)}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:$e}),onClick:()=>N(E)})]})]}):!U&&e.jsxs(L,{style:{width:"100%"},gutter:16,children:[e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[E,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((p=k.ingredientId)==null?void 0:p._id)||k.ingredientId,children:e.jsx(oe,{placeholder:"בחר רכיב",showSearch:!0,filterOption:(B,J)=>{var te;return(te=J==null?void 0:J.label)==null?void 0:te.toLowerCase().includes(B.toLowerCase())},options:t==null?void 0:t.map(B=>({value:B._id,label:B.name,unit:B.unit})),onChange:A})})}),e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[E,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(ue,{addonAfter:o(k==null?void 0:k.unit),onChange:W})})}),e.jsxs(Y,{span:4,children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:b}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:m})]})]})},E)}})})]})},{Text:kt}=Q,fn=({mixes:t,sizes:r,add:s,remove:l,indexSize:n,form:u,onChange:x,getUnitDisplay:o,setDisabledSave:h})=>{var ne,se,le;const g=c.useRef(null),[S,f]=c.useState(null),[U,v]=c.useState(!1),[P,T]=c.useState(!1),[H,y]=c.useState(null),[I,i]=c.useState(null),[a,j]=c.useState(""),w=c.useCallback(()=>{setTimeout(()=>{g.current&&g.current.scroll({top:g.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(ne=g.current)==null?void 0:ne.scrollHeight]),d=k=>{f(k),h(!0)},m=()=>{f(null),h(!1),T(!1),v(!1),j("")},b=()=>{u.validateFields().then(()=>{f(null),h(!1),T(!1),v(!1),j("")})},C=k=>{const E=[...r];E[n]={...E[n],mixes:k},x(E)},A=(k,E)=>{y({mixId:k,unit:(E==null?void 0:E.unit)||"weight",name:E.label})},W=k=>{i(k)},q=()=>{if(!H||!I)return;const k={...H,quantity:I},p=[...u.getFieldValue("mixes")||[],k];u.setFieldsValue({mixes:p}),C(p),y(null),i(null),T(!1),j(""),f(null),h(!1),v(!1)},N=k=>{const p=(u.getFieldValue("mixes")||[]).filter((B,J)=>J!==k);u.setFieldsValue({...p}),C(p),l(k)},F=k=>{if(!k)return"";if(k.name)return k.name;if(k.mixId&&t){const E=t.find(p=>p._id===k.mixId);return(E==null?void 0:E.name)||""}return""},z=()=>{const k=u.getFieldValue("mixes");return Array.isArray(k)?k:[]};return c.useEffect(()=>{z().length>0&&w()},[(se=u.getFieldValue("mixes"))==null?void 0:se.length]),e.jsxs(e.Fragment,{children:[P?e.jsxs(L,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsx(Y,{span:10,children:e.jsx(oe,{placeholder:"בחר רכיב",filterOption:(k,E)=>{var p;return(p=E==null?void 0:E.label)==null?void 0:p.toLowerCase().includes(k.toLowerCase())},showSearch:!0,style:{width:"100%"},options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:A})}),e.jsx(Y,{span:10,children:e.jsx(ue,{onChange:W,addonAfter:o(a),placeholder:"כמות",style:{width:"100%"}})}),e.jsxs(Y,{children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:q}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:m})]})]}):e.jsx(_,{type:"dashed",onClick:()=>{T(!0),v(!0),f(z().length),h(!0)},disabled:S!==null,children:"הוסף מרכיב"}),e.jsx(ae,{ref:g,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ie,{dataSource:(le=r[n])==null?void 0:le.mixes,renderItem:(k,E)=>{var p;return e.jsx(ie.Item,{children:S!==E?e.jsxs(L,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(D,{flex:1,children:e.jsx(kt,{children:F(k)})}),e.jsx(D,{flex:1,children:e.jsxs(kt,{children:[k==null?void 0:k.quantity," ",o(k==null?void 0:k.unit)]})}),e.jsxs(L,{children:[e.jsx(_,{type:"text",onClick:()=>d(E),children:e.jsx(O,{icon:Me})}),e.jsx(_,{type:"text",onClick:()=>N(E),children:e.jsx(O,{icon:$e})})]})]}):!U&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[E,"mixId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((p=k.mixId)==null?void 0:p._id)||k.mixId,children:e.jsx(oe,{placeholder:"בחר רכיב",showSearch:!0,filterOption:(B,J)=>{var te;return(te=J==null?void 0:J.label)==null?void 0:te.toLowerCase().includes(B.toLowerCase())},options:t==null?void 0:t.map(B=>({value:B._id,label:B.name,unit:B.unit})),onChange:A})})}),e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[E,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(ue,{addonAfter:o(k==null?void 0:k.unit),onChange:W})})}),e.jsxs(Y,{span:4,children:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Pe}),onClick:b}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Te}),onClick:m})]})]})},E)}})})]})};function vn({size:t,sizes:r,indexSize:s,handleCancelEdit:l,handleRemoveSize:n,newSizeId:u,form:x,ingredients:o,mixes:h,onChange:g,getUnitDisplay:S,activeSubTab:f,setActiveSubTab:U,setNewSizeId:v,onSubmit:P}){var I,i;const[T,H]=c.useState(!1),y=async()=>{var a;try{const j=await x.validateFields();v(null),g(r==null?void 0:r.map((w,d)=>d===s?{...w,...j,edit:!1}:w)),P(j)}catch(j){const d=(a=j.errorFields[0])==null?void 0:a.name;d!=null&&d.includes("ingredients")?U("1"):d!=null&&d.includes("mixes")&&U("2")}};return e.jsxs("div",{className:t.idNew===u?"highlight-new":"",style:{border:`1px ${t!=null&&t.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(L,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsxs(D,{flex:2,children:[e.jsx($.Item,{name:["_id"],hidden:!0,children:e.jsx(de,{})}),e.jsx($.Item,{name:["label"],label:"שם הגודל",rules:[{required:!0,message:"חייב למלא שם גודל"},{min:1,message:"שם גודל חייב להיות לפחות 1 תווים"},{max:25,message:"שם גודל לא יכול לחרוג מ-25 תווים"}],children:e.jsx(de,{placeholder:"שם הגודל",size:"middle",showCount:!0,style:{width:"auto",minWidth:"200px"},maxLength:25})})]}),e.jsxs(D,{flex:1,style:{alignSelf:"flex-start"},justify:"end",children:[e.jsx(_,{type:"text",icon:e.jsx(mt,{}),onClick:()=>l(s)}),e.jsx(_,{type:"text",danger:!0,icon:e.jsx(Fe,{}),title:"מחק גודל",onClick:()=>n(s)})]})]}),e.jsxs(L,{gutter:[16,16],children:[e.jsx(Y,{span:12,children:e.jsx($.Item,{name:["price"],label:"מחיר",rules:[{required:!0,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(ue,{placeholder:"מחיר",style:{width:"100%"},addonAfter:"₪"})})}),e.jsx(Y,{span:12,children:e.jsx($.Item,{label:"זמן הכנה (דקות)",name:["preparationTime"],rules:[{required:!0,message:"חייב לציין זמן הכנה"}],children:e.jsx(ue,{placeholder:"זמן הכנה",style:{width:"100%"},addonAfter:e.jsx(O,{style:{fontSize:"0.9em"},icon:pt})})})})]}),e.jsxs(ve,{activeKey:f,onChange:a=>U(a),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:[e.jsxs(vt,{tab:`מרכיבים (${((I=t==null?void 0:t.ingredients)==null?void 0:I.length)||0})`,children:[e.jsx(Q.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx($.List,{name:["ingredients"],children:(a,{add:j,remove:w})=>e.jsx(yn,{add:j,remove:w,fields:a,form:x,indexSize:s,setDisabledSave:H,ingredients:o,onChange:g,getUnitDisplay:S,sizes:r})})]},1),e.jsxs(vt,{tab:`מיקסים (${((i=t==null?void 0:t.mixes)==null?void 0:i.length)||0})`,children:[e.jsx(Q.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מיקסים:"}),e.jsx($.List,{name:["mixes"],children:(a,{add:j,remove:w})=>e.jsx(fn,{add:j,remove:w,fields:a,form:x,indexSize:s,setDisabledSave:H,mixes:h,onChange:g,getUnitDisplay:S,sizes:r})})]},2)]}),e.jsx(_,{type:"primary",htmlType:"submit",disabled:T,onClick:()=>y(),children:"שמור"})]},t.idNew||s)}const{Text:_t}=Q;function Wt({size:t,index:r,sizeInfo:s,type:l,handleEditSize:n,handleRemoveSize:u,ingredients:x,mixes:o,sizeSummary:h,priceExcludingVAT:g}){const S=V(v=>{var P,T;return(T=(P=v.settings.settings)==null?void 0:P.hourlyRate)==null?void 0:T.value}),f=(v,P)=>{const T=v;if(!T)return null;const H=P;return e.jsx(L,{children:e.jsxs(D,{flex:1,style:{flexDirection:"column"},children:[e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:'מחיר ללא מע"מ:'}),e.jsxs(Q.Text,{style:{marginRight:8},children:["₪",H," (₪",((t==null?void 0:t.price)-H).toFixed(2),")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:"סך הכל עלות:"}),e.jsxs(Q.Text,{style:{marginRight:8},children:["₪",T==null?void 0:T.totalCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:"אחוז רווח:"}),e.jsx(ps,{percent:T==null?void 0:T.profitMargin})]}),l!=="P"&&e.jsxs(ae,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs(L,{justify:"space-between",style:{marginTop:"1vh"},children:[e.jsx(Q.Text,{strong:!0,children:"עלות עבודה:"}),e.jsxs(Q.Text,{children:["₪",T==null?void 0:T.laborCost," (₪",S,")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:"עלות מרכיבים:"}),e.jsxs(Q.Text,{children:["₪",T==null?void 0:T.ingredientCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:"עלות מיקסים:"}),e.jsxs(Q.Text,{children:["₪",T==null?void 0:T.mixCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,children:"עלות הוצאות קבועות:"}),e.jsx(Q.Text,{children:"₪"})]})]})]})})},U=({type:v,size:P,ingredients:T,mixes:H})=>{const[y,I]=c.useState("ingredients"),i=()=>{var w;const j=(w=P==null?void 0:P.ingredients)==null?void 0:w.map(d=>{var C;const m=(()=>{switch(d==null?void 0:d.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((C=T==null?void 0:T.find(A=>(A==null?void 0:A._id)===(d==null?void 0:d.ingredientId)))==null?void 0:C.name)||"לא ידוע",quantity:d==null?void 0:d.quantity,unitDisplay:m,cost:d==null?void 0:d.costForQuantity}});return e.jsx(ie,{dataSource:j,style:{paddingLeft:"20px",margin:"0",maxHeight:"8vw",overflow:"auto"},renderItem:(d,m)=>e.jsx(ie.Item,{style:{marginBottom:"4px"},children:e.jsxs(_t,{children:[d.name," - ",d.quantity," ",d.unitDisplay," - ₪",d.cost]})},m)})},a=()=>{var w;const j=(w=P==null?void 0:P.mixes)==null?void 0:w.map(d=>{var C;const m=(()=>{switch(d.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((C=H==null?void 0:H.find(A=>(A==null?void 0:A._id)===(d==null?void 0:d.mixId)))==null?void 0:C.name)||"לא ידוע",quantity:d.quantity,unitDisplay:m,cost:d==null?void 0:d.costForQuantity}});return e.jsx(ie,{dataSource:j,style:{paddingLeft:"20px",margin:"0",maxHeight:"8vw",overflow:"auto"},renderItem:(d,m)=>e.jsx(ie.Item,{style:{marginBottom:"4px"},children:e.jsxs(_t,{children:[d.name," - ",d.quantity," ",d.unitDisplay," - ₪",d.cost]})},m)})};return e.jsx(e.Fragment,{children:v!=="P"&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(L,{style:{gap:"1.5vw",height:"10vw"},children:[e.jsx(D,{align:"center",justify:"center",children:e.jsx(hs,{vertical:!0,options:[{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(O,{icon:qe}),e.jsx("div",{children:"מרכיבים"})]}),value:"ingredients"},{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(O,{icon:ht}),e.jsx("div",{children:"מיקסים"})]}),value:"mixes"}],onChange:j=>I(j),style:{marginBottom:"12px",direction:""}})}),e.jsx(D,{flex:1,children:e.jsx(ae,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:y==="ingredients"?i():a()})})]})]})})};return e.jsxs("div",{children:[e.jsx(D,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(Y,{className:"width-100",style:{display:"flex",flexDirection:"column",gap:"0.3em"},children:[e.jsx(D,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(L,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,style:{fontSize:"1.6em"},children:t==null?void 0:t.label}),e.jsxs(D,{children:[n&&e.jsx(_,{type:"text",icon:e.jsx(gt,{}),onClick:()=>n(r)}),u&&e.jsx(_,{type:"text",danger:!0,icon:e.jsx(Fe,{}),onClick:()=>u(r)}),l==="P"&&e.jsx(_,{type:"text",size:"large",icon:e.jsx(Ht,{}),onClick:()=>s(r)})]})]})}),e.jsx(D,{flex:1,align:"start",style:{gap:"12px",marginBottom:"8px",flexDirection:"column"},children:e.jsxs(L,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(ot,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",t==null?void 0:t.price]})]}),e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsx(Rt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Q.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[t==null?void 0:t.preparationTime," דקות"]})]})]})}),f(h,g)]})}),e.jsx(U,{ingredients:x,mixes:o,size:t,type:l})]},t.idNew||r)}we.locale("he");const wn=Ot("employeeHours/buildMonthData",async({selectedDate:t,employees:r,employeeHours:s},{dispatch:l})=>{const n=we(t,"YYYY-MM").daysInMonth(),u=Array.from({length:n},(x,o)=>{const h=we(t,"YYYY-MM").date(o+1),g=h.format("dddd"),S=g==="שישי"||g==="שבת",f=r.map(P=>{const T=s.find(y=>{var I;return((I=y==null?void 0:y.employeeId)==null?void 0:I._id)===(P==null?void 0:P._id)&&we(y==null?void 0:y.date).isSame(h,"day")});if(!T)return null;const H=!T.startTime||!T.endTime;return{hoursId:T._id,employeeId:P._id,name:P.name,hourlyRate:P.hourlyRate,hoursWorked:T.hoursWorked,hours:{start:T.startTime,end:T.endTime},hasError:H}}).filter(Boolean),U=f.reduce((P,T)=>P+T.hoursWorked,0),v=f.length;return{date:h.format("YYYY-MM-DD"),dayOfWeek:g,status:S&&g==="שישי"?"חצי יום":"יום מלא",isPast:h.isBefore(we(),"day"),isToday:h.isSame(we(),"day"),employees:f,totalHours:U,employeesCount:v}});l(Sn(u))}),Qt=Se({name:"employeeHours",initialState:{data:[],selectedDate:we().startOf("month").format("YYYY-MM")},reducers:{setEmployeeHoursState:(t,r)=>{t.data=r.payload},setSelectedDate:(t,r)=>{t.selectedDate=r.payload},addOrUpdateEmployeeHoursState:(t,r)=>{const s=r.payload,l=t.data.findIndex(n=>n._id===s._id);l!==-1?t.data[l]=s:t.data.unshift(s)},updateEmployeeHoursState:(t,r)=>{const s=r.payload;t.data=t.data.map(l=>l._id===s._id?s:l)},deleteEmployeeHoursState:(t,r)=>{const s=r.payload._id;t.data=t.data.filter(l=>l._id!==s)}}}),{setEmployeeHoursState:Sn,addOrUpdateEmployeeHoursState:Cn,updateEmployeeHoursState:bn,deleteEmployeeHoursState:In,setSelectedDate:kn}=Qt.actions,_n=Qt.reducer,Yt=Se({name:"products",initialState:[],reducers:{setProductsState:(t,r)=>{const{products:s,ingredientsState:l,mixesState:n,averageHourlyRate:u}=r.payload;return s},addOrUpdateProductState:(t,r)=>{const{newProduct:s,ingredientsState:l,mixesState:n,averageHourlyRate:u}=r.payload,x=s,o=t.findIndex(h=>h._id===s._id);o!==-1?t[o]=x:t.unshift(x)},updateProductState:(t,r)=>{const{updatedProduct:s,ingredientsState:l,mixesState:n,averageHourlyRate:u}=r.payload,x=s;return t.map(o=>o._id===s._id?x:o)},deleteProductState:(t,r)=>{const s=r.payload._id;return t.filter(l=>l._id!==s)}}}),{setProductsState:Pn,addOrUpdateProductState:dt,updateProductState:Bi,deleteProductState:Tn}=Yt.actions,Fn=Yt.reducer,En=c.forwardRef(({size:t,indexSize:r,getProductById:s,sizes:l,onChange:n,onDelete:u,newSizeId:x,setSelectedUpdateSize:o,setNewSizeId:h,transformValueToForm:g,setActiveTabKey:S,ingredients:f,mixes:U,sizeSummary:v,priceExcludingVAT:P,activeSubTab:T,setActiveSubTab:H,onSubmit:y},I)=>{const[i]=$.useForm(),a=Le();c.useImperativeHandle(I,()=>({setFieldsValue:b=>i.setFieldsValue(b),getFieldsValue:()=>i.getFieldsValue(),resetFields:()=>i.resetFields()}));const j=()=>{const b=[...l];b[r]={...b[r],edit:!1,ingredients:t.ingredients.filter(C=>C==null?void 0:C._id),mixes:t.mixes.filter(C=>C==null?void 0:C._id)},n(b)},w=b=>{const C=[...l];C[b]={...C[b],edit:!0},n(C),o(b)},d=b=>{const C=l[b];if(C!=null&&C._id)me.confirm({title:"האם אתה בטוח שברצונך למחוק את הגודל הזה?",content:`המחיקה תסיר לצמיתות את ${C.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{u(C==null?void 0:C.productId,C._id).then(()=>{const A=[...l];A.splice(b,1),n(A),i.setFieldsValue({...A[b]}),S(Math.max(0,b-1).toString()||"0"),s(C==null?void 0:C.productId).then(W=>{a(dt({newProduct:W}))})}).catch(A=>{console.error("Error deleting size:",A)})}});else{const A=[...l];A.splice(b,1),n(A),i.setFieldsValue({...t}),S(Math.max(0,b-1).toString()||"0"),h(null)}},m=b=>{switch(b){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return c.useEffect(()=>{console.log(i.getFieldsValue()),console.log(t)},[i,t]),!(t!=null&&t._id)||t!=null&&t.edit?e.jsx($,{form:i,initialValues:{...t},children:e.jsx(vn,{handleCancelEdit:j,handleRemoveSize:d,newSizeId:x,size:t,indexSize:r,onChange:n,form:i,ingredients:f,mixes:U,setNewSizeId:h,setActiveSubTab:H,activeSubTab:T,sizes:l,getUnitDisplay:m,onSubmit:y})}):e.jsx(Wt,{handleEditSize:w,handleRemoveSize:d,index:r,size:t,ingredients:f,mixes:U,priceExcludingVAT:P,sizeSummary:v})}),{TabPane:$n}=ve,Pt=c.forwardRef(({value:t=[],onChange:r,getProductById:s,setSelectedUpdateSize:l,ingredients:n,activeTabKey:u,setActiveTabKey:x,mixes:o,onSubmit:h,onDelete:g,sizeSummary:S,priceExcludingVAT:f},U)=>{const[v,P]=c.useState(null),[T,H]=c.useState("1"),y=c.useRef([]),I=a=>({value:a}),i=()=>{var w;const a={idNew:Date.now(),label:`גודל ${t.length+1}`,price:null,preparationTime:null,ingredients:[],mixes:[],edit:!0},j=[...t,a];r(j),(w=y.current[+u])==null||w.setFieldsValue({...a}),P(a.idNew),x(t.length.toString()||"0"),H("1")};return e.jsxs(D,{style:{flexDirection:"column"},children:[e.jsx(_,{type:"default",icon:e.jsx(jt,{}),onClick:i,children:"הוסף גודל"}),e.jsx(ve,{activeKey:u,onChange:a=>x(a||"0"),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:t==null?void 0:t.map((a,j)=>{var w;return e.jsx($n,{tab:(a==null?void 0:a.label)||`גודל ${j+1}`,children:e.jsx(En,{ref:d=>y.current[j]=d,size:a,indexSize:j,setSelectedUpdateSize:l,sizes:t,onChange:r,onDelete:g,getProductById:s,ingredients:n,transformValueToForm:I,setActiveTabKey:x,setActiveSubTab:H,activeSubTab:T,mixes:o,onSubmit:h,newSizeId:v,setNewSizeId:P,sizeSummary:S&&S[j],priceExcludingVAT:f&&((w=f[j])==null?void 0:w.priceExcludingVAT)})},j.toString())})})]})}),{TabPane:Tt}=ve,Ft=c.forwardRef(({value:t=[],sizes:r,onChange:s,ingredients:l,onSubmit:n,onDelete:u},x)=>{const[o,h]=c.useState(null),[g,S]=c.useState("0"),[f]=$.useForm(),U=()=>({value:t}),v=()=>{const y={idNew:Date.now(),label:`וריאציה - ${t.length+1}`,sizeAdjustments:[...r==null?void 0:r.map(i=>({sizeId:i==null?void 0:i._id,label:i==null?void 0:i.label,priceAdjustment:null,preparationTimeAdjustment:null,ingredients:i==null?void 0:i.ingredients,mixes:i==null?void 0:i.mixes,add:[],remove:[],update:[]}))]},I=[...t,y];s(I),f.setFieldsValue({variations:I}),h(y.idNew),S(t.length.toString())},P=y=>{const I=t[y];if(I!=null&&I._id)me.confirm({title:"האם אתה בטוח שברצונך למחוק את הוריאציה הזו?",content:`המחיקה תסיר לצמיתות את ${I.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{u(I==null?void 0:I.productId,I._id).then(()=>{const i=[...t];i.splice(y,1),s(i),f.setFieldsValue({sizes:i}),S(Math.max(0,y-1).toString())}).catch(i=>{console.error("Error deleting vatiation:",i)})}});else{const i=[...t];i.splice(y,1),s(i),f.setFieldsValue(U()),S(Math.max(0,y-1).toString()),h(null)}},T=y=>{const I=[...t];I[y]={...I[y],edit:!0},s(I)},H=y=>{switch(y){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return e.jsxs($,{form:f,initialValues:{variations:t},onFinish:(y,I)=>{var i;n({variations:(i=y==null?void 0:y.variations)==null?void 0:i.filter(a=>a)})},children:[!r.length&&e.jsx(ms,{message:"לא ניתן להוסיף וריאציות",description:"יש להוסיף לפחות גודל אחד לפני שניתן להוסיף וריאציות.",type:"warning",showIcon:!0,style:{marginBottom:"16px"}}),e.jsx(_,{type:"default",icon:e.jsx(jt,{}),disabled:(r==null?void 0:r.length)===0||!r,onClick:v,children:"הוסף וריאציה"}),e.jsx($.List,{name:["variations","sizeAdjustments"],children:(y,{add:I,remove:i})=>{ve,y.map(({key:a,name:j,fieldKey:w})=>{var m;const d=f.getFieldValue(["variations","sizeAdjustments",a]);return e.jsx(Tt,{tab:(d==null?void 0:d.label)||`גודל ${a+1}`,children:!(d!=null&&d._id)||d!=null&&d.edit?e.jsxs("div",{className:d.idNew===o?"highlight-new":"",style:{border:`1px ${d!=null&&d.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(L,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsx($.Item,{name:["variations","sizeAdjustments",a,"_id"],hidden:!0,children:e.jsx(de,{})}),e.jsx($.Item,{name:["variations","sizeAdjustments",a,"label"],label:"שם הוריאציה",rules:[{required:!0,message:"חייב למלא שם גודל"}],children:e.jsx(de,{placeholder:"שם הוריאציה",size:"middle",style:{width:"auto",minWidth:"200px"}})}),e.jsx(_,{type:"text",style:{alignSelf:"flex-start"},danger:!0,icon:e.jsx(Fe,{}),title:"מחק וריאציה",onClick:()=>P(a),children:"מחק וריאציה"})]}),e.jsx($.List,{name:["variations","sizeAdjustments",a],children:(b,{add:C,remove:A})=>e.jsx(ve,{tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:b.map(({key:W,name:q,fieldKey:N})=>{const F=f.getFieldValue(["variations",index,"sizeAdjustments",q]);return e.jsxs(Tt,{tab:(F==null?void 0:F.label)||`Size ${q}`,children:[e.jsxs(L,{gutter:[16,16],children:[e.jsx(Y,{span:12,children:e.jsx($.Item,{name:["variations",index,"price"],label:"תוספת מחיר",rules:[{required:!1,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(ue,{placeholder:"מחיר",style:{width:"100%"}})})}),e.jsx(Y,{span:12,children:e.jsx($.Item,{label:"תוספת זמן הכנה (דקות)",name:["sizes",index,"preparationTime"],rules:[{required:!1,message:"חייב לציין זמן הכנה"}],children:e.jsx(ue,{placeholder:"זמן הכנה",style:{width:"100%"}})})})]}),e.jsx(Q.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx($.List,{name:["sizes",index,"ingredients"],children:(z,{add:ne,remove:se})=>e.jsxs(e.Fragment,{children:[e.jsx(_,{type:"dashed",style:{marginBottom:"0.5vw"},onClick:()=>ne({ingredientId:null,quantity:null,unit:null}),children:"הוסף מרכיב"}),e.jsx("div",{style:{maxHeight:"12vw",overflowY:"auto",overflowX:"hidden"},children:z.map(({key:le,name:k,fieldKey:E})=>e.jsxs(L,{gutter:16,children:[e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[k,"ingredientId"],fieldKey:[E,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(oe,{placeholder:"בחר מרכיב",showSearch:!0,filterOption:(p,B)=>{var J;return(J=B==null?void 0:B.label)==null?void 0:J.toLowerCase().includes(p.toLowerCase())},options:l.map(p=>({value:p._id,label:p.name,unit:p==null?void 0:p.unit}))})})}),e.jsx(Y,{span:10,children:e.jsx($.Item,{name:[k,"quantity"],fieldKey:[E,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(ue,{placeholder:"כמות",addonAfter:H(f.getFieldValue(["sizes",index,"ingredients",k,"unit"])||"")})})}),e.jsx(Y,{span:4,children:e.jsx(_,{type:"text",danger:!0,icon:e.jsx(mt,{}),onClick:()=>se(k)})})]},le))})]})})]},W)})})}),e.jsx(Z,{style:{margin:"12px 0"}})]},d.idNew||a):e.jsxs("div",{style:{border:"1px solid #e6e6e6",borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",marginBottom:"16px"},children:[e.jsx(D,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(Y,{className:"width-100",children:[e.jsx(D,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(L,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Q.Text,{strong:!0,style:{fontSize:"1.2em"},children:size==null?void 0:size.label}),e.jsxs(D,{children:[e.jsx(_,{type:"text",icon:e.jsx(gt,{}),onClick:()=>T(index)}),e.jsx(_,{type:"text",danger:!0,icon:e.jsx(Fe,{}),onClick:()=>P(index)})]})]})}),e.jsxs(D,{flex:1,align:"middle",style:{gap:"12px",marginBottom:"8px"},children:[e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Q.Text,{style:{color:"#007acc",fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:["₪",size==null?void 0:size.price]}),e.jsx(O,{style:{fontSize:"0.9em",color:"#007acc"},icon:bs})]}),e.jsxs(L,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Q.Text,{style:{fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:[size==null?void 0:size.preparationTime," דקות"]}),e.jsx(O,{style:{fontSize:"0.9em"},icon:pt})]})]})]})}),e.jsx(Z,{style:{margin:"12px 0"}}),e.jsx(Q.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:(m=size==null?void 0:size.ingredients)==null?void 0:m.map((b,C)=>{var W;const A=(()=>{switch(b.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(Q.Text,{children:[(W=l==null?void 0:l.find(q=>(q==null?void 0:q._id)===(b==null?void 0:b.ingredientId)))==null?void 0:W.name," -"," ",b.quantity," ",A]})},C)})})]},size.idNew||index)},a)})}}),e.jsx(_,{type:"primary",htmlType:"submit",disabled:t.length===0,onClick:()=>h(null),children:"שמור"})]})}),{Title:Di,Text:Et}=Q,{TabPane:Mn}=ve,Nn=({})=>{var W;const{isModalVisible:t,setIsModalVisible:r,modalMode:s,setModalMode:l,selectedItem:n,setSelectedItem:u,selectedUpdateSize:x,setSelectedUpdateSize:o,getProductById:h,addProduct:g,updateProduct:S,deleteProduct:f,addSize:U,updateSize:v,deleteSize:P}=Bt(),T=Ee({query:"(max-width: 500px)"}),H=V(q=>q.categories),y=(W=V(q=>q.ingredients))==null?void 0:W.filter(q=>q==null?void 0:q.is_active),I=V(q=>q.mixes),i=V(q=>q.products),[a,j]=c.useState("0"),w=c.useCallback(()=>{if(!n||!i)return;const q=i.find(N=>N._id===n._id);q&&u({...q})},[n,i]);c.useEffect(()=>{w()},[i]);const[d]=$.useForm(),m=(q,N,F)=>{if(q==="product")switch(N){case"add":return"הוספת מוצר";case"edit":return"עדכון מוצר";case"view":return"צפייה במוצר";default:return"הוספת מוצר"}else switch(q){case"size":return`ניהול גדלים - ${F==null?void 0:F.name}`;case"variation":return`ניהול וריאציות - ${F==null?void 0:F.name}`}};c.useEffect(()=>{n?d.setFieldsValue(n):d.resetFields()},[n]);const b=q=>{var N,F,z,ne;switch(t){case"product":const se=d.getFieldsValue();s==="edit"?S({...se,_id:n==null?void 0:n._id}).then(()=>{r(!1),u(null)}).catch(E=>{console.error("שגיאה בעריכת מוצר:",E)}):g(se).then(()=>{r(!1),u(null)}).catch(E=>{console.error("שגיאה בהוספת מוצר:",E)});break;case"size":const le=q,k={productId:n==null?void 0:n._id,label:le.label,price:le.price,preparationTime:le.preparationTime,ingredients:((F=(N=le.ingredients)==null?void 0:N.filter(E=>E))==null?void 0:F.map(E=>{var p;return{ingredientId:((p=E.ingredientId)==null?void 0:p._id)||E.ingredientId,quantity:E.quantity,unit:E.unit}}))||[],mixes:((ne=(z=le.mixes)==null?void 0:z.filter(E=>E))==null?void 0:ne.map(E=>({mixId:E.mixId,quantity:E.quantity,unit:E.unit})))||[],_id:le._id};new Promise((E,p)=>k._id?v(k._id,k):U(n==null?void 0:n._id,k)).then(()=>{}).catch(E=>{console.error("Error managing sizes:",E)});break}},C=()=>{switch(t){case"product":return e.jsxs($,{form:d,layout:"vertical",onFinish:b,children:[e.jsx($.Item,{name:"name",label:"שם מוצר",rules:[{required:!0,message:"אנא הזן שם מוצר"},{max:25,message:"שם המוצר לא יכול להיות יותר מ-25 תווים"}],children:e.jsx(de,{maxLength:25,showCount:!0})}),e.jsx($.Item,{name:"category",label:"קטגוריה",rules:[{required:!0,message:"אנא בחר קטגוריה"}],children:e.jsx(oe,{showSearch:!0,placeholder:"בחר קטגוריה",optionFilterProp:"children",filterOption:(q,N)=>N.children.toLowerCase().indexOf(q.toLowerCase())>=0,children:H.map(q=>e.jsx(oe.Option,{value:q._id,children:q==null?void 0:q.name},q._id))})}),e.jsx($.Item,{name:"isFeatured",label:"פעיל",children:e.jsx(it,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx($.Item,{name:"isOnSale",label:"מוצר מכירה",children:e.jsx(it,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx($.Item,{name:"notes",label:"הערות",rules:[{required:!1,message:"אנא הזן הערות"},{max:250,message:"ההערות לא יכולות להיות יותר מ-250 תווים"}],children:e.jsx(de.TextArea,{rows:4,maxLength:250,showCount:!0})}),e.jsx($.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"שמור מוצר"})})]});case"size":return e.jsx(Pt,{value:n==null?void 0:n.sizes,setValue:u,ingredients:y,sizeSummary:n==null?void 0:n.sizeSummary,setSelectedUpdateSize:o,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,getProductById:h,mixes:I,onDelete:P,activeTabKey:a,setActiveTabKey:j,onSubmit:b,onChange:q=>u({...n,sizes:q})});case"variation":return e.jsx(Ft,{value:n==null?void 0:n.variations,form:formVariation,setValue:u,sizes:n==null?void 0:n.sizes,ingredients:y,onChange:q=>u({...n,variations:q})});default:return null}},A=()=>{var q,N,F;switch(t){case"product":return e.jsxs("div",{styles:{body:{display:"flex",flexDirection:"column"}},children:[e.jsxs(D,{style:{gap:"1em",flexDirection:"column",margin:"1em 0em"},children:[e.jsx(Et,{strong:!0,style:{fontSize:"1.5em"},children:n==null?void 0:n.name}),e.jsx(_e,{style:{width:"fit-content"},children:(q=H==null?void 0:H.find(z=>z._id===(n==null?void 0:n.category)))==null?void 0:q.name}),e.jsxs(D,{style:{gap:"0.5em",flexDirection:"column"},children:[e.jsx(De,{status:n!=null&&n.isFeatured?"success":"default",text:n!=null&&n.isFeatured?"פעיל":"לא פעיל"}),e.jsx(De,{status:n!=null&&n.isOnSale?"processing":"default",text:n!=null&&n.isOnSale?"במבצע":"לא במבצע"})]})]}),((N=n==null?void 0:n.notes)==null?void 0:N.length)>0&&e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(D,{flex:1,children:e.jsxs(Et,{strong:!0,children:["הערות",":"]})}),e.jsx(D,{flex:1,children:e.jsx("p",{style:{},children:n==null?void 0:n.notes})})]}),e.jsx(D,{flex:1,children:e.jsx(ve,{style:{width:"100%"},type:"card",children:(F=n==null?void 0:n.sizes)==null?void 0:F.map((z,ne)=>e.jsx(Mn,{tab:z.label,children:e.jsx(Wt,{handleEditSize:!1,handleRemoveSize:!1,index:ne,size:z,type:"P",sizeInfo:se=>{r("size"),j((se==null?void 0:se.toString())||"0")},ingredients:y,mixes:I,priceExcludingVAT:(n==null?void 0:n.priceExcludingVAT)&&(n==null?void 0:n.priceExcludingVAT[ne].priceExcludingVAT),sizeSummary:(n==null?void 0:n.sizeSummary)&&(n==null?void 0:n.sizeSummary[ne])})},ne))})})]});case"size":return e.jsx(Pt,{value:n==null?void 0:n.sizes,setValue:u,ingredients:y,sizeSummary:n==null?void 0:n.sizeSummary,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,setSelectedUpdateSize:o,getProductById:h,mixes:I,onDelete:P,activeTabKey:a,setActiveTabKey:j,onSubmit:b,onChange:z=>u({...n,sizes:z})});case"variation":return e.jsx(Ft,{value:n==null?void 0:n.variations,mode:"view",ingredients:y,onChange:z=>u({...n,variations:z})});default:return null}};return e.jsx(me,{style:{top:T?"3em":""},title:m(t,s,n),open:t,onCancel:()=>{r(!1),u()},footer:null,destroyOnClose:!0,width:T?"100%":600,styles:{gap:"0.5em"},children:s==="view"?A():C()})},An=({categories:t,isMobile:r,selectedCategory:s,setSelectedCategory:l,setIsCategoryModalVisible:n})=>{const u=c.useRef(null),x=c.useRef({}),o=()=>{u.current.scrollBy({left:200,behavior:"smooth"})},h=()=>{u.current.scrollBy({left:-200,behavior:"smooth"})},g=S=>{l(S),x.current[S]&&x.current[S].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})};return e.jsx("div",{style:{padding:"16px",backgroundColor:"#f0f2f5"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(_,{icon:e.jsx(Ts,{}),onClick:o}),e.jsxs("div",{ref:u,style:{display:"flex",overflowX:"auto",flexGrow:1,gap:"8px",padding:"8px 0",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx(_,{type:s==="all"?"primary":"default",onClick:()=>g("all"),children:"הכל"}),t.map(S=>e.jsx(_,{ref:f=>x.current[S._id]=f,type:s===S._id?"primary":"default",onClick:()=>g(S._id),children:S.name},S._id))]}),e.jsx(_,{icon:e.jsx(Fs,{}),onClick:h}),!r&&e.jsx(_,{type:"primary",icon:e.jsx(jt,{}),onClick:()=>n(!0)})]})})};function qn(){var q;const{addProduct:t,updateProduct:r,deleteProduct:s,isModalVisible:l,setIsModalVisible:n,modalMode:u,setModalMode:x,selectedItem:o,setSelectedItem:h}=Bt(),g=Ee({query:"(max-width: 500px)"});c.useRef(null);const[S,f]=c.useState([]),[U,v]=c.useState([]),[P,T]=c.useState("all"),[H,y]=c.useState(!1),[I,i]=c.useState({}),a=V(N=>N.products),j=V(N=>N.categories),w=(q=V(N=>N.ingredients))==null?void 0:q.filter(N=>N==null?void 0:N.is_active),d=["name","category"],m=["name","category","detailes","sizes","productSummary","actions"],b=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"category",dataIndex:"category",title:"קטגוריה"},{key:"profitMargin",dataIndex:"profitMargin",title:"אחוז רווח"}],C=c.useMemo(()=>[{key:"name",dataIndex:"name",title:"שם המוצר",editable:!0,type:"text",rules:[{required:!0,message:"חייב להיות שם מוצר"},{min:2,message:"שם חייב להיות לפחות 2 תווים"}]},{key:"category",dataIndex:"category",title:"קטגוריה",editable:!0,type:"select",render:(N,F)=>{var z;return e.jsx(_e,{children:(z=j==null?void 0:j.find(ne=>ne._id===(F==null?void 0:F.category)))==null?void 0:z.name})},options:j.map(N=>({value:N._id,label:N.name})),rules:[{required:!0,message:"יש לבחור קטגוריה"}]},{key:"detailes",dataIndex:"actions",width:100,render:(N,F)=>e.jsxs(L,{style:{gap:"0.5em"},align:"middle",justify:"center",children:[e.jsx(_e,{className:F!=null&&F.isFeatured?"green":"red",children:F!=null&&F.isFeatured?"פעיל":"לא פעיל"}),e.jsx(_e,{className:F!=null&&F.isOnSale?"blue":"yellow",children:F!=null&&F.isOnSale?"במבצע":"לא במבצע"})]})},{key:"sizes",title:"גדלים",type:"custom",editable:!0,render:(N,F,z="view",ne)=>{var se;return(se=F==null?void 0:F.sizes)==null?void 0:se.length}},{key:"variations",title:"ווריאציות",type:"custom",editable:!0,render:(N,F,z="view",ne)=>{var se;return(se=F==null?void 0:F.variations)==null?void 0:se.length}},{key:"productSummary",dataIndex:"productSummary",title:"אחוז רווח (ממוצע)",width:150,render:(N,F)=>{var z;return`${((z=F==null?void 0:F.productSummary)==null?void 0:z.averageProfitMargin)||0}%`}},{key:"actions",dataIndex:"actions",width:200,render:(N,F)=>e.jsx("div",{className:"",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(_,{type:"text",onClick:()=>{n("size"),h(F)},children:[e.jsx("p",{children:"גדלים"}),e.jsx(O,{icon:We})]})})}],[j]),A=[{name:"קטגוריה",value:"category",type:"select",options:j==null?void 0:j.map(N=>({label:N.name,value:N._id})),filterFunction:(N,F)=>F.includes(N.category)},{name:"סטטוס",value:"isActive",type:"radio",options:[{label:"פעיל",value:!0},{label:"לא פעיל",value:!1}],filterFunction:(N,F)=>F.includes(N.isActive)},{name:"אחוז רווח",value:"profitMargin",type:"range",options:null,filterFunction:(N,F)=>N.profitMargin>=F[0]&&N.profitMargin<=F[1]}];c.useEffect(()=>{const N=JSON.parse(localStorage.getItem("filtersMenu")||"{}");i(N)},[]);const W=N=>{i(N),localStorage.setItem("filtersMenu",JSON.stringify(N))};return c.useEffect(()=>{if(a){const N=P&&P!=="all"?a.filter(F=>F.category===P):a;f(N),v(N)}},[a,P]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",maxWidth:"100%",height:"100%",width:"100%",overflow:"hidden","- webkit - overflow - scrolling":"touch"},children:[e.jsx(An,{categories:j,isMobile:g,selectedCategory:P,setIsCategoryModalVisible:y,setSelectedCategory:T}),e.jsx(D,{flex:1,children:e.jsx(ze,{title:"תפריט",type:"P",data:S,mobileKeys:m,dataPrint:U,sortKeys:b,tableKeys:C,newTitle:"הוסף מוצר חדש",searchKeys:d,setDataPrint:v,onAdd:t,onEdit:r,onDelete:s,ingredientsArr:w,Dtitle:"אישור מחיקה",filters:I,saveFilters:W,filtersArr:A,Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את המוצר?"}),e.jsx("p",{children:"שים לב! מחיקת מוצר עשויה להשפיע על מכירות ותערובות קשורות."})]}),iconADD:e.jsx(O,{icon:Qe}),floatAction:[e.jsx(at,{type:"primary",onClick:()=>y(!0),icon:e.jsx(O,{icon:We})})],openModalProduct:(N,F)=>{n("product"),x(N),F&&h(F)}})}),e.jsx(jn,{isCategoryModalVisible:H,setIsCategoryModalVisible:y}),e.jsx(Nn,{})]})}const Xe="https://menu-server-c2b952e2c698.herokuapp.com/api",Ln=t=>G.post(`${Xe}/suppliers`,t),Rn=t=>{const r=encodeURIComponent(t._id);return G.put(`${Xe}/suppliers/${r}`,t)},Hn=t=>G.delete(`${Xe}/suppliers/${t}`),On=()=>G.get(`${Xe}/suppliers`),Jt=c.createContext(),Un=()=>c.useContext(Jt),Bn=({children:t})=>{const[r,s]=c.useState(!1),l=async x=>{s(!0);try{await Ln(x),M.success("הספק נוסף בהצלחה"),s(!1)}catch(o){console.error("Error adding supplier:",o),M.error("שגיאה בהוספת הספק"),s(!1)}},n=async x=>{s(!0);try{await Rn(x),M.success("הספק עודכן בהצלחה"),s(!1)}catch(o){console.error("Error updating supplier:",o),M.error("שגיאה בעדכון הספק"),s(!1)}},u=async x=>{s(!0);try{await Hn(x),M.success("הספק נמחק בהצלחה"),s(!1)}catch(o){console.error("Error deleting supplier:",o),M.error("שגיאה במחיקת הספק"),s(!1)}};return e.jsx(Jt.Provider,{value:{addSupplier:l,updateSupplier:n,deleteSupplier:u,loading:r},children:t})};function Dn(){const{addSupplier:t,updateSupplier:r,deleteSupplier:s}=Un(),l=V(y=>y.suppliers),n=V(y=>y.ingredients),[u,x]=c.useState([]),[o,h]=c.useState([]),[g,S]=c.useState({}),f=["name"],U=["name","phone","email","contact_name","address",,"second_phone","notes"],v=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים"}],P=[{key:"name",dataIndex:"name",title:"שם הספק",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות שם ספק"},{min:3,message:"שם ספק חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים",editable:!1},{key:"phone",dataIndex:"phone",title:"טלפון",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות מספר טלפון"},{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"email",dataIndex:"email",title:"אימייל",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות אימייל"},{type:"email",message:"אימייל לא תקין"}]},{key:"contact_name",dataIndex:"contact_name",title:"איש קשר",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות איש קשר"},{min:3,message:"איש קשר חייב להיות לפחות 3 תווים"}]},{key:"address",dataIndex:"address",title:"כתובת",editable:!0,type:"text",width:150,rules:[{required:!0,message:"חייבת להיות כתובת"},{min:5,message:"כתובת חייבת להיות לפחות 5 תווים"}]},{key:"second_phone",dataIndex:"second_phone",title:"טלפון נוסף",editable:!0,type:"text",width:100,rules:[{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"notes",dataIndex:"notes",title:"הערות",editable:!0,type:"textArea",maxLength:120,width:150,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}],render:(y,I)=>{const i=(I==null?void 0:I.notes)||"—";return e.jsx(Ye,{title:i,children:e.jsx("span",{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px"},children:i})})}}],T=[{name:"רשימת ספקים",value:"name",type:"select",options:l.map(y=>({label:y.name,value:y.name}))},{name:"סטטוס רכיבים",value:"usedCount",type:"slider",min:0,max:Math.max(...u.map(y=>y.usedCount||0))}];c.useEffect(()=>{if(l){const y=l.map(I=>{const i=n==null?void 0:n.filter(a=>a.supplierId===I._id).length;return{...I,usedCount:i}});x(y),h(y)}},[l,n]),c.useEffect(()=>{const y=JSON.parse(localStorage.getItem("filtersSuppliers")||"{}");S(y)},[]);const H=y=>{S(y),localStorage.setItem("filtersSuppliers",JSON.stringify(y))};return e.jsx(ze,{title:"ספקים",titleView:"ספק",data:u,mobileKeys:U,dataPrint:o,sortKeys:v,tableKeys:P,newTitle:"הוסף ספק חדש",searchKeys:f,setDataPrint:h,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",filters:g,saveFilters:H,filtersArr:T,iconADD:e.jsx(O,{icon:Je}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הספק?"}),e.jsx("p",{children:"שים לב! במחיקת ספק אתה תמחוק את כל הרכיבים שלו וכן הם כמובן ימחקו מכל התערובות והמוצרים."})]})})}const Ze="https://menu-server-c2b952e2c698.herokuapp.com/api",Wn=t=>G.post(`${Ze}/ingredients`,t),Qn=t=>{const r=encodeURIComponent(t._id);return G.put(`${Ze}/ingredients/${r}`,t)},Yn=t=>G.delete(`${Ze}/ingredients/${t}`),Jn=()=>G.get(`${Ze}/ingredients`),zt=c.createContext(),zn=()=>c.useContext(zt),Gn=({children:t})=>{const[r,s]=c.useState(!1),l=async x=>{s(!0);try{await Wn(x),M.success("החומר גלם נוסף בהצלחה"),s(!1)}catch{M.error("שגיאה בהוספת חומר הגלם"),s(!1)}},n=async x=>{s(!0);const o=["unitQuantity","unitDescription","unitPrice","processedPrice"],h=Object.keys(x).filter(g=>!o.includes(g)).reduce((g,S)=>(g[S]=x[S],g),{});try{await Qn(h),M.success("החומר גלם עודכן בהצלחה")}catch{M.error("שגיאה בעדכון חומר הגלם")}finally{s(!1)}},u=async x=>{s(!0);try{await Yn(x),M.success("החומר גלם נמחק בהצלחה"),s(!1)}catch{M.error("שגיאה במחיקת חומר הגלם"),s(!1)}};return e.jsx(zt.Provider,{value:{addIngredient:l,updateIngredient:n,deleteIngredient:u,loading:r},children:t})},{Text:Xn}=Q;function Zn(){const t=V(i=>i.suppliers),r=V(i=>i.ingredients),s=V(i=>i.products),l=V(i=>i.mixes),{addIngredient:n,updateIngredient:u,deleteIngredient:x}=zn(),[o,h]=c.useState([]),[g,S]=c.useState([]),[f,U]=c.useState({});c.useState(!1);const v=["name","type","supplierId"],P=["unit","unitPrice","supplierId","usedInMixes","usedInProducts"],T=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"type",dataIndex:"type",title:"סוג"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"},{key:"unit",dataIndex:"unit",title:"יחידת מידה"},{key:"supplierName",dataIndex:"supplierName",title:"שם ספק"}],H=[{key:"SKU",dataIndex:"SKU",title:'מק"ט',editable:!0,type:"number",width:100,group:1,rules:[{validator:async(i,a,j)=>a?typeof a!="number"?Promise.reject('מק"ט חייב להיות מספר תקין'):a.toString().length===0?Promise.reject('מק"ט חייב להיות מינימום תו אחד '):o.some(d=>d.SKU===a&&d._id!==(j==null?void 0:j._id))?Promise.reject('מק"ט זה כבר קיים במערכת'):Promise.resolve():Promise.resolve()}]},{key:"name",dataIndex:"name",title:"שם",required:!0,editable:!0,group:1,type:"text",width:200,minWidth:200,rules:[{required:!0,message:"השדה חובה"},{min:3,message:"השם חייב להיות לפחות 3 תווים"},{pattern:/^[א-תa-zA-Z\s0-9%-]+$/,message:"השם יכול להכיל אותיות בעברית או אנגלית, מספרים והתווים הבאים: ' % ', ' - '"}]},{key:"supplierId",dataIndex:"supplierId",title:"שם ספק",editable:!0,group:1,type:"select",required:!0,width:100,render:(i,a,j)=>{var w;return e.jsxs(L,{align:"middle",style:{gap:5},children:[j==="view"&&e.jsx(O,{icon:Je})," ",(w=t==null?void 0:t.find(d=>(d==null?void 0:d._id)===(a==null?void 0:a.supplierId)))==null?void 0:w.name]})},options:t==null?void 0:t.map(i=>({value:i._id,label:i==null?void 0:i.name})),rules:[{required:!0,message:"יש לבחור ספק"},{validator:(i,a)=>(t==null?void 0:t.some(w=>w._id===a))?Promise.resolve():Promise.reject("ספק לא חוקי נבחר")}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"is_active",dataIndex:"is_active",title:"פעיל",editable:!0,group:1,type:"custom",render:(i,a,j,w)=>j==="edit"?e.jsx(e.Fragment,{children:e.jsx($.Item,{name:"is_active",label:"פעיל",children:e.jsx(it,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})},"is_active")}):e.jsx(De,{status:a!=null&&a.is_active?"success":"error",text:a!=null&&a.is_active?"פעיל":"לא פעיל"}),minWidth:120,width:120},{key:"type",dataIndex:"type",title:"סוג",render:(i,a)=>{var j;return e.jsx(_e,{color:(j=Ce==null?void 0:Ce.find(w=>w.value===(a==null?void 0:a.type)))==null?void 0:j.color,children:a==null?void 0:a.type})},type:"select",required:!0,editable:!0,group:2,options:Ce.map(i=>({value:i.value,label:i.value,color:i==null?void 0:i.color})),divider:!0,width:100,rules:[{required:!0,message:"יש לבחור סוג"},{validator:(i,a)=>(Ce==null?void 0:Ce.some(w=>w.value===a))?Promise.resolve():Promise.reject("סוג לא חוקי נבחר")}]},{key:"unit",dataIndex:"unit",title:"יחידת מידה",editable:!0,group:2,type:"select",options:fe,width:100,render:(i,a)=>{var j;return e.jsx("p",{children:((j=fe.find(w=>w.value===(a==null?void 0:a.unit)))==null?void 0:j.label)||(a==null?void 0:a.unit)})},rules:[{required:!0,message:"יש לבחור יחידת מידה"},{validator:(i,a)=>(fe==null?void 0:fe.some(w=>w.value===a))?Promise.resolve():Promise.reject("יחידת מידה לא חוקית")}]},{key:"quantity",dataIndex:"quantity",title:"כמות",editable:!0,group:2,type:"custom",width:100,render:(i,a,j,w)=>{if(j=="edit")return e.jsx($.Item,{name:"quantity",label:"כמות",rules:[{required:!0,message:"אנא הזן כמות"},{validator:(b,C)=>(w.getFieldValue("subUnit"),C==null?Promise.reject("כמות נדרשת"):C<0?Promise.reject("הכמות לא יכולה להיות שלילית"):(w.getFieldValue("subUnit")==="g"||w.getFieldValue("subUnit")==="ml")&&(C<.001||C>999)?Promise.reject('עבור גרם או מ"ל הכמות חייבת להיות בין 0.001 ל-999'):(w.getFieldValue("subUnit")==="kg"||w.getFieldValue("subUnit")==="liter")&&(C<1||C>1e6)?Promise.reject('עבור ק"ג או ליטר הכמות חייבת להיות מ-1 ומעלה, ובתוך הטווח המותר'):Promise.resolve())}],children:e.jsx(ue,{style:{width:"100%"}})},"quantity");let d=a.unit,m="";return d==="weight"?m=a.quantity>=1?'ק"ג':"גרם":d==="volume"?m=a.quantity>=1?"ליטר":'מ"ל':d==="units"&&(m="יחידות"),e.jsxs("p",{children:[a.quantity<1?a.quantity*1e3:a.quantity," ",m]})}},{key:"price",dataIndex:"price",title:"מחיר כולל מעמ",editable:!0,group:2,type:"price",width:100,show:!1,divider:!0,render:(i,a,j,w)=>{var d;if(j!=="edit")return e.jsxs("p",{children:["₪",(d=a==null?void 0:a.price)==null?void 0:d.toFixed(2)]})}},{key:"priceExcludingVAT",dataIndex:"priceExcludingVAT",width:100,title:"מחיר ללא מעמ",render:(i,a)=>e.jsxs("p",{children:["₪",a==null?void 0:a.priceExcludingVAT]}),editable:!1,hiddenInForm:!0},{key:"unitPrice",dataIndex:"unitPrice",title:"כמות מינימלית",width:100,render:(i,a)=>e.jsxs(Y,{children:[e.jsxs(L,{children:[e.jsxs("p",{children:[a.unitQuantity<1?a.unitQuantity*1e3:a.unitQuantity," ",a==null?void 0:a.unitDescription]}),e.jsx("br",{})]}),e.jsxs("p",{children:["₪",a==null?void 0:a.unitPrice]})]})},{key:"juiceRatio",dataIndex:"juiceRatio",title:"יחס עיבוד (תפוקת חומר מעובד)",editable:!0,group:2,width:100,type:"custom",render:(i,a,j,w)=>j=="view"||j!=="edit"?e.jsx("p",{children:a!=null&&a.juiceRatio?`${((a==null?void 0:a.juiceRatio)*100).toFixed(0)}%`:""}):e.jsxs(e.Fragment,{children:[e.jsx($.Item,{name:"isJuice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(Be,{onChange:d=>{w.setFieldsValue({isJuice:d.target.checked}),d.target.checked||w.setFieldsValue({juiceRatio:void 0})},children:"האם הרכיב דורש עיבוד?"})}),e.jsx($.Item,{noStyle:!0,shouldUpdate:(d,m)=>d.isJuice!==m.isJuice,children:({getFieldValue:d})=>d("isJuice")&&e.jsx($.Item,{name:"juiceRatio",label:"יחס המיץ (0.1 עד 0.99)",rules:[{required:!0,message:"אנא הזן יחס מיץ"},{type:"number",min:.1,max:.99,message:"היחס חייב להיות בין 0.1 ל-0.99"}],children:e.jsx(ue,{style:{width:"100%"}})})})]})},{key:"processedPrice",dataIndex:"processedPrice",title:"מחיר לכמות מינימלית מעובדת",width:100,render:(i,a)=>e.jsx("p",{children:a!=null&&a.processedPrice?`₪${a==null?void 0:a.processedPrice}`:""}),editable:!1,hiddenInForm:!0},{key:"notes",dataIndex:"notes",title:"הערות",width:100,editable:!0,group:1,render:(i,a)=>{const j=(a==null?void 0:a.notes)||"—";return e.jsx(Ye,{title:j,children:e.jsx(Xn,{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px",direction:"rtl"},children:j})})},type:"textArea",maxLength:120,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}]}],y=[{name:"סוג",value:"type",options:Ce.map(i=>({label:i.value,value:i.value}))},{name:"ספק",value:"supplierId",options:t.map(i=>({label:i.name,value:i._id}))},{name:"סטטוס",value:"is_active",options:[{label:"פעיל",value:!0},{label:"לא פעיל",value:!1}]}];c.useEffect(()=>{if(r)if(t){let i=[...r==null?void 0:r.map(a=>{let j=t==null?void 0:t.find(m=>(m==null?void 0:m._id)===(a==null?void 0:a.supplierId));const w=(s==null?void 0:s.reduce((m,b)=>{var C;return m+((C=b.ingredients)==null?void 0:C.filter(A=>A.ingredientId===a._id).length)},0))||0,d=(l==null?void 0:l.reduce((m,b)=>{var C;return m+((C=b.ingredients)==null?void 0:C.filter(A=>A.ingredientId===a._id).length)},0))||0;return{...a,supplierName:j==null?void 0:j.name,usedCount:w+d}})];h(i),S(i)}else h([...r]),S([...r])},[t,r]),c.useEffect(()=>{const i=JSON.parse(localStorage.getItem("filtersIngredients")||"{}");U(i)},[]);const I=i=>{U(i),localStorage.setItem("filtersIngredients",JSON.stringify(i))};return e.jsx(e.Fragment,{children:e.jsx(ze,{title:"חומרי גלם",titleView:"חומר גלם",type:"ingredient",data:o,groups:!0,mobileKeys:P,dataPrint:g,sortKeys:T,tableKeys:H,newTitle:"הוסף חומר גלם חדש",searchKeys:v,setDataPrint:S,onAdd:n,onEdit:u,onDelete:x,Dtitle:"אישור מחיקה",filters:f,saveFilters:I,filtersArr:y,iconADD:e.jsx(O,{icon:qe}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הרכיב?"}),e.jsx("p",{children:"שים לב! הרכיב יימחק מכל המוצרים והתערובות בהם הוא נמצא."})]})})})}As.register(qs,Ls,Rs,Hs,Os,Us);const{Text:Vn}=Q,Kn=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F"];function er(){const t=V(v=>v.categories),r=V(v=>v.products),s=V(v=>v.suppliers),l=V(v=>v.ingredients),n=V(v=>v.mixes),u=V(v=>v.employees),x=Ee({query:"(max-width: 500px)"}),o=c.useMemo(()=>{const v=r.reduce((P,T)=>{var y;const H=((y=t.find(I=>I._id===T.category))==null?void 0:y.name)||"לא מוגדר";return P[H]=(P[H]||0)+1,P},{});return{labels:Object.keys(v),datasets:[{data:Object.values(v),backgroundColor:Kn}]}},[r,t]),h=c.useMemo(()=>[...l].sort((v,P)=>(P.unitPrice||0)-(v.unitPrice||0)).slice(0,5).map(v=>({name:v.name,price:v.unitPrice})),[l]),g=c.useMemo(()=>[...n].map(v=>{const P=v.totalCost/v.totalWeight;return{name:v.name,costPerLiter:P}}).sort((v,P)=>(P.costPerLiter||0)-(v.costPerLiter||0)).slice(0,5),[n]),S={labels:h.map(v=>v.name),datasets:[{label:"מחיר ל-100 גרם",data:h.map(v=>v.price),backgroundColor:"#FF8042"}]},f={labels:g.map(v=>v.name),datasets:[{label:"עלות לליטר",data:g.map(v=>v.costPerLiter),backgroundColor:"#8884d8"}]},U=c.useMemo(()=>r.filter(v=>v.profitMargin<=90).slice(0,3).map(v=>({key:v._id,name:v.name,profitMargin:v.profitMargin})),[r]);return e.jsxs("div",{className:"dashboard-container",style:{padding:x?"10px":"20px"},children:[e.jsxs(L,{gutter:[5,5],wrap:!0,children:[e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/menu",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle green",children:e.jsx(O,{icon:Qe})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"מוצרים"}),e.jsx("div",{className:"stat-value",children:r.length})]})]})})}),e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/suppliers",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle red",children:e.jsx(O,{icon:Je})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"ספקים"}),e.jsx("div",{className:"stat-value",children:s.length})]})]})})}),e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/ingredients",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle blue",children:e.jsx(O,{icon:qe})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"חומרי גלם"}),e.jsx("div",{className:"stat-value",children:l.length})]})]})})}),e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/menu",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle yellow",children:e.jsx(O,{icon:We})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"קטגוריות"}),e.jsx("div",{className:"stat-value",children:t.length})]})]})})}),e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/mixes",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle purple",children:e.jsx(O,{icon:tt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"תערובות"}),e.jsx("div",{className:"stat-value",children:n.length})]})]})})}),e.jsx(Y,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(xe,{to:"/employees",children:e.jsxs(ae,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle aqua",children:e.jsx(O,{icon:tt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"עובדים"}),e.jsx("div",{className:"stat-value",children:u==null?void 0:u.length})]})]})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(L,{gutter:[16,16],children:[e.jsx(Y,{xs:24,md:12,children:e.jsx(ae,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(O,{icon:We,style:{marginLeft:"8px"}}),"מוצרים לפי קטגוריה"]}),children:e.jsx(Ns,{data:o,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(Y,{xs:24,md:12,children:e.jsx(ae,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(O,{icon:qe,style:{marginLeft:"8px"}}),"חומרי הגלם היקרים ביותר"]}),children:e.jsx(St,{data:S,options:{responsive:!0,maintainAspectRatio:!1}})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(L,{gutter:[16,16],children:[e.jsx(Y,{xs:24,md:12,children:e.jsx(ae,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(O,{icon:tt,style:{marginLeft:"8px"}}),"התערובות היקרות ביותר"]}),children:e.jsx(St,{data:f,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(Y,{xs:24,md:12,children:e.jsx(ae,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(O,{icon:Qe,style:{marginLeft:"8px"}}),"מוצרים עם רווחיות נמוכה"]}),children:e.jsx(L,{gutter:[16,16],children:U.map(v=>e.jsx(Y,{xs:24,sm:8,children:e.jsxs(ae,{children:[e.jsx(Ue,{title:v.name,value:v.profitMargin,suffix:"%",valueStyle:{color:"#cf1322"}}),e.jsx(Vn,{type:"secondary",children:"רווחיות"})]})},v.key))})})})]})]})}const Ve="https://menu-server-c2b952e2c698.herokuapp.com/api",tr=t=>G.post(`${Ve}/mixes`,t),sr=t=>{const r=encodeURIComponent(t._id);return G.put(`${Ve}/mixes/${r}`,t)},nr=t=>G.delete(`${Ve}/mixes/${t}`),rr=()=>G.get(`${Ve}/mixes`),Gt=c.createContext(),ar=()=>c.useContext(Gt),ir=({children:t})=>{const[r,s]=c.useState(!1),l=async x=>{s(!0);try{await tr(x),M.success("התערובת נוספה בהצלחה"),s(!1)}catch(o){console.error("Error adding mix:",o),M.error("שגיאה בהוספת התערובת"),s(!1)}},n=async x=>{s(!0);try{await sr(x),M.success("התערובת עודכנה בהצלחה"),s(!1)}catch(o){console.error("Error updating mix:",o),M.error("שגיאה בעדכון התערובת"),s(!1)}},u=async x=>{s(!0);try{await nr(x),M.success("התערובת נמחקה בהצלחה"),s(!1)}catch(o){console.error("Error deleting mix:",o),M.error("שגיאה במחיקת התערובת"),s(!1)}};return e.jsx(Gt.Provider,{value:{addMix:l,updateMix:n,deleteMix:u,loading:r},children:t})};function lr(){var y;const{addMix:t,updateMix:r,deleteMix:s}=ar(),[l,n]=c.useState([]),[u,x]=c.useState([]),[o,h]=c.useState({}),g=V(I=>I.mixes),S=(y=V(I=>I.ingredients))==null?void 0:y.filter(I=>I.is_active);V(I=>I.products);const f=V(I=>{var i,a;return(a=(i=I.settings.settings)==null?void 0:i.hourlyRate)==null?void 0:a.value}),U=({ingredients:I})=>{const[a,j]=c.useState(!1),w=I.slice(0,2);return I.slice(2).map((m,b)=>e.jsx("div",{style:{marginBottom:"5px"},children:`${m==null?void 0:m.name} (${m.quantity} ${m.unit}) - ₪${m==null?void 0:m.costForQuantity}`},b)),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",alignItems:"center"},children:[e.jsx("span",{style:{color:"blue",cursor:"pointer",fontWeight:"bold",marginLeft:"5px"},onClick:()=>j(!0),children:e.jsx(Es,{style:{fontSize:"16px",color:"#000"}})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",maxWidth:"400px"},children:w.map((m,b)=>e.jsx("span",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",fontSize:"0.7vw"},children:`${m==null?void 0:m.name} (${m.quantity} ${m.unit}) - ₪${m==null?void 0:m.costForQuantity}`},b))}),e.jsx(me,{title:"רשימת מרכיבים",open:a,onCancel:()=>j(!1),footer:[e.jsx(_,{onClick:()=>j(!1),children:"סגור"},"close")],children:I.map((m,b)=>e.jsx("div",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",width:"fit-content",fontSize:"0.7vw",marginBottom:".5vw"},children:`${m==null?void 0:m.name} (${m.quantity} ${m.unit}) - ₪${m==null?void 0:m.costForQuantity}`},b))})]})},v=["name","ingredients"],P=["name","preparationTime","totalCost","totalWeight","usedCount"],T=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה"},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת"},{key:"totalWeight",dataIndex:"totalWeight",title:"משקל כולל"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"}],H=[{key:"name",dataIndex:"name",title:"שם התערובת",editable:!0,type:"text",minWidth:100,rules:[{required:!0,message:"חייב להיות שם תערובת"},{min:3,message:"שם חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה (דקות)",editable:!0,minWidth:100,type:"number",rules:[{required:!0,message:"זמן הכנה נדרש"},{type:"number",min:0,message:"זמן הכנה חייב להיות מספר חיובי"}]},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת (₪)",minWidth:100,render:(I,i)=>(i==null?void 0:i.totalCost)!=null&&(i==null?void 0:i.laborCost)!=null?`₪${(Number(i.totalCost)+Number(i.laborCost)).toFixed(2)}`:"—",editable:!1},{key:"unitCost",dataIndex:"unitCost",title:"עלות ל-100 גרם (₪)",minWidth:100,render:(I,i)=>(i==null?void 0:i.totalWeight)!=null&&(i==null?void 0:i.totalCost)!=null?`₪${((Number(i.totalCost)+Number(i.laborCost||0))/(Number(i.totalWeight)*10)).toFixed(2)} / 100 גרם`:"—",editable:!1},{key:"laborCost",dataIndex:"laborCost",title:"עלות עבודה (₪)",minWidth:100,render:(I,i)=>{var a;return`₪${(a=i==null?void 0:i.laborCost)==null?void 0:a.toFixed(2)} (₪${f})`||"—"},editable:!1},{key:"totalWeight",dataIndex:"totalWeight",title:'משקל כולל (ק"ג)',minWidth:100,render:(I,i)=>{var a;return((a=i.totalWeight)==null?void 0:a.toFixed(2))||"—"},editable:!1},{key:"ingredients",title:"רכיבים",type:"ingredientsManager",editable:!0,width:500,minWidth:500,column:!0,fields:[{key:"ingredientId",type:"select",title:"רכיב",placeholder:"בחר רכיב",options:S.map(I=>({value:I._id,label:I.name})),required:!0,rules:[{required:!0,message:"יש לבחור רכיב"}]},{key:"quantity",type:"number",title:"כמות",placeholder:"הזן כמות",required:!0,rules:[{required:!0,message:"יש להזין כמות"},{type:"number",min:0,message:"כמות חייבת להיות חיובית"}]},{key:"unit",type:"text",title:"יחידה",readonly:!0}],render:(I,i,a,j)=>{let w=[...(i==null?void 0:i.ingredients)||[]].sort((d,m)=>m.quantity-d.quantity);return w=w==null?void 0:w.map(d=>{var m;return{name:d==null?void 0:d.ingredientData.name,quantity:((d==null?void 0:d.rawQuantityForJuice)||d.quantity)<1&&d.unit!=="units"?((d==null?void 0:d.rawQuantityForJuice)||d.quantity)*100:(d==null?void 0:d.rawQuantityForJuice)||d.quantity,unit:(m=fe==null?void 0:fe.find(b=>b.value===d.unit))==null?void 0:m.display((d==null?void 0:d.rawQuantityForJuice)||d.quantity),costForQuantity:d==null?void 0:d.costForQuantity}}),j?e.jsx("ul",{style:{display:"flex",flexDirection:"column",gap:"5px",padding:0,margin:0,listStyleType:"none"},children:w==null?void 0:w.map((d,m)=>e.jsxs("li",{style:{whiteSpace:"normal",display:"flex"},children:[e.jsx(Ye,{title:d==null?void 0:d.name,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:d==null?void 0:d.name})}),` (${d.quantity} ${d.unit}) - ₪${d==null?void 0:d.costForQuantity}`]},m))}):e.jsx(U,{ingredients:w})},rules:[{required:!0,message:"יש לבחור לפחות רכיב אחד"}]}];return S==null||S.map(I=>({label:I.name,value:I._id})),c.useEffect(()=>{g&&(n(g),x(g))},[g,S,f]),c.useEffect(()=>{const I=JSON.parse(localStorage.getItem("filtersMenu")||"{}");h(I)},[]),e.jsx(ze,{title:"מיקסים",titleView:"מיקס",type:"mix",data:l,mobileKeys:P,dataPrint:u,sortKeys:T,tableKeys:H,newTitle:"הוסף תערובת חדשה",searchKeys:v,setDataPrint:x,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",ingredientsArr:S,iconADD:e.jsx(O,{icon:ht}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את התערובת?"}),e.jsx("p",{children:"שים לב! מחיקת תערובת עשויה להשפיע על מוצרים המשתמשים בה."})]})})}const{Text:or}=Q,{Option:Oe}=oe,Xt=({addEmployee:t,initialValues:r,onClose:s})=>{const[l]=$.useForm(),n=V(h=>h.employees),[u,x]=c.useState("");c.useEffect(()=>{r&&l.setFieldsValue(r)},[r,l]);const o=h=>{if(n.some(g=>g.name===h.name.trim()&&(!r||g._id!==r._id))){x("קיים כבר עובד בעל שם דומה");return}t({...r,...h}),l.resetFields(),s()};return e.jsx(ae,{className:"employee-form-card",children:e.jsxs($,{form:l,layout:"vertical",onFinish:o,initialValues:r,children:[e.jsx($.Item,{label:"שם עובד",name:"name",rules:[{required:!0,message:"אנא הזן שם עובד"}],children:e.jsx(de,{})}),e.jsx($.Item,{label:"תפקיד",name:"position",children:e.jsx(de,{placeholder:"הזן תפקיד"})}),e.jsx($.Item,{label:"תעריף שעתי",name:"hourlyRate",rules:[{required:!0,message:"אנא הזן תעריף שעתי"}],children:e.jsx(ue,{min:0,style:{width:"100%"}})}),e.jsx($.Item,{label:"סטטוס",name:"status",initialValue:"active",rules:[{required:!0}],children:e.jsxs(oe,{children:[e.jsx(Oe,{value:"active",children:"פעיל"}),e.jsx(Oe,{value:"inactive",children:"לא פעיל"}),e.jsx(Oe,{value:"on_leave",children:"בחופשה"}),e.jsx(Oe,{value:"terminated",children:"סיים העסקה"})]})}),u&&e.jsx(gs,{style:{display:"block",marginBottom:"10px"},children:e.jsx(or,{type:"danger",className:"error-message",children:u})}),e.jsxs($.Item,{children:[e.jsx(_,{type:"primary",htmlType:"submit",className:"employee-form-button",children:r?"עדכן עובד":"הוסף עובד"}),e.jsx(_,{className:"employee-form-button",onClick:s,style:{marginLeft:"8px"},children:"ביטול"})]})]})})},Ke="https://menu-server-c2b952e2c698.herokuapp.com/api",dr=t=>G.post(`${Ke}/employees`,t),cr=t=>{const r=encodeURIComponent(t._id);return G.put(`${Ke}/employees/${r}`,t)},ur=t=>G.delete(`${Ke}/employees/${t}`),xr=(t,r)=>G.get(`${Ke}/employees?`),Zt=c.createContext(),Vt=()=>c.useContext(Zt),pr=({children:t})=>{const[r,s]=c.useState(!1),l=async x=>{s(!0);try{await dr(x),M.success("העובד נוסף בהצלחה"),s(!1)}catch(o){console.error("Error adding employee:",o),M.error("שגיאה בהוספת עובד"),s(!1)}},n=async x=>{s(!0);try{await cr(x),M.success("העובד עודכן בהצלחה"),s(!1)}catch(o){console.error("Error updating employee:",o),M.error("שגיאה בעדכון עובד"),s(!1)}},u=async x=>{s(!0);try{await ur(x),M.success("העובד נמחק בהצלחה"),s(!1)}catch(o){console.error("Error deleting employee:",o),M.error("שגיאה במחיקת עובד"),s(!1)}};return e.jsx(Zt.Provider,{value:{addEmployee:l,updateEmployee:n,deleteEmployee:u,loading:r},children:t})},{Text:st}=Q,hr=({sortKey:t})=>{const{updateEmployee:r,deleteEmployee:s}=Vt(),l=V(f=>f.employees),[n,u]=c.useState(!1),[x,o]=c.useState(null),h=f=>{o(f),u(!0)},g=()=>{o(null),u(!1)},S=[...l].sort((f,U)=>t==="name"?f.name.localeCompare(U.name):0);return e.jsxs(ae,{title:"רשימת עובדים",className:"employee-list-card",children:[e.jsx(ie,{itemLayout:"vertical",dataSource:S,renderItem:f=>e.jsx(ie.Item,{className:"employee-item",actions:[e.jsx(_,{type:"link",onClick:()=>h(f),children:"ערוך"}),e.jsx(xt,{title:"האם אתה בטוח שברצונך למחוק את העובד הנוכחי?",onConfirm:()=>s(f._id),okText:"כן",cancelText:"לא",children:e.jsx(_,{icon:e.jsx(Fe,{}),danger:!0})})],children:e.jsx(ie.Item.Meta,{title:e.jsx(st,{strong:!0,children:f.name}),description:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(st,{strong:!0,children:"תפקיד:"})," ",f.position||"לא הוגדר"]}),e.jsxs("p",{children:[e.jsx(st,{strong:!0,children:"תעריף שעתי:"})," ",f.hourlyRate," ₪"]}),e.jsx("p",{children:e.jsx(De,{color:gr(f.status),text:mr(f.status),style:{marginLeft:"8px"}})})]})})},f._id)}),e.jsx(me,{title:x?"ערוך עובד":"הוסף עובד חדש",open:n,onCancel:g,footer:null,children:e.jsx(Xt,{addEmployee:r,initialValues:x,onClose:g})})]})},mr=t=>{switch(t){case"active":return"פעיל";case"inactive":return"לא פעיל";case"on_leave":return"בחופשה";case"terminated":return"סיים העסקה";default:return"לא ידוע"}},gr=t=>{switch(t){case"active":return"green";case"inactive":return"grey";case"on_leave":return"orange";case"terminated":return"red";default:return"blue"}};function jr(){const{addEmployee:t}=Vt(),[r,s]=c.useState(!1),[l,n]=c.useState(""),u=()=>{s(!0)},x=()=>{s(!1)};return e.jsxs("div",{style:{padding:"20px"},className:"scrollable-content employees-page-container",children:[e.jsxs("div",{className:"employees-controls",children:[e.jsx(_,{type:"primary",onClick:u,className:"add-employee-button",children:"הוסף עובד חדש"}),e.jsxs(oe,{value:l,onChange:o=>n(o),className:"sort-select",children:[e.jsx(oe.Option,{value:"",children:"מיין"}),e.jsx(oe.Option,{value:"name",children:"מיין לפי שם"})]})]}),e.jsx(hr,{sortKey:l}),e.jsx(me,{title:"הוסף עובד חדש",open:r,onCancel:x,footer:null,destroyOnClose:!0,children:e.jsx(Xt,{addEmployee:t,onClose:x})})]})}const Re="https://menu-server-c2b952e2c698.herokuapp.com/api",yr=(t,r)=>G.post(`${Re}/employees/${t}/hours`,r),fr=(t,r)=>G.put(`${Re}/employees/hours/${t}`,r),vr=t=>G.delete(`${Re}/employees/hours/${t}`),wr=t=>G.get(`${Re}/employees/${t}/hours`),Sr=(t,r)=>G.get(`${Re}/employees/hours/${r}/${t}`),Kt=c.createContext(),Cr=()=>c.useContext(Kt),br=({children:t})=>{const[r,s]=c.useState(!1),l=async(o,h)=>new Promise(async(g,S)=>{var f;s(!0);try{const U=await yr(o,h);if((U==null?void 0:U.status)===200){M.error((f=U.data)==null?void 0:f.message),S(!1);return}M.success("שעות העבודה נוספו בהצלחה"),g(!0)}catch(U){console.error("Error adding employee hours:",U),M.error("שגיאה בהוספת שעות עבודה"),S(!1)}finally{s(!1)}}),n=async(o,h)=>new Promise(async(g,S)=>{s(!0);try{(await fr(o,h)).status!==201?S(!1):(M.success("שעות העבודה עודכנו בהצלחה"),g(!0))}catch(f){console.error("Error updating employee hours:",f),M.error("שגיאה בעדכון שעות עבודה"),S(!1)}finally{s(!1)}}),u=async o=>{s(!0);try{const h=await wr(o);return M.success("שעות העבודה נשלפו בהצלחה"),h.data}catch(h){console.error("Error fetching employee hours:",h),M.error("שגיאה בשליפת שעות עבודה")}finally{s(!1)}},x=async o=>{s(!0);try{await vr(o),M.success("שעות העבודה נמחקו בהצלחה")}catch(h){console.error("Error deleting employee hours:",h),M.error("שגיאה במחיקת שעות עבודה")}finally{s(!1)}};return e.jsx(Kt.Provider,{value:{loading:r,addEmployeeHours:l,updateEmployeeHours:n,deleteEmployeeHours:x,fetchEmployeeHours:u},children:t})},{Option:Ir}=oe,kr=({visible:t,onClose:r,dayData:s})=>{const{addEmployeeHours:l,updateEmployeeHours:n,deleteEmployeeHours:u}=Cr(),x=V(i=>i.employees),[o,h]=c.useState(),[g,S]=c.useState(),[f,U]=c.useState(!1),[v]=$.useForm();if(!s)return null;const P=()=>{const i=f?n:l,a=f?g:o;i(f?a==null?void 0:a.hoursId:a.employeeId,a).then(()=>{h(),U(!1),v.resetFields()}).catch(()=>{})},T=i=>{S({...i,employeeId:i.employeeId,startTime:i.hours.start,endTime:i.hours.end,date:s.date}),U(!0)},H=()=>{h(null),U(!1)},y=i=>{u(i)},I=x==null?void 0:x.filter(i=>!s.employees.some(a=>a.employeeId===i._id));return e.jsxs(me,{title:`ניהול שעות עבודה ליום ${s.date}`,open:t,onCancel:r,footer:null,width:800,style:{top:"1em"},destroyOnClose:!0,children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"סיכום יום"}),e.jsxs("p",{children:["תאריך: ",s.date]}),e.jsxs("p",{children:["יום בשבוע: ",s.dayOfWeek]}),e.jsx(_e,{color:(s==null?void 0:s.status)==="חצי יום"?"orange":"green",children:s==null?void 0:s.status})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:f?"עריכת עובד":"הוספת עובד חדש"}),e.jsx($,{form:v,layout:"vertical",onFinish:P,children:e.jsx($.Item,{label:"בחר עובד",style:{maxWidth:"400px"},children:e.jsx(oe,{showSearch:!0,placeholder:"חיפוש והוספת עובד",optionFilterProp:"children",value:(o==null?void 0:o.employeeId)||null,onChange:i=>{const a=I.find(j=>j._id===i);h({name:a==null?void 0:a.name,startTime:"",endTime:"",date:s==null?void 0:s.date,employeeId:a._id})},filterOption:(i,a)=>a.children.toLowerCase().includes(i.toLowerCase()),children:I==null?void 0:I.map(i=>e.jsx(Ir,{value:i._id,children:i.name},i._id))})})})]}),e.jsx(Z,{}),o&&e.jsxs($,{layout:"inline",onFinish:P,initialValues:{startTime:o==null?void 0:o.startTime,endTime:o==null?void 0:o.endTime},children:[e.jsx($.Item,{label:"שעת כניסה",children:e.jsx(de,{placeholder:"HH:mm",value:o==null?void 0:o.startTime,onChange:i=>h(a=>({...a,startTime:i.target.value}))})}),e.jsx($.Item,{label:"שעת יציאה",children:e.jsx(de,{placeholder:"HH:mm",value:o==null?void 0:o.endTime,onChange:i=>h(a=>({...a,endTime:i.target.value}))})}),!(o!=null&&o._id)&&e.jsx(_,{type:"primary",onClick:P,children:"שמור שעות עבודה"})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"עובדים שנוספו"}),e.jsx(ie,{bordered:!0,className:"scroll-content",style:{maxHeight:"25em",overflow:"auto"},dataSource:s==null?void 0:s.employees,renderItem:i=>{var a,j,w;return e.jsx(ie.Item,{children:e.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{fontWeight:"500",width:"6em"},children:i.name}),f&&i.employeeId===(g==null?void 0:g.employeeId)?e.jsxs(e.Fragment,{children:[e.jsx(de,{placeholder:"שעת כניסה",value:g==null?void 0:g.startTime,onChange:d=>S(m=>({...m,startTime:d.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsx(de,{placeholder:"שעת יציאה",value:g==null?void 0:g.endTime,onChange:d=>S(m=>({...m,endTime:d.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsxs(L,{style:{gap:"0.5em"},children:[e.jsx(_,{type:"primary",icon:e.jsx($s,{}),onClick:P}),e.jsx(_,{icon:e.jsx(mt,{}),onClick:H,style:{marginLeft:"5px"}})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{title:"כניסה",value:(a=i==null?void 0:i.hours)==null?void 0:a.start}),e.jsx(Ue,{title:"יציאה",value:(j=i==null?void 0:i.hours)==null?void 0:j.end}),e.jsx(Ue,{title:"סך שעות",value:(w=i==null?void 0:i.hoursWorked)==null?void 0:w.toFixed(2)}),e.jsxs(L,{style:{gap:"0.5em"},children:[e.jsx(_,{icon:e.jsx(gt,{}),onClick:()=>T(i)}),e.jsx(xt,{title:"האם אתה בטוח שברצונך למחוק את העובד?",onConfirm:()=>y(i.hoursId),okText:"כן",cancelText:"לא",children:e.jsx(_,{icon:e.jsx(Fe,{}),danger:!0})})]})]})]})})}})]})]})},_r=({monthData:t})=>{const[r,s]=c.useState(!1),[l,n]=c.useState(null),u=h=>{n(h),s(!0)},x=[{title:"תאריך",dataIndex:"date",key:"date"},{title:"יום בשבוע",dataIndex:"dayOfWeek",key:"dayOfWeek"},{title:"סטטוס",dataIndex:"status",key:"status",render:h=>e.jsx(_e,{color:h==="חצי יום"?"orange":"green",children:h})},{title:"מספר עובדים",dataIndex:"employeesCount",key:"employeesCount",render:h=>h??"לא ידוע"},{title:"סך הכל שעות",dataIndex:"totalHours",key:"totalHours",render:h=>(h==null?void 0:h.toFixed(2))??"לא ידוע"}],o=h=>{let g="";return h!=null&&h.hasError&&(g+="workhours-error "),h.isToday?g+="today-row":h.isPast&&(g+="past-row"),g};return e.jsxs(e.Fragment,{children:[e.jsx(Nt,{columns:x,dataSource:t,rowKey:"date",pagination:!1,rowClassName:o,onRow:(h,g)=>({onClick:()=>(h.isToday||h.isPast)&&u(g)})}),e.jsx(kr,{visible:r,onClose:()=>s(!1),dayData:t[l]})]})},{MonthPicker:Pr}=js;we.locale("he");const Tr=()=>{const t=Le(),r=V(n=>n.employeeHours.data),s=V(n=>n.employeeHours.selectedDate),l=n=>{t(kn(n.format("YYYY-MM")))};return e.jsxs("div",{className:"workhours-container",children:[e.jsx("h1",{children:"ניהול שעות עבודה חודשיות"}),e.jsx(Pr,{onChange:l,placeholder:"בחר חודש ושנה",disabledDate:n=>n&&n>we().endOf("month")},s),e.jsx(_r,{monthData:r})," "]})},es=Se({name:"suppliers",initialState:[],reducers:{addSuppliersState:(t,r)=>r.payload,addOrUpdateSupplierState:(t,r)=>{const s=r.payload,l=t.findIndex(n=>n._id===s._id);l!==-1?t[l]=s:t.unshift(s)},updateSupplierState:(t,r)=>{const s=r.payload;return t.map(l=>l._id===s._id?s:l)},deleteSupplierState:(t,r)=>{const s=r.payload._id;return t.filter(l=>l._id!==s)}}}),{addSuppliersState:Fr,addOrUpdateSupplierState:Er,updateSupplierState:$r,deleteSupplierState:Mr}=es.actions,Nr=es.reducer;function nt(t){let r,s,l,n;const u=t.price/1.17;return t.unit==='ק"ג'||t.unit==="weight"?(r=.1,s="גרם",l=u/t.quantity*r):t.unit==="ליטר"||t.unit==="volume"?(r=.1,s='מ"ל',l=u/t.quantity*r):(t.unit==="יחידות"||t.unit==="units")&&(r=1,s="יחידה",l=u/t.quantity),t.isJuice&&(n=l/(t.juiceRatio||1)),{...t,priceExcludingVAT:u.toFixed(2),unitQuantity:r,unitDescription:s,unitPrice:l.toFixed(2),processedPrice:n?n.toFixed(2):null}}const ts=Se({name:"ingredients",initialState:[],reducers:{addIngerdientsState:(t,r)=>r.payload.map(nt),addOrUpdateIngredientState:(t,r)=>{const s=nt(r.payload),l=t.findIndex(n=>n._id===s._id);l!==-1?t[l]=s:t.unshift(s)},updateIngredientState:(t,r)=>{const s=nt(r.payload);return t.map(l=>l._id===s._id?s:l)},deleteIngredientState:(t,r)=>{const s=r.payload._id;return t.filter(l=>l._id!==s)}}}),{addIngerdientsState:Ar,addOrUpdateIngredientState:qr,updateIngredientState:Lr,deleteIngredientState:Rr}=ts.actions,Hr=ts.reducer,ss=Se({name:"mixes",initialState:[],reducers:{setMixesState:(t,r)=>{const{mixes:s,ingredientsState:l}=r.payload;return s},addOrUpdateMixState:(t,r)=>{const{newMix:s,ingredientsState:l}=r.payload,n=s,u=t.findIndex(x=>x._id===s._id);u!==-1?t[u]=n:t.unshift(n)},updateMixState:(t,r)=>{const{updatedMix:s,ingredientsState:l}=r.payload,n=s,u=t.findIndex(x=>x._id===s._id);u!==-1&&(t[u]=n)},deleteMixState:(t,r)=>t.filter(s=>s._id!==r.payload._id)}}),{setMixesState:Or,addOrUpdateMixState:Ur,updateMixState:Br,deleteMixState:Dr}=ss.actions,Wr=ss.reducer,ns=Se({name:"categories",initialState:[],reducers:{setCategories:(t,r)=>r.payload,addOrUpdateCategory:(t,r)=>{const s=r.payload,l=t.findIndex(n=>n._id===s._id);l!==-1?t[l]=s:t.unshift(s)},updateCategory:(t,r)=>{const s=r.payload,l=t.findIndex(n=>n._id===s._id);l!==-1&&(t[l]=s)},deleteCategory:(t,r)=>{const s=r.payload;return t.filter(l=>l._id!==s)}}}),{setCategories:Qr,addOrUpdateCategory:Yr,updateCategory:Jr,deleteCategory:zr}=ns.actions,Gr=ns.reducer,rs=Se({name:"employees",initialState:[],reducers:{setEmployees:(t,r)=>r.payload,addOrUpdateEmployee:(t,r)=>{const s=r.payload,l=t.findIndex(n=>n._id===s._id);l!==-1?t[l]=s:t.push(s)},updateEmployee:(t,r)=>{const s=r.payload,l=t.findIndex(n=>n._id===s._id);l!==-1&&(t[l]=s)},deleteEmployee:(t,r)=>t.filter(s=>s._id!==r.payload)}}),{setEmployees:Xr,addOrUpdateEmployee:Zr,updateEmployee:Vr,deleteEmployee:Kr}=rs.actions,ea=rs.reducer,ta=(t,r)=>{t.on("ingredientAdded",s=>{r(qr(s))}),t.on("ingredientUpdated",s=>{r(Lr(s))}),t.on("ingredientDeleted",s=>{r(Rr(s))}),t.on("supplierAdded",s=>{r(Er(s))}),t.on("supplierUpdated",s=>{r($r(s))}),t.on("supplierDeleted",s=>{r(Mr(s))}),t.on("productAdded",s=>{r((l,n)=>{const u=n().ingredients,x=n().mixes;l(dt({newProduct:s,ingredientsState:u,mixesState:x}))})}),t.on("productUpdated",s=>{r((l,n)=>{const u=n().ingredients,x=n().mixes;l(dt({newProduct:s,ingredientsState:u,mixesState:x}))})}),t.on("productDeleted",s=>{r(Tn(s))}),t.on("categoryAdded",s=>{r(Yr(s))}),t.on("categoryUpdated",s=>{r(Jr(s))}),t.on("categoryDeleted",s=>{r(zr(s._id))}),t.on("mixAdded",s=>{r((l,n)=>{const u=n().ingredients;l(Ur({newMix:s,ingredientsState:u}))})}),t.on("mixUpdated",s=>{r((l,n)=>{const u=n().ingredients;l(Br({updatedMix:s,ingredientsState:u}))})}),t.on("mixDeleted",s=>{r(Dr(s))}),t.on("employeeAdded",s=>{r(Zr(s))}),t.on("employeeUpdated",s=>{r(Vr(s))}),t.on("employeeDeleted",s=>{r(Kr(s._id))}),t.on("employeeHoursAdded",s=>{r(Cn(s))}),t.on("employeeHoursUpdated",s=>{r(bn(s))}),t.on("employeeHoursDeleted",s=>{r(In({_id:s._id}))})},$t="https://menu-server-c2b952e2c698.herokuapp.com/",sa=c.createContext(),na=({children:t})=>{const r=Le();return console.log($t),c.useEffect(()=>{const s=Ds($t);return ta(s,r),()=>s.disconnect()},[r]),e.jsx(sa.Provider,{value:{},children:t})},He="https://menu-server-c2b952e2c698.herokuapp.com/api",ra=()=>G.get(`${He}/settings`),aa=(t,r)=>{const s=encodeURIComponent(t);return G.put(`${He}/settings/${s}`,{value:r})},ia=t=>G.post(`${He}/settings/categories`,t),la=(t,r)=>G.put(`${He}/settings/categories/${t}`,r),oa=t=>G.delete(`${He}/settings/categories/${t}`),as=Se({name:"settings",initialState:{settings:null,loading:!1},reducers:{setSettings:(t,r)=>{t.settings=r.payload},updateSettingValue:(t,r)=>{const{key:s,value:l}=r.payload;t.settings&&t.settings[s]&&(t.settings[s].value=l,t.settings[s].lastUpdated=new Date().toISOString())},addCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value.push(s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},updateCategory:(t,r)=>{const s=r.payload;if(t.settings&&t.settings.materialCategories){const l=t.settings.materialCategories.value.findIndex(n=>n._id===s._id);l!==-1&&(t.settings.materialCategories.value[l]=s,t.settings.materialCategories.lastUpdated=new Date().toISOString())}},deleteCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value=t.settings.materialCategories.value.filter(l=>l._id!==s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},setLoading:(t,r)=>{t.loading=r.payload}}}),{setSettings:da,updateSettingValue:ca,addCategory:Wi,updateCategory:Qi,deleteCategory:Yi,setLoading:ye}=as.actions,ua=as.reducer,is=c.createContext(),xa=()=>c.useContext(is),pa=({children:t})=>{const r=Le(),{settings:s,loading:l}=V(g=>g.settings),n=async()=>{r(ye(!0));try{const{data:g}=await ra();r(da(g))}catch(g){console.error("Error fetching settings:",g)}finally{r(ye(!1))}},u=async(g,S)=>{r(ye(!0));try{await aa(g,S),r(ca({key:g,value:S})),M.success("הערך עודכן בהצלחה")}catch(f){console.error("Error updating setting:",f),M.error("שגיאה בעדכון ההגדרה")}finally{r(ye(!1))}},x=async g=>{r(ye(!0));try{const{data:S}=await ia(g);r(x(S)),M.success("הקטגוריה נוספה בהצלחה")}catch(S){console.error("Error adding category:",S),M.error("שגיאה בהוספת הקטגוריה")}finally{r(ye(!1))}},o=async(g,S)=>{r(ye(!0));try{await la(g,S),r(o(S)),M.success("הקטגוריה עודכנה בהצלחה")}catch(f){console.error("Error updating category:",f),M.error("שגיאה בעדכון הקטגוריה")}finally{r(ye(!1))}},h=async g=>{r(ye(!0));try{await oa(g),r(h(g)),M.success("הקטגוריה נמחקה בהצלחה")}catch(S){console.error("Error deleting category:",S),M.error("שגיאה במחיקת הקטגוריה")}finally{r(ye(!1))}};return c.useEffect(()=>{n()},[]),e.jsx(is.Provider,{value:{settings:s,loading:l,fetchSettings:n,updateSetting:u,addCategory:x,updateCategory:o,deleteCategory:h},children:t})};M.config({prefixCls:"my-message"});const ha=({children:t,setLoading:r})=>{const s=Le(),l=V(u=>u.employeeHours.selectedDate),n=V(u=>{var x,o;return(o=(x=u.settings.settings)==null?void 0:x.hourlyRate)==null?void 0:o.value});return c.useEffect(()=>{(async()=>{var h,g;r(!0);const x=wt(l).year(),o=wt(l).month()+1;try{const[S,f,U,v,P,T,H]=await Promise.all([Jn(),On(),Gs(),pn(),rr(),xr(),Sr(o,x)]);s(Ar((h=S==null?void 0:S.data)==null?void 0:h.reverse())),s((y,I)=>{var a;const i=I().ingredients;y(Or({mixes:(a=P==null?void 0:P.data)==null?void 0:a.reverse(),ingredientsState:i}))}),s((y,I)=>{var j;const i=I().ingredients,a=I().mixes;y(Pn({products:(j=U.data)==null?void 0:j.reverse(),ingredientsState:i,mixesState:a,averageHourlyRate:n}))}),s(Qr(v.data)),s(Fr((g=f==null?void 0:f.data)==null?void 0:g.reverse())),s(Xr(T.data)),s(wn({selectedDate:l,employees:T.data,employeeHours:H==null?void 0:H.data})),r(!1)}catch(S){console.error("Error fetching data:",S),r(!1)}})()},[s,r,l]),e.jsx(na,{children:e.jsx(Gn,{children:e.jsx(Bn,{children:e.jsx(nn,{children:e.jsx(ir,{children:e.jsx(mn,{children:e.jsx(pr,{children:e.jsx(br,{children:e.jsx(pa,{children:t})})})})})})})})})},ct="/assets/logo-Ha-8mVYV.png";function ma({flag:t,setFlag:r}){var y,I;const{settings:s,fetchSettings:l,addCategory:n,updateCategory:u,deleteCategory:x}=xa(),[o,h]=c.useState([]),[g,S]=c.useState(null),[f]=$.useForm(),[U,v]=c.useState(!1);c.useEffect(()=>{t&&l()},[t]),c.useEffect(()=>{var i;s&&h(((i=s==null?void 0:s.materialCategories)==null?void 0:i.value)||[])},[s]);const P=async()=>{try{const i=await f.validateFields();if(console.log("Saving Category:",i),g===null)await n(i),M.success("קטגוריה נוספה בהצלחה");else{const a={...o[g],...i};console.log("Updating Category:",a),await u(o[g]._id,a),M.success("קטגוריה עודכנה בהצלחה")}f.resetFields(),S(null),v(!1)}catch(i){console.error("Failed to save category:",i),M.error("שגיאה בשמירת הקטגוריה. נסה שוב.")}},T=()=>{f.resetFields(),S(null),v(!1)},H=async i=>{await x(i),M.success("קטגוריה נמחקה בהצלחה")};return e.jsx(me,{open:t,title:"ניהול קטגוריות",centered:!0,width:800,footer:null,onCancel:()=>r(!1),children:e.jsxs("div",{children:[U||g!==null?e.jsxs($,{form:f,layout:"vertical",style:{marginBottom:"1em"},children:[e.jsx($.Item,{name:"name",label:"שם קטגוריה",rules:[{required:!0,message:"יש להזין שם קטגוריה"}],initialValue:g!==null?(y=o[g])==null?void 0:y.name:"",children:e.jsx(de,{placeholder:"הזן שם קטגוריה"})}),e.jsx($.Item,{name:"description",label:"תיאור קטגוריה",initialValue:g!==null?(I=o[g])==null?void 0:I.description:"",children:e.jsx(de.TextArea,{placeholder:"הזן תיאור קטגוריה",rows:3})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(_,{type:"primary",onClick:P,children:[e.jsx(O,{icon:Pe,style:{marginRight:"5px"}}),"שמור"]}),e.jsxs(_,{type:"default",onClick:T,children:[e.jsx(O,{icon:Te,style:{marginRight:"5px"}}),"בטל"]})]})]}):e.jsx(_,{type:"dashed",onClick:()=>{v(!0),f.resetFields()},block:!0,children:"הוסף קטגוריה חדשה"}),e.jsx(Z,{}),e.jsx(ie,{dataSource:o,renderItem:(i,a)=>e.jsx(ie.Item,{actions:[e.jsx(_,{type:"text",icon:e.jsx(O,{icon:Me}),onClick:()=>{S(a),f.setFieldsValue({name:i.name,description:i.description})}}),e.jsx(_,{type:"text",icon:e.jsx(O,{icon:$e}),onClick:()=>H(i._id)})],children:g!==a?e.jsx(ie.Item.Meta,{title:i.name,description:i.description}):null}),style:{maxHeight:"300px",overflowY:"auto"}})]})})}function ga({drawerVisible:t,setDrawerVisible:r,isMobile:s}){const[l,n]=c.useState(!1);return e.jsxs("div",{className:"top-bar",children:[e.jsx(xe,{to:"/",children:e.jsx(lt,{className:"logo-mobile",src:ct,alt:"GainGuard",preview:!1})}),e.jsxs("div",{children:[s&&e.jsx("button",{className:"menu-button",onClick:()=>r(!t),children:e.jsx(O,{icon:Is})}),e.jsx(ma,{flag:l,setFlag:()=>n(!1)})]})]})}const{Header:ja,Content:ya,Footer:fa}=qt;function va(){const[t,r]=c.useState(!1),[s,l]=c.useState(!1),n=Ee({query:"(max-width: 1200px)"});return e.jsxs(ha,{setLoading:l,children:[e.jsx(ys,{fullscreen:!0,spinning:s,size:"large"}),e.jsx(Bs,{children:e.jsxs(qt,{className:"app-container",style:{minHeight:n?"85vh":"100vh"},children:[e.jsxs("div",{className:"nav-container",children:[e.jsx("div",{className:"nav-top",children:e.jsx(lt,{className:"logo",src:ct,alt:"GainGuard",preview:!1})}),e.jsx(Mt,{})]}),e.jsxs("div",{className:"body-container",children:[e.jsxs(ja,{className:"header",style:{padding:"0 20px"},children:[e.jsx(ga,{isMobile:n,drawerVisible:t,setDrawerVisible:r}),e.jsx(Z,{className:"no-margin"})]}),e.jsx(ya,{className:"content",children:e.jsxs(Ws,{children:[e.jsx(ke,{path:"/",element:e.jsx(er,{})}),e.jsx(ke,{path:"/menu",element:e.jsx(qn,{})}),e.jsx(ke,{path:"/suppliers",element:e.jsx(Dn,{})}),e.jsx(ke,{path:"/mixes",element:e.jsx(lr,{})}),e.jsx(ke,{path:"/ingredients",element:e.jsx(Zn,{})}),e.jsx(ke,{path:"/employees",element:e.jsx(jr,{})}),e.jsx(ke,{path:"/work-hours",element:e.jsx(Tr,{})})]})}),e.jsx(fa,{className:"footer",children:"© 2024 מערכת ניהול תפריט ועץ מוצר"})]}),e.jsx(At,{title:e.jsxs(Y,{children:[e.jsx(lt,{className:"logo",src:ct,alt:"GainGuard",preview:!1}),e.jsx("p",{children:"ניווט"})]}),placement:"right",closable:!0,onClose:()=>r(!1),open:t,width:300,children:e.jsx(Mt,{onClose:()=>r(!1)})})]})})]})}function Mt({onClose:t}){const r=Qs(),s=l=>r.pathname===l?"link-active":"link";return e.jsxs("div",{className:"nav-desktop-child",children:[e.jsx(Z,{}),e.jsx(_,{type:"link",onClick:t,className:s("/"),children:e.jsxs(xe,{to:"/",children:[e.jsx(O,{icon:ks})," ",e.jsx("p",{children:"לוח מחוונים"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/menu"),children:e.jsxs(xe,{to:"/menu",children:[e.jsx(O,{icon:Qe})," ",e.jsx("p",{children:"תפריט"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/mixes"),children:e.jsxs(xe,{to:"/mixes",children:[e.jsx(O,{icon:ht})," ",e.jsx("p",{children:"מיקסים"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/ingredients"),children:e.jsxs(xe,{to:"/ingredients",children:[e.jsx(O,{icon:qe})," ",e.jsx("p",{children:"חומרי גלם"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/suppliers"),children:e.jsxs(xe,{to:"/suppliers",children:[e.jsx(O,{icon:Je})," ",e.jsx("p",{children:"ספקים"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/employees"),children:e.jsxs(xe,{to:"/employees",children:[e.jsx(O,{icon:_s})," ",e.jsx("p",{children:"עובדים"})]})}),e.jsx(_,{type:"link",onClick:t,className:s("/work-hours"),children:e.jsxs(xe,{to:"/work-hours",children:[e.jsx(O,{icon:pt})," ",e.jsx("p",{children:"ניהול שעות עבודה"})]})})]})}const rt=Ot("dashboard/fetchDashboardData",async(t,{getState:r})=>(r(),{})),wa=Se({name:"dashboard",initialState:[],reducers:{},extraReducers:t=>{t.addCase(rt.pending,r=>{}).addCase(rt.fulfilled,(r,s)=>{}).addCase(rt.rejected,r=>{})}}),Sa=wa.reducer,Ca=Ms({reducer:{suppliers:Nr,ingredients:Hr,products:Fn,dashboard:Sa,mixes:Wr,categories:Gr,employees:ea,employeeHours:_n,settings:ua}});ls.createRoot(document.getElementById("root")).render(e.jsx(ut.StrictMode,{children:e.jsx(os,{store:Ca,children:e.jsx(va,{})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(t=>{console.error("ServiceWorker registration failed: ",t)})});
