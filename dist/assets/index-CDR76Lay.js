import{r as o,j as e,a as Pt}from"./react-BoqISt01.js";import{c as Ks}from"./react-dom-Bk743r0W.js";import{u as V,a as ze,P as en}from"./react-redux-D3oi59tp.js";import{a as X}from"./axios-CCb-kr4I.js";import{s as q,L as ue,C as le,R as O,F as B,D as Z,B as E,a as as,T as st,P as tn,d as sn,M as fe,b as z,c as M,S as ce,e as de,f as Y,g as Dt,h as be,i as Be,I as xe,j as is,k as Ut,l as Ht,m as jt,n as _t,o as Bt,p as nn,q as rn,A as an,r as ft,t as Pe,u as Ke,v as Ze,w as ln,x as on,y as yt,z as dn,E as ls}from"./antd-DUgvu7h7.js";import{u as Ae}from"./react-responsive-B9DcSnuZ.js";import{L as cn}from"./rc-virtual-list-D8xMsbcw.js";import{F as D,f as Qe,a as Ye,b as os,c as Ee,d as $e,e as un,g as xn,h as pn,i as mn,j as Tt,k as We,l as Et,m as hn,n as et,o as tt,p as nt,q as xt,r as gn,s as jn,t as fn,u as yn}from"./@fortawesome-iG2bi8FM.js";import{a2 as vt,A as ds,a3 as cs,a4 as vn,o as Wt,a5 as wn,a6 as _e,R as $t,a1 as At,v as Rt,r as bn,s as Cn,x as Sn,a7 as In}from"./@ant-design-DbJKpMgD.js";import{c as us,a as Ie,b as Nn}from"./@reduxjs-DkgbS889.js";import{m as Se,h as zt}from"./moment-BAfwh5x7.js";import{D as kn,B as Qt}from"./react-chartjs-2-0Z_sSmBf.js";import{C as Fn,A as Pn,p as _n,a as Tn,b as En,L as $n,c as An}from"./chart.js-BkMDj0WH.js";import{L as pe,B as Rn}from"./react-router-dom-UU0TJEQ6.js";import{l as Mn}from"./socket.io-client-CDVIIGn8.js";import{O as xs,C as ps,a as qn,T as ms,D as hs,P as Ln,R as On,b as gs,S as js,L as fs,c as ys,d as vs,e as Dn,f as Un,g as ws,h as Hn,i as Bn,j as Wn}from"./@radix-ui-B3e9CqpC.js";import{c as zn}from"./clsx-B-dksMZM.js";import{t as Qn}from"./tailwind-merge-D696Ktp4.js";import{X as wt,C as Yn,a as Jn,S as Gn,T as Xn,b as pt,P as Vn,c as Zn,d as Kn}from"./lucide-react-C-DaTvPU.js";import{u as er,F as tr,C as sr,b as nr}from"./react-hook-form-E7byIJnj.js";import{c as Mt}from"./class-variance-authority-Dp3B9jqt.js";import{z as Me}from"./zod-DHHRaryC.js";import{t as rr}from"./@hookform-CaGMwPfa.js";import{d as ar,e as Fe,b as ir}from"./react-router-CBguhhk8.js";import"./@babel-D3CJPhrF.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-BQxMxw6g.js";import"./rc-util-CNJZKBfo.js";import"./classnames-CAxFPVRb.js";import"./rc-resize-observer-DAFDewDD.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-DZL9tseL.js";import"./@rc-component-DPyZj6wr.js";import"./rc-overflow-BihHMfjR.js";import"./rc-picker-C6pnqAVS.js";import"./dayjs-DMN7meC7.js";import"./rc-tabs-BUPz9aOH.js";import"./rc-dropdown-DBn3Vn4f.js";import"./rc-menu-CXhGSgjF.js";import"./rc-select-Enbnx8e0.js";import"./rc-segmented-DWUgWqHo.js";import"./rc-input-number-Do8zGlOB.js";import"./rc-input-DGbryaDy.js";import"./@ctrl-DOFZgDuz.js";import"./rc-drawer-DjgcoIVX.js";import"./rc-field-form-DdGYHmQ7.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-image-CQiP7trl.js";import"./rc-dialog-B4yQaf15.js";import"./rc-notification-m3oA-fH0.js";import"./rc-tooltip-BAFIWTUD.js";import"./rc-steps-jTTkhuna.js";import"./rc-progress-BECVEO62.js";import"./rc-switch-B_QRjvBh.js";import"./rc-table-rj7zZJss.js";import"./rc-tree-BDK0sBoh.js";import"./rc-checkbox-XvbJzSrO.js";import"./rc-pagination-CZPuIcur.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-textarea-BF1YsysJ.js";import"./copy-to-clipboard-DN2oU9Yq.js";import"./toggle-selection-BHUZwh74.js";import"./matchmediaquery-9DU1HNkU.js";import"./css-mediaquery-DcYbJrVh.js";import"./hyphenate-style-name-HOLnhz8K.js";import"./shallow-equal-BQUY1Bas.js";import"./prop-types-Bq5K3Feg.js";import"./@emotion-CW87jbl0.js";import"./stylis-OW4gUFyn.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./@kurkle-BZxJdD1U.js";import"./@remix-run-Br25Cn4W.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./react-remove-scroll-uEV8_dwQ.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-Chida324.js";import"./react-style-singleton-D-ncAbk2.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BUbtaZ7t.js";import"./use-callback-ref-CGYexTLy.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-CyZwn0-1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function s(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerPolicy&&(u.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?u.credentials="include":n.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(n){if(n.ep)return;n.ep=!0;const u=s(n);fetch(n.href,u)}})();const ye="https://menu-server-c2b952e2c698.herokuapp.com/api",lr=t=>X.post(`${ye}/products`,t),or=t=>{const r=encodeURIComponent(t._id);return X.put(`${ye}/products/${r}`,t)},dr=t=>X.delete(`${ye}/products/${t}`),bs=()=>X.get(`${ye}/products`),cr=t=>X.get(`${ye}/products/${t}`),ur=(t,r)=>X.post(`${ye}/sizes/${t}`,r),xr=(t,r)=>X.put(`${ye}/sizes/${t}`,r),pr=(t,r)=>X.delete(`${ye}/sizes/${t}/${r}`),mr=t=>X.post(`${ye}/variations`,t),hr=(t,r)=>X.put(`${ye}/variations/${t}`,r),gr=t=>X.delete(`${ye}/variations/${t}`),Cs=o.createContext(),Ss=()=>o.useContext(Cs),jr=({children:t})=>{const[r,s]=o.useState(!1),[i,n]=o.useState(!1),[u,m]=o.useState("add"),[c,h]=o.useState(null),[f,N]=o.useState(null),S=C=>new Promise(async(j,a)=>{var x;try{const g=await cr(C);(x=g==null?void 0:g.data)!=null&&x.error?a(!1):j(g==null?void 0:g.data)}catch(g){console.error("Error get product:",g)}}),L=C=>new Promise(async(j,a)=>{var x,g;s(!0);try{const y=await lr(C);s(!1),(x=y==null?void 0:y.data)!=null&&x.error?(q.error((g=y==null?void 0:y.data)==null?void 0:g.error),a(!1)):(q.success("המוצר נוסף בהצלחה"),j(!0))}catch(y){console.error("Error adding product:",y),q.error("שגיאה בהוספת המוצר"),s(!1)}}),I=C=>new Promise(async(j,a)=>{var x;s(!0);try{const g=await or(C);s(!1),(x=g==null?void 0:g.data)!=null&&x.error||(q.success("המוצר עודכן בהצלחה"),j(!0)),a(!1)}catch(g){console.error("Error updating product:",g),q.error("שגיאה בעדכון המוצר"),s(!1)}}),F=async C=>{s(!0);try{await dr(C),q.success("המוצר נמחק בהצלחה"),s(!1)}catch(j){console.error("Error deleting product:",j),q.error("שגיאה במחיקת המוצר"),s(!1)}},P=(C,j)=>(s(!0),new Promise(async(a,x)=>{try{const g=await ur(C,j);q.success("הגודל נוסף בהצלחה"),s(!1),a(g.data)}catch(g){console.error("Error adding size:",g),q.error("שגיאה בהוספת הגודל"),s(!1),x(g)}})),R=(C,j)=>(s(!0),new Promise(async(a,x)=>{try{const g=await xr(C,j);q.success("הגודל עודכן בהצלחה"),s(!1),a(g.data)}catch(g){console.error("Error updating size:",g),q.error("שגיאה בעדכון הגודל"),s(!1),x(g)}})),b=(C,j)=>(s(!0),new Promise(async(a,x)=>{try{await pr(C,j),q.success("הגודל נמחק בהצלחה"),s(!1),a(!0)}catch(g){console.error("Error deleting size:",g),q.error("שגיאה במחיקת הגודל"),s(!1),x(g)}})),w=C=>(s(!0),new Promise(async(j,a)=>{try{const x=await mr(C);q.success("הווריאציה נוספה בהצלחה"),s(!1),j(x.data)}catch(x){console.error("Error adding variation:",x),q.error("שגיאה בהוספת הווריאציה"),s(!1),a(x)}})),d=(C,j)=>(s(!0),new Promise(async(a,x)=>{try{const g=await hr(C,j);q.success("הווריאציה עודכנה בהצלחה"),s(!1),a(g.data)}catch(g){console.error("Error updating variation:",g),q.error("שגיאה בעדכון הווריאציה"),s(!1),x(g)}})),p=C=>(s(!0),new Promise(async(j,a)=>{try{await gr(C),q.success("הווריאציה נמחקה בהצלחה"),s(!1),j(!0)}catch(x){console.error("Error deleting variation:",x),q.error("שגיאה במחיקת הווריאציה"),s(!1),a(x)}}));return e.jsx(Cs.Provider,{value:{getProductById:S,addProduct:L,updateProduct:I,deleteProduct:F,addSize:P,updateSize:R,deleteSize:b,addVariation:w,updateVariation:d,deleteVariation:p,loading:r,isModalVisible:i,setIsModalVisible:n,modalMode:u,setModalMode:m,selectedItem:c,setSelectedItem:h,selectedUpdateSize:f,setSelectedUpdateSize:N},children:t})};function fr({data:t,type:r,tableKeys:s,mobileKeys:i,openModal:n,Dtitle:u,Dcontent:m,onDelete:c}){const h=Ae({query:"(max-width: 500px)"}),[f,N]=o.useState(0),[S,L]=o.useState(1),[I,F]=o.useState(6),[P,R]=o.useState([]),b=(p,C)=>{const j=(p-1)*C,a=j+C;return t.slice(j,a)},w=(p,C)=>{L(p),F(C)};o.useEffect(()=>{N(t.length),R(b(S,I))},[S,I,t]);const d=p=>{fe.confirm({title:u,content:m,okText:"מחק",cancelText:"בטל",onOk:()=>c(p==null?void 0:p._id)})};return h?e.jsx(e.Fragment,{children:e.jsx(ue,{style:{maxHeight:"55vh",overflowY:"auto",minHeight:"80%",height:"80%"},children:e.jsx(cn,{data:t,itemHeight:47,itemKey:"_id",children:p=>{var C,j,a;return e.jsx(ue.Item,{className:"width-100",style:{padding:"0"},children:e.jsxs(le,{className:"width-100 padding-card",style:{margin:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(B,{flex:1,children:e.jsx("strong",{style:{fontSize:"1.3em"},children:p==null?void 0:p.name})}),e.jsxs(B,{flex:1,style:{flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("strong",{children:(C=s==null?void 0:s.find(x=>x.key==="usedCount"))==null?void 0:C.title}),e.jsx("p",{children:p==null?void 0:p.usedCount})]}),(j=s==null?void 0:s.find(x=>x.key==="type"||x.key==="category"))==null?void 0:j.render("",p,"view")]}),s.filter(x=>x.key!=="name"&&x.key!=="type"&&(x==null?void 0:x.key)!=="category"&&(x==null?void 0:x.key)!=="actions"&&(i==null?void 0:i.includes(x==null?void 0:x.key))).map((x,g,y)=>e.jsxs(Pt.Fragment,{children:[e.jsxs("div",{style:{fontSize:"0.9em",display:"flex",justifyContent:"space-between"},children:[x.title&&e.jsxs("strong",{children:[x.title,":"]}),e.jsx("span",{children:x.render?x.render(null,p,"view"):p[x.dataIndex]||"—"})]}),g<2&&e.jsx(Z,{style:{margin:"0.2em"}})]},`${p==null?void 0:p._id}-${x.key}`)),e.jsxs(O,{className:"card-actions",align:"middle",justify:"center",children:[(a=s==null?void 0:s.find(x=>x.key==="actions"))==null?void 0:a.render(null,p),r==="P"&&e.jsx(Z,{type:"vertical"}),e.jsxs(B,{align:"center",justify:"center",children:[e.jsx(E,{type:"text",onClick:()=>d(p),children:e.jsx(D,{icon:Qe})}),e.jsx(E,{type:"text",onClick:()=>n("edit",p),children:e.jsx(D,{icon:Ye})}),e.jsx(E,{type:"text",onClick:()=>n("view",p),children:e.jsx(D,{icon:os})})]})]})]})},p==null?void 0:p._id)}})})}):e.jsxs(B,{flex:1,style:{display:"flex",flexDirection:"column",overflow:"hidden",width:"100%"},children:[e.jsx(B,{flex:1,style:{maxWidth:"100%",maxHeight:"90%",overflowY:"auto",overflowX:"auto"},children:e.jsx(as,{style:{minWidth:"100%"},columns:s.map(p=>({...p,title:e.jsx(st,{title:p.title,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:p.title})})})),dataSource:P,pagination:!1,direction:"rtl"})}),e.jsx(B,{align:"center",justify:"center",style:{marginTop:"2vh"},children:e.jsx(tn,{current:S,total:f,pageSize:I,onChange:w,style:{direction:"ltr"},showSizeChanger:!0,pageSizeOptions:["6","10","20","50"],locale:sn})})]})}const{Text:Yt}=Y,yr=({value:t=[],onChange:r,ingredientsArr:s=[],fields:i,add:n,remove:u,form:m})=>{var x,g;const[c,h]=o.useState(null),[f,N]=o.useState(!1);o.useState(null),o.useState(null);const[S,L]=o.useState(""),I=o.useRef(null),F=o.useCallback(()=>{setTimeout(()=>{I.current&&I.current.scroll({top:I.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(x=I.current)==null?void 0:x.scrollHeight]),P=(y,T)=>{const v=[...m.getFieldValue("ingredients")||[]];v[c]={...v[c],ingredientId:y,unit:T.unit,name:T.label},L(T.unit)},R=y=>{const _=[...m.getFieldValue("ingredients")||[]];_[c]={..._[c],quantity:y}},b=()=>{const T=a()[c];if(!T||!T.ingredientId||!T.quantity)return;const _=s.find(J=>J._id===T.ingredientId),v={...T,name:(_==null?void 0:_.name)||"---",unit:(_==null?void 0:_.unit)||T.unit,weightOrVolumePerUnit:T.weightOrVolumePerUnit||null},W=[...t,v];r(W),h(null),N(!1)},w=y=>{const T=t.filter((_,v)=>v!==y);r(T),h(null)},d=()=>{f&&w(c),h(null),N(!1)},p=()=>h(null),C=(y,T,_)=>{const v=[...t];if(v[y][T]=_,T==="ingredientId"){const W=s.find(J=>J._id===_);W&&(v[y].unit=W.unit,v[y].name=W.name)}r(v)},j=y=>{switch(y){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}},a=()=>{const y=m==null?void 0:m.getFieldValue("ingredients");return Array.isArray(y)?y:[]};return o.useEffect(()=>{a().length>0&&F()},[(g=m==null?void 0:m.getFieldValue("ingredients"))==null?void 0:g.length]),e.jsxs(e.Fragment,{children:[f?e.jsxs(O,{gutter:16,style:{marginBottom:"1vw"},children:[e.jsxs("div",{className:"flex flex-1 flex-wrap",children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[c,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(ce,{placeholder:"בחר רכיב",filterOption:(y,T)=>{var _;return(_=T==null?void 0:T.label)==null?void 0:_.toLowerCase().includes(y.toLowerCase())},showSearch:!0,options:s==null?void 0:s.map(y=>({value:y._id,label:y.name,unit:y.unit})),onChange:P})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[c,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(de,{onChange:R,addonAfter:j(S),placeholder:"כמות"})})}),S==="units"&&e.jsx(z,{span:14,children:e.jsx(M.Item,{name:[c,"weightOrVolumePerUnit"],rules:[{required:!0,message:"הזן נפח/משקל ליחידה"}],children:e.jsx(de,{placeholder:"נפח/משקל ליחידה",min:0,onChange:y=>C(c,"weightOrVolumePerUnit",y),addonAfter:"קילו/ליטר"})})})]}),e.jsxs(z,{span:4,children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:b}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:d})]})]}):e.jsx(E,{type:"dashed",onClick:()=>{h(t.length),N(!0)},disabled:c!==null,style:{marginBottom:"8px"},children:"הוסף מרכיב"}),e.jsx(le,{ref:I,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:t,renderItem:(y,T)=>{var J;const _=c===T,v=s.find(G=>G._id===y.ingredientId),W=j(y.unit||(v==null?void 0:v.unit));return e.jsx(ue.Item,{children:_&&!f?e.jsxs(O,{gutter:16,style:{marginBottom:"1vw"},children:[e.jsxs("div",{className:"flex flex-1 flex-wrap",children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[T,"ingredientId"],children:e.jsx(ce,{placeholder:"בחר רכיב",value:y.ingredientId||null,onChange:G=>C(T,"ingredientId",G),options:s.map(G=>({value:G._id,label:G.name})),showSearch:!0})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[T,"quantity"],children:e.jsx(de,{placeholder:"כמות",onChange:G=>C(T,"quantity",G),min:0,addonAfter:W,style:{width:"100%"}})})}),y.unit==="units"&&e.jsx(z,{span:14,children:e.jsx(M.Item,{name:[T,"weightOrVolumePerUnit"],rules:[{required:!0,message:"הזן נפח/משקל ליחידה"}],children:e.jsx(de,{placeholder:"נפח/משקל ליחידה (ליטר/גרם)",min:0,style:{width:"100%"},addonAfter:"קילו/ליטר",onChange:G=>C(T,"weightOrVolumePerUnit",G)})})})]}),e.jsxs(z,{children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:p}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:d})]})]}):e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:1,children:e.jsx(Yt,{children:(y==null?void 0:y.name)||((J=y==null?void 0:y.ingredientData)==null?void 0:J.name)||"---"})}),e.jsx(B,{flex:1,children:e.jsxs(Yt,{children:[y.quantity," ",W,y.unit==="units"&&y.weightOrVolumePerUnit?` (${y.weightOrVolumePerUnit} ק"ג/ליטר)`:""]})}),e.jsxs(O,{children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ye}),onClick:()=>h(T)}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Qe}),onClick:()=>w(T)})]})]})},T)}})})]})},we=[{value:"weight",label:"משקל",display:t=>t>=1?'ק"ג':"גרם"},{value:"volume",label:"נפח",display:t=>t>=1?"ליטר":'מ"ל'},{value:"units",label:"יחידות",display:t=>t>1?"יחידות":"יחידה"}],{Option:qe}=ce,{Text:me}=Y,{TextArea:vr}=xe;function wr({mode:t="view",type:r,fields:s=[],onSubmit:i,initialValues:n={},onClose:u,groups:m,tableKeys:c,ingredientsArr:h}){var v,W,J,G,re,ae,ie,k,A;const[f]=M.useForm(),[N]=M.useForm(),[S]=M.useForm(),L=V(l=>{var $,H;return(H=($=l.settings.settings)==null?void 0:$.hourlyRate)==null?void 0:H.value}),[I,F]=o.useState(0),[P,R]=o.useState(["process","wait"]),[b,w]=o.useState({}),[d,p]=o.useState(n),[C,j]=o.useState(n.unit||null),[a,x]=o.useState(n.subUnit||null),g=l=>{console.log("onChange:",l),F(l)},y=async l=>{let $=l.quantity;u&&u(),(l.subUnit==="g"||l.subUnit==="ml")&&($=l.quantity/1e3);const H={...n,...b,...l,quantity:$};i&&await i(H),await N.resetFields(),await S.resetFields()};o.useEffect(()=>{if(n){const l=n.quantity<1?n.quantity*1e3:n.quantity;f.setFieldsValue({...n,quantity:l}),j(n.unit),x(n.subUnit||"kg")}},[n,f]);const T=(l,$)=>l.map(H=>{const{key:K,title:he,type:Ne,options:Re,rules:ve,props:ke,hiddenInForm:U,coin:ne,divider:ee}=H;if(U)return null;switch(Ne){case"text":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(xe,{...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"number":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve==null?void 0:ve.map(Q=>Q.validator?{...Q,validator:(se,oe)=>Q.validator(se,oe,n)}:Q),validateTrigger:"onSubmit",children:e.jsx(de,{suffix:ne&&"₪",min:0,style:{width:"100%"},...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"float":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(de,{suffix:ne&&"₪",min:0,step:.01,style:{width:"100%"},...ke})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"select":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(ce,{...ke,showSearch:!0,onChange:Q=>{K==="unit"&&(j(Q),p(se=>({...se,unit:Q,subUnit:void 0})),$.setFieldsValue({subUnit:void 0}))},children:Re.map(Q=>e.jsx(qe,{value:Q.value,children:Q.label},Q.value))})},K),e.jsx(M.Item,{noStyle:!0,shouldUpdate:(Q,se)=>Q.unit!==se.unit,children:()=>{const Q=d==null?void 0:d.unit,se=d==null?void 0:d.subUnit;return K==="unit"&&(Q==="weight"||Q==="volume")?e.jsx(M.Item,{name:"subUnit",initialValue:se||(Q==="weight"?(d==null?void 0:d.quantity)>=1?"kg":"g":(d==null?void 0:d.quantity)>=1?"liter":"ml"),validateTrigger:"onSubmit",label:Q==="weight"?'בחר יחידת משקל (ק"ג / גרם)':'בחר יחידת נפח (ליטר / מ"ל)',rules:[{required:!0,message:"אנא בחר יחידת משנה"}],children:e.jsx(ce,{onChange:oe=>p(ut=>({...ut,subUnit:oe})),children:Q==="weight"?e.jsxs(e.Fragment,{children:[e.jsx(qe,{value:"kg",children:'ק"ג'}),e.jsx(qe,{value:"g",children:"גרם"})]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{value:"liter",children:"ליטר"}),e.jsx(qe,{value:"ml",children:'מ"ל'})]})})}):null}}),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"ingredientsManager":return e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"0.5em"}}),e.jsx(M.List,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:(Q,{add:se,remove:oe})=>e.jsx(yr,{fields:Q,add:se,form:$,remove:oe,value:$.getFieldValue(K),onChange:ut=>$.setFieldsValue({[K]:ut}),ingredientsArr:h})},K)]});case"price":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:"withVATFlag",initialValue:!0,valuePropName:"checked",validateTrigger:"onSubmit",children:e.jsx(Be,{onChange:()=>{p(Q=>({...Q,price:void 0,priceExcludingVAT:void 0}))},children:'עלות כולל מע"מ'})},"withVATFlag"),e.jsx(M.Item,{noStyle:!0,validateTrigger:"onSubmit",shouldUpdate:(Q,se)=>Q.withVATFlag!==se.withVATFlag,children:({getFieldValue:Q})=>Q("withVATFlag")?e.jsx(M.Item,{name:"price",label:'עלות (כולל מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(de,{addonAfter:"₪",onChange:se=>{p(oe=>({...oe,priceExcludingVAT:void 0,price:se}))},style:{width:"100%"}})},"price"):e.jsx(M.Item,{name:"priceExcludingVAT",label:'עלות (ללא מע"מ)',rules:[{required:!0,message:"חייב להזין עלות"}],validateTrigger:"onSubmit",children:e.jsx(de,{style:{width:"100%"},addonAfter:"₪",onChange:se=>{p(oe=>({...oe,price:void 0,priceExcludingVAT:se}))}})},"priceExcludingVAT")})]});case"custom":return e.jsxs(e.Fragment,{children:[H.render&&H.render("",n,"edit",$),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});case"textArea":return e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:K,label:he,rules:ve,validateTrigger:"onSubmit",children:e.jsx(vr,{style:{resize:"none"},showCount:!0,maxLength:H==null?void 0:H.maxLength})},K),ee&&e.jsx(Z,{style:{margin:"3vh 0vh"}})]});default:return null}});if(t==="view")switch(r){case"mix":return e.jsxs("div",{children:[e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(v=c==null?void 0:c.find(l=>l.key==="type"))==null?void 0:v.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(W=c==null?void 0:c.find(l=>l.key==="is_active"))==null?void 0:W.render("",n,"view")}),e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",n==null?void 0:n.totalCost]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(ds,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.preparationTime," דקות"]})]})]}),e.jsxs(le,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs("div",{style:{margin:"12px 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["עלות עבודה (₪)",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.laborCost," (₪",L,")"]})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["עלות ל-100 גרם (₪)",":"]})}),e.jsx(B,{children:e.jsx("p",{style:{},children:(J=c==null?void 0:c.find(l=>l.key==="unitCost"))==null?void 0:J.render("",n,"view")})})]})]}),e.jsxs(le,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:[e.jsx(me,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0",maxHeight:"5vw",overflow:"auto"},children:(G=n==null?void 0:n.ingredients)==null?void 0:G.map((l,$)=>{var K;const H=(()=>{switch(l==null?void 0:l.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(me,{children:[(K=h==null?void 0:h.find(he=>(he==null?void 0:he._id)===(l==null?void 0:l.ingredientId)))==null?void 0:K.name," -"," ",l.quantity," ",H," - ₪",l==null?void 0:l.costForQuantity]})},$)})})]})]});case"ingredient":return e.jsxs("div",{children:[e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(re=c==null?void 0:c.find(l=>l.key==="type"))==null?void 0:re.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:e.jsx(Y.Text,{strong:!0,children:n==null?void 0:n.SKU})}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(ae=c==null?void 0:c.find(l=>l.key==="is_active"))==null?void 0:ae.render("",n,"view")}),e.jsx(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:(ie=c==null?void 0:c.find(l=>l.key==="supplierId"))==null?void 0:ie.render("",n,"view")}),e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(z,{children:[e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.priceExcludingVAT,' (ללא מע"מ)']}),e.jsxs(Y.Text,{style:{fontSize:"1em",display:"flex",alignItems:"center"},children:["₪",n==null?void 0:n.price,' (כולל מע"מ)']})]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(D,{icon:un}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[n==null?void 0:n.quantity," ",we.find(l=>l.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)]})]})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["כמות מינימלית",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:[n==null?void 0:n.unitQuantity," ",we.find(l=>l.value===(n==null?void 0:n.unit)).display(n==null?void 0:n.quantity)," - ₪",n==null?void 0:n.unitPrice]})})]}),(n==null?void 0:n.juiceRatio)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["יחס עיבוד",":"]})}),e.jsx(B,{children:e.jsx("p",{style:{},children:(k=c==null?void 0:c.find(l=>l.key==="juiceRatio"))==null?void 0:k.render("",n,"view")})})]}),e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:["מחיר ליחידה מעובדת",":"]})}),e.jsx(B,{children:e.jsxs("p",{style:{},children:["₪",n==null?void 0:n.processedPrice]})})]})]}),(n==null?void 0:n.notes)&&e.jsx(le,{type:"inner",style:{backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:e.jsxs(z,{children:[e.jsx(O,{style:{marginBottom:"4px"},children:e.jsxs(me,{strong:!0,style:{fontSize:"1.2em",color:"#333"},children:["הערות",":"]})}),e.jsx(Y.Text,{style:{fontSize:"1em",color:"#555"},children:n==null?void 0:n.notes})]})})]});default:return e.jsxs("div",{style:{},children:[e.jsxs(O,{align:"middle",justify:"space-between",style:{margin:"1em 0em"},children:[e.jsx(me,{strong:!0,style:{fontSize:"1.8em"},children:n==null?void 0:n.name}),(A=c==null?void 0:c.find(l=>l.key==="type"))==null?void 0:A.render("",n,"view")]}),c==null?void 0:c.filter(l=>l.key!=="type"&&(l==null?void 0:l.key)!=="name"&&!l.column).map((l,$,H)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(me,{strong:!0,children:[l.title,":"]})}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:(l==null?void 0:l.render)&&(l==null?void 0:l.render("",n,t,"view"))||n[l.key]||"—"})})]},l.key),$<(H==null?void 0:H.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]})),c==null?void 0:c.filter(l=>l.column).map((l,$,H)=>e.jsxs(e.Fragment,{children:[$===0&&e.jsx(Z,{style:{margin:"8px 0"}}),e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[e.jsxs(me,{strong:!0,style:{fontSize:"1.4em"},children:[l.title,":"]}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:(l==null?void 0:l.render)&&(l==null?void 0:l.render("",n,t,"view"))||n[l.key]||"—"})})]},l.key),$<(H==null?void 0:H.length)-1&&e.jsx(Z,{style:{margin:"8px 0"}})]}))]})}const _=[{title:"מידע",icon:e.jsx(cs,{}),content:e.jsxs(M,{form:N,layout:"vertical",onValuesChange:(l,$)=>{p(H=>({...H,...l}))},onFinish:async l=>{await N.validateFields(),p({...d,...l}),F(I+1)},initialValues:n,children:[T(s==null?void 0:s.filter(l=>l.group===1),N),m&&!(n!=null&&n._id)&&e.jsx(E,{type:"primary",htmlType:"submit",children:"הבא"}),t!=="add"&&e.jsx(E,{type:"primary",onClick:()=>y(d),children:"עדכן"})]})},{title:"עלויות",icon:e.jsx(vn,{}),content:e.jsxs(M,{layout:"vertical",form:S,onValuesChange:(l,$)=>{p(H=>({...H,...l}))},onFinish:l=>{const $={...d,...l};p($),i&&i($)},initialValues:n,children:[T(s==null?void 0:s.filter(l=>l.group===2),S),m&&!(n!=null&&n._id)&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"24px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[I>0&&e.jsx(E,{onClick:()=>F(I-1),children:"הקודם"}),e.jsx(E,{type:"primary",htmlType:"submit",children:t!=="add"?"עדכן":"סיום"})]})]}),t!=="add"&&e.jsx(E,{type:"primary",onClick:()=>{console.log(S==null?void 0:S.getFieldsValue()),y(d)},children:"עדכן"})]})}];return e.jsxs(e.Fragment,{children:[m&&!(n!=null&&n._id)&&e.jsx(B,{wrap:"wrap",justify:"space-between",align:"center",style:{gap:"8px"},children:e.jsx(Dt,{current:I,onChange:g,status:P[I],style:{width:"100%"},children:_==null?void 0:_.map((l,$)=>e.jsx(Dt.Step,{title:l.title,icon:l.icon},$))})}),m&&(n==null?void 0:n._id)&&e.jsx(B,{flex:1,wrap:"wrap",justify:"center",align:"center",style:{gap:"8px"},children:e.jsx(be,{current:I,onChange:g,status:P[I],style:{width:"100%"},children:_==null?void 0:_.map((l,$)=>e.jsx(be.TabPane,{tab:l.title,icon:l.icon},$))})}),m&&_[I].content,!m&&e.jsxs(M,{form:f,layout:"vertical",onFinish:y,onValuesChange:l=>{console.log(l)},initialValues:n,children:[!m&&T(s,f),t!=="view"&&(!m||m&&(n==null?void 0:n._id))&&e.jsx(M.Item,{children:e.jsx(E,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"1vw"},children:t==="add"?"הוסף":"עדכן"})})]})]})}function br({open:t,onClose:r,filters:s,setFilters:i,filtersArr:n}){var S,L,I,F,P,R,b;const[u,m]=o.useState({type:s.type||[],supplierId:s.supplierId||[],is_active:s.is_active}),c=w=>{m(d=>({...d,[w]:w==="is_active"?null:[]}))},h=()=>{const w=Object.entries(u).reduce((d,[p,C])=>((Array.isArray(C)&&C.length>0||typeof C=="boolean")&&(d[p]=C),d),{});i(w),r()},f=w=>{const d=w==="all"?null:w==="true";m(p=>({...p,is_active:d}))},N=({options:w,filterKey:d})=>{const p=C=>{m(j=>{const a=j[d]||[],x=a.includes(C)?a.filter(g=>g!==C):[...a,C];return{...j,[d]:x}})};return e.jsxs("div",{children:[e.jsx("div",{className:"sticky top-0 bg-white p-2 border-b",children:e.jsx(E,{type:"link",className:"w-full text-left",onClick:()=>c(d),children:"איפוס בחירה"})}),e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",padding:"8px"},onScroll:C=>C.stopPropagation(),children:w.map(C=>e.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:e.jsx(Be,{checked:(u[d]||[]).includes(C.value),onChange:()=>p(C.value),children:C.label})},C.value))})]})};return e.jsxs(is,{title:"סינון רכיבים",placement:"right",onClose:r,open:t,width:360,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"קטגוריה"}),e.jsx(Ut,{content:e.jsx(N,{options:((S=n.find(w=>w.value==="type"))==null?void 0:S.options)||[],filterKey:"type"}),trigger:"click",getPopupContainer:w=>w.parentElement,children:e.jsxs(E,{style:{width:"100%"},type:"dashed",children:[(((L=u.type)==null?void 0:L.length)||0)>0?`${(I=u.type)==null?void 0:I.length} נבחרו`:"בחר קטגוריות",e.jsx(Wt,{style:{marginLeft:"8px"}})]})})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"ספק"}),e.jsx(Ut,{content:e.jsx(N,{options:((F=n.find(w=>w.value==="supplierId"))==null?void 0:F.options)||[],filterKey:"supplierId"}),trigger:"click",getPopupContainer:w=>w.parentElement,children:e.jsxs(E,{style:{width:"100%"},type:"dashed",children:[(((P=u.supplierId)==null?void 0:P.length)||0)>0?`${(R=u.supplierId)==null?void 0:R.length} נבחרו`:"בחר ספקים",e.jsx(Wt,{style:{marginLeft:"8px"}})]})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500"},children:"סטטוס"}),e.jsx(ce,{style:{width:"100%"},value:((b=u.is_active)==null?void 0:b.toString())||"all",onChange:f,options:[{label:"הכל",value:"all"},{label:"פעיל",value:"true"},{label:"לא פעיל",value:"false"}]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(E,{onClick:()=>m({type:[],supplierId:[],is_active:null}),children:"איפוס הכל"}),e.jsx(E,{type:"primary",onClick:h,children:"החל סינון"})]})]})}const{Search:Cr}=xe;function rt({title:t,titleView:r,dataPrint:s,data:i,groups:n,tableKeys:u,newTitle:m,setDataPrint:c,searchKeys:h,sortKeys:f,mobileKeys:N,Dtitle:S,Dcontent:L,onAdd:I,onEdit:F,onDelete:P,width:R,ingredientsArr:b,iconADD:w,floatAction:d,type:p,openModalProduct:C,filters:j,saveFilters:a,filtersArr:x}){const[g,y]=o.useState([]),[T,_]=o.useState(!1),[v,W]=o.useState(!1),[J,G]=o.useState("add"),[re,ae]=o.useState(null),[ie,k]=o.useState(!1),[A,l]=o.useState(j),$=Ae({query:"(max-width: 500px)"}),H=f.map(U=>({key:U==null?void 0:U.key,label:e.jsx("span",{className:"width-100",onClick:()=>{const ne=[...s].sort((ee,Q)=>{const se=ee[U==null?void 0:U.key],oe=Q[U==null?void 0:U.key];return typeof se=="number"&&typeof oe=="number"?oe-se:se==null?void 0:se.toString().localeCompare(oe==null?void 0:oe.toString())});c(ne)},children:U==null?void 0:U.title})})),K=U=>{if(U==="all")y(u);else{let ne=g.findIndex(Q=>Q.key===U),ee=[...g];ne!==-1?ee=ee.filter(Q=>Q.key!==U):ee=[...ee,u.find(Q=>Q.key===U)],y(ee)}},he=[{key:"all",label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:g.length===u.length,disabled:g.length===u.length,onChange:()=>K("all"),onClick:U=>U.stopPropagation(),children:"הכל"})},...u.filter(U=>!(U!=null&&U.required)).map(({title:U,dataIndex:ne})=>({key:ne,label:e.jsx(Be,{className:"width-100",rootClassName:"width-100",checked:g.some(ee=>ee.key===ne),disabled:g.length<=3&&g.some(ee=>ee.key===ne),onChange:()=>K(ne),onClick:ee=>ee.stopPropagation(),children:U})}))],Ne=(U,ne=null)=>{if(p==="P")return C(U,ne);G(U),ae(ne),W(!0)},Re=()=>{W(!1),ae(null)},ve=U=>{fe.confirm({title:S,content:L,okText:"מחק",cancelText:"בטל",onOk:()=>P(U==null?void 0:U._id)})},ke=()=>{let U=[...i];Object.entries(j).forEach(([ne,ee])=>{if(ee!=null)switch(ne){case"search":U=U.filter(Q=>h.some(se=>{var oe;return(oe=Q[se])==null?void 0:oe.toString().toLowerCase().includes(ee.toLowerCase())}));break;case"is_active":U=U.filter(Q=>Q.is_active===ee);break;case"type":case"supplierId":Array.isArray(ee)&&(U=U.filter(Q=>ee.includes(Q[ne])));break}}),c(U)};return o.useEffect(()=>{j&&(ke(),l(j))},[j]),o.useEffect(()=>{y(u)},[u]),e.jsxs(B,{flex:1,vertical:!0,style:{maxWidth:"100%"},gap:"1em",className:"container",children:[$&&e.jsx(O,{justify:"center",children:e.jsxs(Y.Title,{level:3,style:{margin:"0"},children:[w," ",t]})}),e.jsxs(O,{align:"middle",style:{flexFlow:""},justify:"space-between",children:[!$&&e.jsx(O,{align:"",children:e.jsxs(Y.Title,{level:3,style:{margin:"0"},children:[w," ",t]})}),e.jsx(O,{style:{},children:e.jsx(Cr,{placeholder:"חיפוש ...",allowClear:!0,onChange:({target:U})=>{c(i==null?void 0:i.filter(ne=>h.some(ee=>{var Q,se,oe;return(oe=(se=(Q=ne[ee])==null?void 0:Q.toString())==null?void 0:se.toLowerCase())==null?void 0:oe.includes(U.value.toLowerCase())})))},style:{width:200}})}),e.jsxs(O,{style:{gap:"0.5em"},children:[x&&e.jsxs(E,{onClick:()=>k(!0),children:[e.jsx(wn,{}),!$&&"סינון","(",Object.keys(j).length,")"]}),!$&&e.jsx(e.Fragment,{children:e.jsx(Ht,{menu:{items:he},trigger:["click"],open:T,onOpenChange:U=>_(U),children:e.jsxs(E,{children:[e.jsx(D,{icon:xn,style:{marginLeft:"8px"}}),$?e.jsx(e.Fragment,{children:`${g.length} / ${u.length}`}):e.jsx(e.Fragment,{children:`בחרת ${g.length} מתוך ${u.length}`})]})})}),e.jsx(Ht,{menu:{items:H},trigger:["click"],children:e.jsxs(E,{type:$?"link":"default",children:[e.jsx(D,{icon:pn,style:{marginLeft:"8px"}}),"מיון"]})}),!$&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{type:"vertical",style:{height:"auto"}}),e.jsx(O,{style:{},children:e.jsx(E,{onClick:()=>Ne("add"),type:"primary",children:m})})]})]})]}),e.jsxs(jt.Group,{trigger:"click",type:"primary",icon:e.jsx(D,{icon:mn}),children:[e.jsx(jt,{type:"primary",onClick:()=>Ne("add"),icon:w}),d==null?void 0:d.map((U,ne)=>e.jsx(Pt.Fragment,{children:U},`float-action-${ne}`))]}),e.jsx(fr,{data:s,tableKeys:[{title:"פעולות",key:"action",minWidth:130,maxWidth:130,render:(U,ne)=>e.jsxs(O,{className:"card-actions",align:"middle",justify:"center",style:{maxWidth:130},children:[e.jsx(E,{type:"text",onClick:()=>ve(ne),children:e.jsx(D,{icon:Qe})}),e.jsx(E,{type:"text",onClick:()=>Ne("edit",ne),children:e.jsx(D,{icon:Ye})}),e.jsx(E,{type:"text",onClick:()=>Ne("view",ne),children:e.jsx(D,{icon:os})})]})},...g],openModal:Ne,mobileKeys:N,type:p,Dtitle:S,Dcontent:L,onDelete:P}),ie&&e.jsx(br,{open:ie,onClose:()=>k(!1),filtersArr:x,filters:A,setFilters:U=>{l(U),a(U),ke()}}),e.jsx(fe,{style:{top:$?"3em":""},title:J==="add"?`הוסף ${r} חדש`:J==="edit"?`ערוך ${r}`:`צפייה ב${r}`,open:v,onCancel:Re,footer:null,destroyOnClose:!0,width:$?"100%":R||600,children:p!=="P"&&e.jsx(wr,{mode:J,groups:n,type:p,tableKeys:g,ingredientsArr:b,fields:u.filter(U=>U.editable||J==="view"),onSubmit:U=>{J==="add"&&I(U),J==="edit"&&F({...re,...U}),Re()},initialValues:re||{},onClose:Re})})]})}const at="https://menu-server-c2b952e2c698.herokuapp.com/api",Sr=t=>X.post(`${at}/categories`,t),Ir=t=>{const r=encodeURIComponent(t._id);return X.put(`${at}/categories/${r}`,t)},Nr=t=>X.delete(`${at}/categories/${t}`),kr=()=>X.get(`${at}/categories`),Is=o.createContext(),Fr=()=>o.useContext(Is),Pr=({children:t})=>{const[r,s]=o.useState(!1),i=async m=>{s(!0);try{await Sr(m),q.success("הקטגוריה נוספה בהצלחה"),s(!1)}catch(c){console.error("Error adding category:",c),q.error("שגיאה בהוספת הקטגוריה"),s(!1)}},n=async m=>{s(!0);try{await Ir(m),q.success("הקטגוריה עודכנה בהצלחה"),s(!1)}catch(c){console.error("Error updating category:",c),q.error("שגיאה בעדכון הקטגוריה"),s(!1)}},u=async m=>{s(!0);try{await Nr(m),q.success("הקטגוריה נמחקה בהצלחה"),s(!1)}catch(c){console.error("Error deleting category:",c),q.error("שגיאה במחיקת הקטגוריה"),s(!1)}};return e.jsx(Is.Provider,{value:{addCategory:i,updateCategory:n,deleteCategory:u,loading:r},children:t})},{Title:Jt,Text:_r}=Y,Tr=({isCategoryModalVisible:t,setIsCategoryModalVisible:r})=>{const{addCategory:s,updateCategory:i,deleteCategory:n}=Fr(),u=V(b=>b.categories),[m,c]=o.useState(""),[h,f]=o.useState(null),[N,S]=o.useState(""),L=()=>{if(m.trim()===""){S("אנא הזן שם קטגוריה תקין");return}if(u.some(b=>b.name===m.trim()&&b!==h)){S("קטגוריה זו כבר קיימת");return}h?i({...h,name:m.trim()}):s({name:m.trim()}),c(""),f(null),S("")},I=b=>{f(b),c(b.name)},F=()=>{if(m.trim()===""){S("אנא הזן שם קטגוריה תקין");return}i({...h,name:m.trim()}),c(""),f(null),S("")},P=b=>{n(b)},R=()=>{c(""),f(null),S(""),r(!1)};return e.jsxs(fe,{title:h?"ערוך קטגוריה":"הוסף קטגוריה חדשה",open:t,onCancel:R,footer:null,className:"category-modal popup-modal",children:[e.jsxs("div",{className:"category-form-section",children:[e.jsx(Jt,{level:4,children:h?"ערוך קטגוריה":"הוסף קטגוריה חדשה"}),e.jsx(xe,{placeholder:"הזן שם קטגוריה",value:m,onChange:b=>c(b.target.value),onPressEnter:L}),N&&e.jsx(_r,{type:"danger",className:"error-message",children:N}),e.jsx(E,{type:"primary",onClick:L,style:{marginTop:"10px"},children:h?"עדכן קטגוריה":"הוסף קטגוריה"})]}),e.jsxs("div",{className:"category-list-section",children:[e.jsx(Jt,{level:4,style:{marginTop:"20px"},children:"קטגוריות קיימות:"}),e.jsx(ue,{dataSource:u,renderItem:b=>e.jsx(ue.Item,{className:h&&h._id===b._id?"editing-item":"",actions:[h&&h._id===b._id?e.jsx(E,{type:"link",onClick:F,children:"שמור"}):e.jsx(E,{type:"link",onClick:()=>I(b),children:"ערוך"}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את הקטגוריה?",onConfirm:()=>P(b._id),okText:"כן",cancelText:"לא",children:e.jsx(E,{icon:e.jsx(_e,{}),type:"text",danger:!0})})],children:h&&h._id===b._id?e.jsx(xe,{value:m,onChange:w=>c(w.target.value),onPressEnter:F,autoFocus:!0}):b.name})})]})]})},{Text:Gt}=Y,Er=({ingredients:t,sizes:r,add:s,remove:i,indexSize:n,form:u,onChange:m,getUnitDisplay:c,setDisabledSave:h})=>{var re,ae,ie;const f=o.useRef(null),[N,S]=o.useState(null),[L,I]=o.useState(!1),[F,P]=o.useState(!1),[R,b]=o.useState(null),[w,d]=o.useState(null),[p,C]=o.useState(""),j=o.useCallback(()=>{setTimeout(()=>{f.current&&f.current.scroll({top:f.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(re=f.current)==null?void 0:re.scrollHeight]),a=k=>{S(k),h(!0)},x=()=>{S(null),h(!1),P(!1),I(!1),C("")},g=()=>{u.validateFields().then(()=>{S(null),h(!1),P(!1),I(!1),C("")})},y=k=>{const A=[...r];A[n]={...A[n],ingredients:k},m(A)},T=(k,A)=>{b({ingredientId:k,unit:A.unit,name:A.label})},_=k=>{d(k)},v=()=>{if(!R||!w)return;const k={...R,quantity:w},l=[...u.getFieldValue("ingredients")||[],k];u.setFieldsValue({ingredients:l}),y(l),b(null),d(null),P(!1),S(null),h(!1),I(!1)},W=k=>{const l=(u.getFieldValue("ingredients")||[]).filter(($,H)=>H!==k);u.setFieldsValue({...l}),y(l),i(k)},J=k=>{if(!k)return"";if(k.name)return k.name;if(k.ingredientId&&t){const A=t.find(l=>l._id===k.ingredientId);return(A==null?void 0:A.name)||""}return""},G=()=>{const k=u.getFieldValue("ingredients");return Array.isArray(k)?k:[]};return o.useEffect(()=>{G().length>0&&j()},[(ae=u.getFieldValue("ingredients"))==null?void 0:ae.length]),e.jsxs(e.Fragment,{children:[F?e.jsxs(O,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsxs(z,{span:10,children:[" ",e.jsx(ce,{placeholder:"בחר רכיב",style:{width:"100%"},filterOption:(k,A)=>{var l;return(l=A==null?void 0:A.label)==null?void 0:l.toLowerCase().includes(k.toLowerCase())},showSearch:!0,options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:T})]}),e.jsxs(z,{span:10,children:[" ",e.jsx(de,{onChange:_,addonAfter:c((R==null?void 0:R.unit)||""),placeholder:"כמות",style:{width:"100%"}})]}),e.jsxs(z,{children:[" ",e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:v}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:x})]})]}):e.jsx(E,{type:"dashed",onClick:()=>{P(!0),I(!0),S(G().length),h(!0)},disabled:N!==null,children:"הוסף מרכיב"}),e.jsx(le,{ref:f,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:(ie=r[n])==null?void 0:ie.ingredients,renderItem:(k,A)=>{var l;return e.jsx(ue.Item,{children:N!==A?e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:2,children:e.jsx(Gt,{children:J(k)})}),e.jsx(B,{flex:1,children:e.jsxs(Gt,{children:[k==null?void 0:k.quantity," ",c(k==null?void 0:k.unit)]})}),e.jsxs(z,{children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ye}),onClick:()=>a(A)}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Qe}),onClick:()=>W(A)})]})]}):!L&&e.jsxs(O,{style:{width:"100%"},gutter:16,children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((l=k.ingredientId)==null?void 0:l._id)||k.ingredientId,children:e.jsx(ce,{placeholder:"בחר רכיב",showSearch:!0,filterOption:($,H)=>{var K;return(K=H==null?void 0:H.label)==null?void 0:K.toLowerCase().includes($.toLowerCase())},options:t==null?void 0:t.map($=>({value:$._id,label:$.name,unit:$.unit})),onChange:T})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(de,{addonAfter:c(k==null?void 0:k.unit),onChange:_})})}),e.jsxs(z,{span:4,children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:g}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:x})]})]})},A)}})})]})},{Text:Xt}=Y,$r=({mixes:t,sizes:r,add:s,remove:i,indexSize:n,form:u,onChange:m,getUnitDisplay:c,setDisabledSave:h})=>{var re,ae,ie;const f=o.useRef(null),[N,S]=o.useState(null),[L,I]=o.useState(!1),[F,P]=o.useState(!1),[R,b]=o.useState(null),[w,d]=o.useState(null),[p,C]=o.useState(""),j=o.useCallback(()=>{setTimeout(()=>{f.current&&f.current.scroll({top:f.current.scrollHeight,behavior:"smooth",duration:2e3})},1e3)},[(re=f.current)==null?void 0:re.scrollHeight]),a=k=>{S(k),h(!0)},x=()=>{S(null),h(!1),P(!1),I(!1),C("")},g=()=>{u.validateFields().then(()=>{S(null),h(!1),P(!1),I(!1),C("")})},y=k=>{const A=[...r];A[n]={...A[n],mixes:k},m(A)},T=(k,A)=>{b({mixId:k,unit:(A==null?void 0:A.unit)||"weight",name:A.label})},_=k=>{d(k)},v=()=>{if(!R||!w)return;const k={...R,quantity:w},l=[...u.getFieldValue("mixes")||[],k];u.setFieldsValue({mixes:l}),y(l),b(null),d(null),P(!1),C(""),S(null),h(!1),I(!1)},W=k=>{const l=(u.getFieldValue("mixes")||[]).filter(($,H)=>H!==k);u.setFieldsValue({...l}),y(l),i(k)},J=k=>{if(!k)return"";if(k.name)return k.name;if(k.mixId&&t){const A=t.find(l=>l._id===k.mixId);return(A==null?void 0:A.name)||""}return""},G=()=>{const k=u.getFieldValue("mixes");return Array.isArray(k)?k:[]};return o.useEffect(()=>{G().length>0&&j()},[(ae=u.getFieldValue("mixes"))==null?void 0:ae.length]),e.jsxs(e.Fragment,{children:[F?e.jsxs(O,{gutter:16,className:"width-100",style:{marginBottom:"1vw"},justify:"space-between",children:[e.jsx(z,{span:10,children:e.jsx(ce,{placeholder:"בחר רכיב",filterOption:(k,A)=>{var l;return(l=A==null?void 0:A.label)==null?void 0:l.toLowerCase().includes(k.toLowerCase())},showSearch:!0,style:{width:"100%"},options:t==null?void 0:t.map(k=>({value:k._id,label:k.name,unit:k.unit})),onChange:T})}),e.jsx(z,{span:10,children:e.jsx(de,{onChange:_,addonAfter:c(p),placeholder:"כמות",style:{width:"100%"}})}),e.jsxs(z,{children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:v}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:x})]})]}):e.jsx(E,{type:"dashed",onClick:()=>{P(!0),I(!0),S(G().length),h(!0)},disabled:N!==null,children:"הוסף מרכיב"}),e.jsx(le,{ref:f,style:{margin:"1vw 0",paddingTop:"1vw",maxHeight:"10vw",overflow:"auto"},children:e.jsx(ue,{dataSource:(ie=r[n])==null?void 0:ie.mixes,renderItem:(k,A)=>{var l;return e.jsx(ue.Item,{children:N!==A?e.jsxs(O,{style:{width:"100%"},align:"middle",justify:"space-between",children:[e.jsx(B,{flex:1,children:e.jsx(Xt,{children:J(k)})}),e.jsx(B,{flex:1,children:e.jsxs(Xt,{children:[k==null?void 0:k.quantity," ",c(k==null?void 0:k.unit)]})}),e.jsxs(O,{children:[e.jsx(E,{type:"text",onClick:()=>a(A),children:e.jsx(D,{icon:Ye})}),e.jsx(E,{type:"text",onClick:()=>W(A),children:e.jsx(D,{icon:Qe})})]})]}):!L&&e.jsxs(e.Fragment,{children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"mixId"],rules:[{required:!0,message:"בחר רכיב"}],initialValue:((l=k.mixId)==null?void 0:l._id)||k.mixId,children:e.jsx(ce,{placeholder:"בחר רכיב",showSearch:!0,filterOption:($,H)=>{var K;return(K=H==null?void 0:H.label)==null?void 0:K.toLowerCase().includes($.toLowerCase())},options:t==null?void 0:t.map($=>({value:$._id,label:$.name,unit:$.unit})),onChange:T})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],initialValue:k.quantity,children:e.jsx(de,{addonAfter:c(k==null?void 0:k.unit),onChange:_})})}),e.jsxs(z,{span:4,children:[e.jsx(E,{type:"text",icon:e.jsx(D,{icon:Ee}),onClick:g}),e.jsx(E,{type:"text",icon:e.jsx(D,{icon:$e}),onClick:x})]})]})},A)}})})]})};function Ar({size:t,sizes:r,indexSize:s,handleCancelEdit:i,handleRemoveSize:n,newSizeId:u,form:m,ingredients:c,mixes:h,onChange:f,getUnitDisplay:N,activeSubTab:S,setActiveSubTab:L,setNewSizeId:I,onSubmit:F}){var w,d;const[P,R]=o.useState(!1),b=async()=>{var p;try{const C=await m.validateFields();I(null),f(r==null?void 0:r.map((j,a)=>a===s?{...j,...C,edit:!1}:j)),F(C)}catch(C){const a=(p=C.errorFields[0])==null?void 0:p.name;a!=null&&a.includes("ingredients")?L("1"):a!=null&&a.includes("mixes")&&L("2")}};return e.jsxs("div",{className:t.idNew===u?"highlight-new":"",style:{border:`1px ${t!=null&&t.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(O,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsxs(B,{flex:2,children:[e.jsx(M.Item,{name:["_id"],hidden:!0,children:e.jsx(xe,{})}),e.jsx(M.Item,{name:["label"],label:"שם הגודל",rules:[{required:!0,message:"חייב למלא שם גודל"},{min:1,message:"שם גודל חייב להיות לפחות 1 תווים"},{max:25,message:"שם גודל לא יכול לחרוג מ-25 תווים"}],children:e.jsx(xe,{placeholder:"שם הגודל",size:"middle",showCount:!0,style:{width:"auto",minWidth:"200px"},maxLength:25})})]}),e.jsxs(B,{flex:1,style:{alignSelf:"flex-start"},justify:"end",children:[e.jsx(E,{type:"text",icon:e.jsx($t,{}),onClick:()=>i(s)}),e.jsx(E,{type:"text",danger:!0,icon:e.jsx(_e,{}),title:"מחק גודל",onClick:()=>n(s)})]})]}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{span:12,children:e.jsx(M.Item,{name:["price"],label:"מחיר",rules:[{required:!0,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(de,{placeholder:"מחיר",style:{width:"100%"},addonAfter:"₪"})})}),e.jsx(z,{span:12,children:e.jsx(M.Item,{label:"זמן הכנה (דקות)",name:["preparationTime"],rules:[{required:!0,message:"חייב לציין זמן הכנה"}],children:e.jsx(de,{placeholder:"זמן הכנה",style:{width:"100%"},addonAfter:e.jsx(D,{style:{fontSize:"0.9em"},icon:Tt})})})})]}),e.jsxs(be,{activeKey:S,onChange:p=>L(p),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:[e.jsxs(Bt,{tab:`מרכיבים (${((w=t==null?void 0:t.ingredients)==null?void 0:w.length)||0})`,children:[e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx(M.List,{name:["ingredients"],children:(p,{add:C,remove:j})=>e.jsx(Er,{add:C,remove:j,fields:p,form:m,indexSize:s,setDisabledSave:R,ingredients:c,onChange:f,getUnitDisplay:N,sizes:r})})]},1),e.jsxs(Bt,{tab:`מתכונים (${((d=t==null?void 0:t.mixes)==null?void 0:d.length)||0})`,children:[e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מתכונים:"}),e.jsx(M.List,{name:["mixes"],children:(p,{add:C,remove:j})=>e.jsx($r,{add:C,remove:j,fields:p,form:m,indexSize:s,setDisabledSave:R,mixes:h,onChange:f,getUnitDisplay:N,sizes:r})})]},2)]}),e.jsx(E,{type:"primary",htmlType:"submit",disabled:P,onClick:()=>b(),children:"שמור"})]},t.idNew||s)}const{Text:Vt}=Y;function Ns({size:t,index:r,sizeInfo:s,type:i,handleEditSize:n,handleRemoveSize:u,ingredients:m,mixes:c,sizeSummary:h,priceExcludingVAT:f}){const N=V(I=>{var F,P;return(P=(F=I.settings.settings)==null?void 0:F.hourlyRate)==null?void 0:P.value}),S=(I,F)=>{const P=I;if(!P)return null;const R=F;return e.jsx(O,{children:e.jsxs(B,{flex:1,style:{flexDirection:"column"},children:[e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:'מחיר ללא מע"מ:'}),e.jsxs(Y.Text,{style:{marginRight:8},children:["₪",R," (₪",((t==null?void 0:t.price)-R).toFixed(2),")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"סך הכל עלות:"}),e.jsxs(Y.Text,{style:{marginRight:8},children:["₪",P==null?void 0:P.totalCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"אחוז רווח:"}),e.jsx(nn,{percent:P==null?void 0:P.profitMargin})]}),i!=="P"&&e.jsxs(le,{type:"inner",title:"עלויות",styles:{header:{minHeight:"0",padding:"5px 20px"}},style:{margin:"15px 0"},children:[e.jsxs(O,{justify:"space-between",style:{marginTop:"1vh"},children:[e.jsx(Y.Text,{strong:!0,children:"עלות עבודה:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.laborCost," (₪",N,")"]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות מרכיבים:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.ingredientCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות מתכונים:"}),e.jsxs(Y.Text,{children:["₪",P==null?void 0:P.mixCost]})]}),e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,children:"עלות הוצאות קבועות:"}),e.jsx(Y.Text,{children:"₪"})]})]})]})})},L=({type:I,size:F,ingredients:P,mixes:R})=>{const[b,w]=o.useState("ingredients"),d=()=>{var j;const C=(j=F==null?void 0:F.ingredients)==null?void 0:j.map(a=>{var y;const x=(()=>{switch(a==null?void 0:a.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((y=P==null?void 0:P.find(T=>(T==null?void 0:T._id)===(a==null?void 0:a.ingredientId)))==null?void 0:y.name)||"לא ידוע",quantity:a==null?void 0:a.quantity,unitDisplay:x,cost:a==null?void 0:a.costForQuantity}});return e.jsx(ue,{dataSource:C,style:{paddingLeft:"20px",margin:"0",maxHeight:"8vw",overflow:"auto"},renderItem:(a,x)=>e.jsx(ue.Item,{style:{marginBottom:"4px"},children:e.jsxs(Vt,{children:[a.name," - ",a.quantity," ",a.unitDisplay," - ₪",a.cost]})},x)})},p=()=>{var j;const C=(j=F==null?void 0:F.mixes)==null?void 0:j.map(a=>{var y;const x=(()=>{switch(a.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return{name:((y=R==null?void 0:R.find(T=>(T==null?void 0:T._id)===(a==null?void 0:a.mixId)))==null?void 0:y.name)||"לא ידוע",quantity:a.quantity,unitDisplay:x,cost:a==null?void 0:a.costForQuantity}});return e.jsx(ue,{dataSource:C,style:{paddingLeft:"20px",margin:"0",maxHeight:"8vw",overflow:"auto"},renderItem:(a,x)=>e.jsx(ue.Item,{style:{marginBottom:"4px"},children:e.jsxs(Vt,{children:[a.name," - ",a.quantity," ",a.unitDisplay," - ₪",a.cost]})},x)})};return e.jsx(e.Fragment,{children:I!=="P"&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{style:{margin:"5px 0"}}),e.jsxs(O,{style:{gap:"1.5vw",height:"10vw"},children:[e.jsx(B,{align:"center",justify:"center",children:e.jsx(rn,{vertical:!0,options:[{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(D,{icon:We}),e.jsx("div",{children:"מרכיבים"})]}),value:"ingredients"},{label:e.jsxs("div",{style:{padding:4},children:[e.jsx(D,{icon:Et}),e.jsx("div",{children:"מתכונים"})]}),value:"mixes"}],onChange:C=>w(C),style:{marginBottom:"12px",direction:""}})}),e.jsx(B,{flex:1,children:e.jsx(le,{style:{width:"100%",backgroundColor:"#f9f9f9",border:"1px solid #d9d9d9",borderRadius:"8px",marginTop:"10px",paddingTop:"10px"},children:b==="ingredients"?d():p()})})]})]})})};return e.jsxs("div",{children:[e.jsx(B,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(z,{className:"width-100",style:{display:"flex",flexDirection:"column",gap:"0.3em"},children:[e.jsx(B,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(O,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,style:{fontSize:"1.6em"},children:t==null?void 0:t.label}),e.jsxs(B,{children:[n&&e.jsx(E,{type:"text",icon:e.jsx(At,{}),onClick:()=>n(r)}),u&&e.jsx(E,{type:"text",danger:!0,icon:e.jsx(_e,{}),onClick:()=>u(r)}),i==="P"&&e.jsx(E,{type:"text",size:"large",icon:e.jsx(cs,{}),onClick:()=>s(r)})]})]})}),e.jsx(B,{flex:1,align:"start",style:{gap:"12px",marginBottom:"8px",flexDirection:"column"},children:e.jsxs(O,{align:"middle",justify:"space-between",style:{width:"100%",gap:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(vt,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:["₪",t==null?void 0:t.price]})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsx(ds,{style:{fontSize:"1.5em",color:"#7f8c8d"}}),e.jsxs(Y.Text,{style:{fontSize:"1.4em",display:"flex",alignItems:"center",gap:"4px"},children:[t==null?void 0:t.preparationTime," דקות"]})]})]})}),S(h,f)]})}),e.jsx(L,{ingredients:m,mixes:c,size:t,type:i})]},t.idNew||r)}Se.locale("he");const Rr=us("employeeHours/buildMonthData",async({selectedDate:t,employees:r,employeeHours:s},{dispatch:i})=>{const n=Se(t,"YYYY-MM").daysInMonth(),u=Array.from({length:n},(m,c)=>{const h=Se(t,"YYYY-MM").date(c+1),f=h.format("dddd"),N=f==="שישי"||f==="שבת",S=r.map(F=>{const P=s.find(b=>{var w;return((w=b==null?void 0:b.employeeId)==null?void 0:w._id)===(F==null?void 0:F._id)&&Se(b==null?void 0:b.date).isSame(h,"day")});if(!P)return null;const R=!P.startTime||!P.endTime;return{hoursId:P._id,employeeId:F._id,name:F.name,hourlyRate:F.hourlyRate,hoursWorked:P.hoursWorked,hours:{start:P.startTime,end:P.endTime},hasError:R}}).filter(Boolean),L=S.reduce((F,P)=>F+P.hoursWorked,0),I=S.length;return{date:h.format("YYYY-MM-DD"),dayOfWeek:f,status:N&&f==="שישי"?"חצי יום":"יום מלא",isPast:h.isBefore(Se(),"day"),isToday:h.isSame(Se(),"day"),employees:S,totalHours:L,employeesCount:I}});i(Mr(u))}),ks=Ie({name:"employeeHours",initialState:{data:[],selectedDate:Se().startOf("month").format("YYYY-MM")},reducers:{setEmployeeHoursState:(t,r)=>{t.data=r.payload},setSelectedDate:(t,r)=>{t.selectedDate=r.payload},addOrUpdateEmployeeHoursState:(t,r)=>{const s=r.payload,i=t.data.findIndex(n=>n._id===s._id);i!==-1?t.data[i]=s:t.data.unshift(s)},updateEmployeeHoursState:(t,r)=>{const s=r.payload;t.data=t.data.map(i=>i._id===s._id?s:i)},deleteEmployeeHoursState:(t,r)=>{const s=r.payload._id;t.data=t.data.filter(i=>i._id!==s)}}}),{setEmployeeHoursState:Mr,addOrUpdateEmployeeHoursState:qr,updateEmployeeHoursState:Lr,deleteEmployeeHoursState:Or,setSelectedDate:Dr}=ks.actions,Ur=ks.reducer,Fs=Ie({name:"products",initialState:[],reducers:{setProductsState:(t,r)=>{const{products:s,ingredientsState:i,mixesState:n,averageHourlyRate:u}=r.payload;return s},addOrUpdateProductState:(t,r)=>{const{newProduct:s,ingredientsState:i,mixesState:n,averageHourlyRate:u}=r.payload,m=s,c=t.findIndex(h=>h._id===s._id);c!==-1?t[c]=m:t.unshift(m)},updateProductState:(t,r)=>{const{updatedProduct:s,ingredientsState:i,mixesState:n,averageHourlyRate:u}=r.payload,m=s;return t.map(c=>c._id===s._id?m:c)},deleteProductState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{setProductsState:Ps,addOrUpdateProductState:bt,updateProductState:Ao,deleteProductState:Hr}=Fs.actions,Br=Fs.reducer,Wr=o.forwardRef(({size:t,indexSize:r,getProductById:s,sizes:i,onChange:n,onDelete:u,newSizeId:m,setSelectedUpdateSize:c,setNewSizeId:h,transformValueToForm:f,setActiveTabKey:N,ingredients:S,mixes:L,sizeSummary:I,priceExcludingVAT:F,activeSubTab:P,setActiveSubTab:R,onSubmit:b},w)=>{const[d]=M.useForm(),p=ze();o.useImperativeHandle(w,()=>({setFieldsValue:g=>d.setFieldsValue(g),getFieldsValue:()=>d.getFieldsValue(),resetFields:()=>d.resetFields()}));const C=()=>{const g=[...i];g[r]={...g[r],edit:!1,ingredients:t.ingredients.filter(y=>y==null?void 0:y._id),mixes:t.mixes.filter(y=>y==null?void 0:y._id)},n(g)},j=g=>{const y=[...i];y[g]={...y[g],edit:!0},n(y),c(g)},a=g=>{const y=i[g];if(y!=null&&y._id)fe.confirm({title:"האם אתה בטוח שברצונך למחוק את הגודל הזה?",content:`המחיקה תסיר לצמיתות את ${y.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{u(y==null?void 0:y.productId,y._id).then(()=>{const T=[...i];T.splice(g,1),n(T),d.setFieldsValue({...T[g]}),N(Math.max(0,g-1).toString()||"0"),s(y==null?void 0:y.productId).then(_=>{p(bt({newProduct:_}))})}).catch(T=>{console.error("Error deleting size:",T)})}});else{const T=[...i];T.splice(g,1),n(T),d.setFieldsValue({...t}),N(Math.max(0,g-1).toString()||"0"),h(null)}},x=g=>{switch(g){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return o.useEffect(()=>{console.log(d.getFieldsValue()),console.log(t)},[d,t]),!(t!=null&&t._id)||t!=null&&t.edit?e.jsx(M,{form:d,initialValues:{...t},children:e.jsx(Ar,{handleCancelEdit:C,handleRemoveSize:a,newSizeId:m,size:t,indexSize:r,onChange:n,form:d,ingredients:S,mixes:L,setNewSizeId:h,setActiveSubTab:R,activeSubTab:P,sizes:i,getUnitDisplay:x,onSubmit:b})}):e.jsx(Ns,{handleEditSize:j,handleRemoveSize:a,index:r,size:t,ingredients:S,mixes:L,priceExcludingVAT:F,sizeSummary:I})}),{TabPane:zr}=be,Zt=o.forwardRef(({value:t=[],onChange:r,getProductById:s,setSelectedUpdateSize:i,ingredients:n,activeTabKey:u,setActiveTabKey:m,mixes:c,onSubmit:h,onDelete:f,sizeSummary:N,priceExcludingVAT:S},L)=>{const[I,F]=o.useState(null),[P,R]=o.useState("1"),b=o.useRef([]),w=p=>({value:p}),d=()=>{var j;const p={idNew:Date.now(),label:`גודל ${t.length+1}`,price:null,preparationTime:null,ingredients:[],mixes:[],edit:!0},C=[...t,p];r(C),(j=b.current[+u])==null||j.setFieldsValue({...p}),F(p.idNew),m(t.length.toString()||"0"),R("1")};return e.jsxs(B,{style:{flexDirection:"column"},children:[e.jsx(E,{type:"default",icon:e.jsx(Rt,{}),onClick:d,children:"הוסף גודל"}),e.jsx(be,{activeKey:u,onChange:p=>m(p||"0"),tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:t==null?void 0:t.map((p,C)=>{var j;return e.jsx(zr,{tab:(p==null?void 0:p.label)||`גודל ${C+1}`,children:e.jsx(Wr,{ref:a=>b.current[C]=a,size:p,indexSize:C,setSelectedUpdateSize:i,sizes:t,onChange:r,onDelete:f,getProductById:s,ingredients:n,transformValueToForm:w,setActiveTabKey:m,setActiveSubTab:R,activeSubTab:P,mixes:c,onSubmit:h,newSizeId:I,setNewSizeId:F,sizeSummary:N&&N[C],priceExcludingVAT:S&&((j=S[C])==null?void 0:j.priceExcludingVAT)})},C.toString())})})]})}),{TabPane:Kt}=be,es=o.forwardRef(({value:t=[],sizes:r,onChange:s,ingredients:i,onSubmit:n,onDelete:u},m)=>{const[c,h]=o.useState(null),[f,N]=o.useState("0"),[S]=M.useForm(),L=()=>({value:t}),I=()=>{const b={idNew:Date.now(),label:`וריאציה - ${t.length+1}`,sizeAdjustments:[...r==null?void 0:r.map(d=>({sizeId:d==null?void 0:d._id,label:d==null?void 0:d.label,priceAdjustment:null,preparationTimeAdjustment:null,ingredients:d==null?void 0:d.ingredients,mixes:d==null?void 0:d.mixes,add:[],remove:[],update:[]}))]},w=[...t,b];s(w),S.setFieldsValue({variations:w}),h(b.idNew),N(t.length.toString())},F=b=>{const w=t[b];if(w!=null&&w._id)fe.confirm({title:"האם אתה בטוח שברצונך למחוק את הוריאציה הזו?",content:`המחיקה תסיר לצמיתות את ${w.label}.`,okText:"מחק",okType:"danger",cancelText:"ביטול",onOk:()=>{u(w==null?void 0:w.productId,w._id).then(()=>{const d=[...t];d.splice(b,1),s(d),S.setFieldsValue({sizes:d}),N(Math.max(0,b-1).toString())}).catch(d=>{console.error("Error deleting vatiation:",d)})}});else{const d=[...t];d.splice(b,1),s(d),S.setFieldsValue(L()),N(Math.max(0,b-1).toString()),h(null)}},P=b=>{const w=[...t];w[b]={...w[b],edit:!0},s(w)},R=b=>{switch(b){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}};return e.jsxs(M,{form:S,initialValues:{variations:t},onFinish:(b,w)=>{var d;n({variations:(d=b==null?void 0:b.variations)==null?void 0:d.filter(p=>p)})},children:[!r.length&&e.jsx(an,{message:"לא ניתן להוסיף וריאציות",description:"יש להוסיף לפחות גודל אחד לפני שניתן להוסיף וריאציות.",type:"warning",showIcon:!0,style:{marginBottom:"16px"}}),e.jsx(E,{type:"default",icon:e.jsx(Rt,{}),disabled:(r==null?void 0:r.length)===0||!r,onClick:I,children:"הוסף וריאציה"}),e.jsx(M.List,{name:["variations","sizeAdjustments"],children:(b,{add:w,remove:d})=>{be,b.map(({key:p,name:C,fieldKey:j})=>{var x;const a=S.getFieldValue(["variations","sizeAdjustments",p]);return e.jsx(Kt,{tab:(a==null?void 0:a.label)||`גודל ${p+1}`,children:!(a!=null&&a._id)||a!=null&&a.edit?e.jsxs("div",{className:a.idNew===c?"highlight-new":"",style:{border:`1px ${a!=null&&a.idNew?"dashed":"solid #e6e6e6"}`,borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[e.jsxs(O,{justify:"space-between",align:"middle",style:{marginBottom:"12px"},children:[e.jsx(M.Item,{name:["variations","sizeAdjustments",p,"_id"],hidden:!0,children:e.jsx(xe,{})}),e.jsx(M.Item,{name:["variations","sizeAdjustments",p,"label"],label:"שם הוריאציה",rules:[{required:!0,message:"חייב למלא שם גודל"}],children:e.jsx(xe,{placeholder:"שם הוריאציה",size:"middle",style:{width:"auto",minWidth:"200px"}})}),e.jsx(E,{type:"text",style:{alignSelf:"flex-start"},danger:!0,icon:e.jsx(_e,{}),title:"מחק וריאציה",onClick:()=>F(p),children:"מחק וריאציה"})]}),e.jsx(M.List,{name:["variations","sizeAdjustments",p],children:(g,{add:y,remove:T})=>e.jsx(be,{tabBarStyle:{direction:"rtl"},style:{margin:"1vw 0"},type:"card",tabPosition:"top",children:g.map(({key:_,name:v,fieldKey:W})=>{const J=S.getFieldValue(["variations",index,"sizeAdjustments",v]);return e.jsxs(Kt,{tab:(J==null?void 0:J.label)||`Size ${v}`,children:[e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{span:12,children:e.jsx(M.Item,{name:["variations",index,"price"],label:"תוספת מחיר",rules:[{required:!1,message:"יש למלא מחיר"},{type:"number",min:0,message:"המחיר חייב להיות חיובי"}],children:e.jsx(de,{placeholder:"מחיר",style:{width:"100%"}})})}),e.jsx(z,{span:12,children:e.jsx(M.Item,{label:"תוספת זמן הכנה (דקות)",name:["sizes",index,"preparationTime"],rules:[{required:!1,message:"חייב לציין זמן הכנה"}],children:e.jsx(de,{placeholder:"זמן הכנה",style:{width:"100%"}})})})]}),e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx(M.List,{name:["sizes",index,"ingredients"],children:(G,{add:re,remove:ae})=>e.jsxs(e.Fragment,{children:[e.jsx(E,{type:"dashed",style:{marginBottom:"0.5vw"},onClick:()=>re({ingredientId:null,quantity:null,unit:null}),children:"הוסף מרכיב"}),e.jsx("div",{style:{maxHeight:"12vw",overflowY:"auto",overflowX:"hidden"},children:G.map(({key:ie,name:k,fieldKey:A})=>e.jsxs(O,{gutter:16,children:[e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[k,"ingredientId"],fieldKey:[A,"ingredientId"],rules:[{required:!0,message:"בחר רכיב"}],children:e.jsx(ce,{placeholder:"בחר מרכיב",showSearch:!0,filterOption:(l,$)=>{var H;return(H=$==null?void 0:$.label)==null?void 0:H.toLowerCase().includes(l.toLowerCase())},options:i.map(l=>({value:l._id,label:l.name,unit:l==null?void 0:l.unit}))})})}),e.jsx(z,{span:10,children:e.jsx(M.Item,{name:[k,"quantity"],fieldKey:[A,"quantity"],rules:[{required:!0,message:"הזן כמות"}],children:e.jsx(de,{placeholder:"כמות",addonAfter:R(S.getFieldValue(["sizes",index,"ingredients",k,"unit"])||"")})})}),e.jsx(z,{span:4,children:e.jsx(E,{type:"text",danger:!0,icon:e.jsx($t,{}),onClick:()=>ae(k)})})]},ie))})]})})]},_)})})}),e.jsx(Z,{style:{margin:"12px 0"}})]},a.idNew||p):e.jsxs("div",{style:{border:"1px solid #e6e6e6",borderRadius:"8px",padding:"16px",background:"#fafafa",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",marginBottom:"16px"},children:[e.jsx(B,{flex:1,style:{padding:"0em 1em"},justify:"space-between",align:"middle",children:e.jsxs(z,{className:"width-100",children:[e.jsx(B,{flex:1,style:{marginBottom:"8px"},children:e.jsxs(O,{className:"width-100",align:"middle",justify:"space-between",children:[e.jsx(Y.Text,{strong:!0,style:{fontSize:"1.2em"},children:size==null?void 0:size.label}),e.jsxs(B,{children:[e.jsx(E,{type:"text",icon:e.jsx(At,{}),onClick:()=>P(index)}),e.jsx(E,{type:"text",danger:!0,icon:e.jsx(_e,{}),onClick:()=>F(index)})]})]})}),e.jsxs(B,{flex:1,align:"middle",style:{gap:"12px",marginBottom:"8px"},children:[e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Y.Text,{style:{color:"#007acc",fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:["₪",size==null?void 0:size.price]}),e.jsx(D,{style:{fontSize:"0.9em",color:"#007acc"},icon:hn})]}),e.jsxs(O,{align:"middle",style:{gap:"8px"},children:[e.jsxs(Y.Text,{style:{fontSize:"1.1em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:[size==null?void 0:size.preparationTime," דקות"]}),e.jsx(D,{style:{fontSize:"0.9em"},icon:Tt})]})]})]})}),e.jsx(Z,{style:{margin:"12px 0"}}),e.jsx(Y.Text,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"מרכיבים:"}),e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:(x=size==null?void 0:size.ingredients)==null?void 0:x.map((g,y)=>{var _;const T=(()=>{switch(g.unit){case"weight":return'ק"ג';case"volume":return"ליטר";case"units":return"יחידות";default:return""}})();return e.jsx("li",{style:{marginBottom:"4px"},children:e.jsxs(Y.Text,{children:[(_=i==null?void 0:i.find(v=>(v==null?void 0:v._id)===(g==null?void 0:g.ingredientId)))==null?void 0:_.name," -"," ",g.quantity," ",T]})},y)})})]},size.idNew||index)},p)})}}),e.jsx(E,{type:"primary",htmlType:"submit",disabled:t.length===0,onClick:()=>h(null),children:"שמור"})]})}),{Title:Ro,Text:ts}=Y,{TabPane:Qr}=be,Yr=({})=>{var _;const{isModalVisible:t,setIsModalVisible:r,modalMode:s,setModalMode:i,selectedItem:n,setSelectedItem:u,selectedUpdateSize:m,setSelectedUpdateSize:c,getProductById:h,addProduct:f,updateProduct:N,deleteProduct:S,addSize:L,updateSize:I,deleteSize:F}=Ss(),P=Ae({query:"(max-width: 500px)"}),R=V(v=>v.categories),b=(_=V(v=>v.ingredients))==null?void 0:_.filter(v=>v==null?void 0:v.is_active),w=V(v=>v.mixes),d=V(v=>v.products),[p,C]=o.useState("0"),j=o.useCallback(()=>{if(!n||!d)return;const v=d.find(W=>W._id===n._id);v&&u({...v})},[n,d]);o.useEffect(()=>{j()},[d]);const[a]=M.useForm(),x=(v,W,J)=>{if(v==="product")switch(W){case"add":return"הוספת מוצר";case"edit":return"עדכון מוצר";case"view":return"צפייה במוצר";default:return"הוספת מוצר"}else switch(v){case"size":return`ניהול גדלים - ${J==null?void 0:J.name}`;case"variation":return`ניהול וריאציות - ${J==null?void 0:J.name}`}};o.useEffect(()=>{n?a.setFieldsValue(n):a.resetFields()},[n]);const g=v=>{var W,J,G,re;switch(t){case"product":const ae=a.getFieldsValue();s==="edit"?N({...ae,_id:n==null?void 0:n._id}).then(()=>{r(!1),u(null)}).catch(A=>{console.error("שגיאה בעריכת מוצר:",A)}):f(ae).then(()=>{r(!1),u(null)}).catch(A=>{console.error("שגיאה בהוספת מוצר:",A)});break;case"size":const ie=v,k={productId:n==null?void 0:n._id,label:ie.label,price:ie.price,preparationTime:ie.preparationTime,ingredients:((J=(W=ie.ingredients)==null?void 0:W.filter(A=>A))==null?void 0:J.map(A=>{var l;return{ingredientId:((l=A.ingredientId)==null?void 0:l._id)||A.ingredientId,quantity:A.quantity,unit:A.unit}}))||[],mixes:((re=(G=ie.mixes)==null?void 0:G.filter(A=>A))==null?void 0:re.map(A=>({mixId:A.mixId,quantity:A.quantity,unit:A.unit})))||[],_id:ie._id};new Promise((A,l)=>k._id?I(k._id,k):L(n==null?void 0:n._id,k)).then(()=>{}).catch(A=>{console.error("Error managing sizes:",A)});break}},y=()=>{switch(t){case"product":return e.jsxs(M,{form:a,layout:"vertical",onFinish:g,children:[e.jsx(M.Item,{name:"name",label:"שם מוצר",rules:[{required:!0,message:"אנא הזן שם מוצר"},{max:25,message:"שם המוצר לא יכול להיות יותר מ-25 תווים"}],children:e.jsx(xe,{maxLength:25,showCount:!0})}),e.jsx(M.Item,{name:"category",label:"קטגוריה",rules:[{required:!0,message:"אנא בחר קטגוריה"}],children:e.jsx(ce,{showSearch:!0,placeholder:"בחר קטגוריה",optionFilterProp:"children",filterOption:(v,W)=>W.children.toLowerCase().indexOf(v.toLowerCase())>=0,children:R.map(v=>e.jsx(ce.Option,{value:v._id,children:v==null?void 0:v.name},v._id))})}),e.jsx(M.Item,{name:"isFeatured",label:"פעיל",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx(M.Item,{name:"isOnSale",label:"מוצר מכירה",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})}),e.jsx(M.Item,{name:"notes",label:"הערות",rules:[{required:!1,message:"אנא הזן הערות"},{max:250,message:"ההערות לא יכולות להיות יותר מ-250 תווים"}],children:e.jsx(xe.TextArea,{rows:4,maxLength:250,showCount:!0})}),e.jsx(M.Item,{children:e.jsx(E,{type:"primary",htmlType:"submit",children:"שמור מוצר"})})]});case"size":return e.jsx(Zt,{value:n==null?void 0:n.sizes,setValue:u,ingredients:b,sizeSummary:n==null?void 0:n.sizeSummary,setSelectedUpdateSize:c,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,getProductById:h,mixes:w,onDelete:F,activeTabKey:p,setActiveTabKey:C,onSubmit:g,onChange:v=>u({...n,sizes:v})});case"variation":return e.jsx(es,{value:n==null?void 0:n.variations,form:formVariation,setValue:u,sizes:n==null?void 0:n.sizes,ingredients:b,onChange:v=>u({...n,variations:v})});default:return null}},T=()=>{var v,W,J;switch(t){case"product":return e.jsxs("div",{styles:{body:{display:"flex",flexDirection:"column"}},children:[e.jsxs(B,{style:{gap:"1em",flexDirection:"column",margin:"1em 0em"},children:[e.jsx(ts,{strong:!0,style:{fontSize:"1.5em"},children:n==null?void 0:n.name}),e.jsx(Pe,{style:{width:"fit-content"},children:(v=R==null?void 0:R.find(G=>G._id===(n==null?void 0:n.category)))==null?void 0:v.name}),e.jsxs(B,{style:{gap:"0.5em",flexDirection:"column"},children:[e.jsx(Ke,{status:n!=null&&n.isFeatured?"success":"default",text:n!=null&&n.isFeatured?"פעיל":"לא פעיל"}),e.jsx(Ke,{status:n!=null&&n.isOnSale?"processing":"default",text:n!=null&&n.isOnSale?"במבצע":"לא במבצע"})]})]}),((W=n==null?void 0:n.notes)==null?void 0:W.length)>0&&e.jsxs("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(B,{flex:1,children:e.jsxs(ts,{strong:!0,children:["הערות",":"]})}),e.jsx(B,{flex:1,children:e.jsx("p",{style:{},children:n==null?void 0:n.notes})})]}),e.jsx(B,{flex:1,children:e.jsx(be,{style:{width:"100%"},type:"card",children:(J=n==null?void 0:n.sizes)==null?void 0:J.map((G,re)=>e.jsx(Qr,{tab:G.label,children:e.jsx(Ns,{handleEditSize:!1,handleRemoveSize:!1,index:re,size:G,type:"P",sizeInfo:ae=>{r("size"),C((ae==null?void 0:ae.toString())||"0")},ingredients:b,mixes:w,priceExcludingVAT:(n==null?void 0:n.priceExcludingVAT)&&(n==null?void 0:n.priceExcludingVAT[re].priceExcludingVAT),sizeSummary:(n==null?void 0:n.sizeSummary)&&(n==null?void 0:n.sizeSummary[re])})},re))})})]});case"size":return e.jsx(Zt,{value:n==null?void 0:n.sizes,setValue:u,ingredients:b,sizeSummary:n==null?void 0:n.sizeSummary,priceExcludingVAT:n==null?void 0:n.priceExcludingVAT,setSelectedUpdateSize:c,getProductById:h,mixes:w,onDelete:F,activeTabKey:p,setActiveTabKey:C,onSubmit:g,onChange:G=>u({...n,sizes:G})});case"variation":return e.jsx(es,{value:n==null?void 0:n.variations,mode:"view",ingredients:b,onChange:G=>u({...n,variations:G})});default:return null}};return e.jsx(fe,{style:{top:P?"3em":""},title:x(t,s,n),open:t,onCancel:()=>{r(!1),u()},footer:null,destroyOnClose:!0,width:P?"100%":600,styles:{gap:"0.5em"},children:s==="view"?T():y()})},Jr=({categories:t,isMobile:r,selectedCategory:s,setSelectedCategory:i,setIsCategoryModalVisible:n})=>{const u=o.useRef(null),m=o.useRef({}),c=()=>{u.current.scrollBy({left:200,behavior:"smooth"})},h=()=>{u.current.scrollBy({left:-200,behavior:"smooth"})},f=N=>{i(N),m.current[N]&&m.current[N].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})};return e.jsx("div",{style:{padding:"16px",backgroundColor:"#f0f2f5"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(E,{icon:e.jsx(bn,{}),onClick:c}),e.jsxs("div",{ref:u,style:{display:"flex",overflowX:"auto",flexGrow:1,gap:"8px",padding:"8px 0",scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx(E,{type:s==="all"?"primary":"default",onClick:()=>f("all"),children:"הכל"}),t.map(N=>e.jsx(E,{ref:S=>m.current[N._id]=S,type:s===N._id?"primary":"default",onClick:()=>f(N._id),children:N.name},N._id))]}),e.jsx(E,{icon:e.jsx(Cn,{}),onClick:h}),!r&&e.jsx(E,{type:"primary",icon:e.jsx(Rt,{}),onClick:()=>n(!0)})]})})};function Gr(){var T;const{addProduct:t,updateProduct:r,deleteProduct:s,isModalVisible:i,setIsModalVisible:n,modalMode:u,setModalMode:m,selectedItem:c,setSelectedItem:h}=Ss(),f=Ae({query:"(max-width: 500px)"});o.useRef(null);const[N,S]=o.useState([]),[L,I]=o.useState([]),[F,P]=o.useState("all"),[R,b]=o.useState(!1),[w,d]=o.useState({}),p=V(_=>_.products),C=V(_=>_.categories),j=(T=V(_=>_.ingredients))==null?void 0:T.filter(_=>_==null?void 0:_.is_active),a=["name","category"],x=["name","category","detailes","sizes","productSummary","actions"],g=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"category",dataIndex:"category",title:"קטגוריה"},{key:"profitMargin",dataIndex:"profitMargin",title:"אחוז רווח"}],y=o.useMemo(()=>[{key:"name",dataIndex:"name",title:"שם המוצר",editable:!0,type:"text",rules:[{required:!0,message:"חייב להיות שם מוצר"},{min:2,message:"שם חייב להיות לפחות 2 תווים"}]},{key:"category",dataIndex:"category",title:"קטגוריה",editable:!0,type:"select",render:(_,v)=>{var W;return e.jsx(Pe,{children:(W=C==null?void 0:C.find(J=>J._id===(v==null?void 0:v.category)))==null?void 0:W.name})},options:C.map(_=>({value:_._id,label:_.name})),rules:[{required:!0,message:"יש לבחור קטגוריה"}]},{key:"detailes",dataIndex:"actions",width:100,render:(_,v)=>e.jsxs(O,{style:{gap:"0.5em"},align:"middle",justify:"center",children:[e.jsx(Pe,{className:v!=null&&v.isFeatured?"green":"red",children:v!=null&&v.isFeatured?"פעיל":"לא פעיל"}),e.jsx(Pe,{className:v!=null&&v.isOnSale?"blue":"yellow",children:v!=null&&v.isOnSale?"במבצע":"לא במבצע"})]})},{key:"sizes",title:"גדלים",type:"custom",editable:!0,render:(_,v,W="view",J)=>{var G;return(G=v==null?void 0:v.sizes)==null?void 0:G.length}},{key:"variations",title:"ווריאציות",type:"custom",editable:!0,render:(_,v,W="view",J)=>{var G;return(G=v==null?void 0:v.variations)==null?void 0:G.length}},{key:"productSummary",dataIndex:"productSummary",title:"אחוז רווח (ממוצע)",width:150,render:(_,v)=>{var W;return`${((W=v==null?void 0:v.productSummary)==null?void 0:W.averageProfitMargin)||0}%`}},{key:"actions",dataIndex:"actions",width:200,render:(_,v)=>e.jsx("div",{className:"",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(E,{type:"text",onClick:()=>{n("size"),h(v)},children:[e.jsx("p",{children:"גדלים"}),e.jsx(D,{icon:et})]})})}],[C]);return C==null||C.map(_=>({label:_.name,value:_._id})),o.useEffect(()=>{const _=JSON.parse(localStorage.getItem("filtersMenu")||"{}");d(_)},[]),o.useEffect(()=>{if(p){const _=F&&F!=="all"?p.filter(v=>v.category===F):p;S(_),I(_)}},[p,F]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",maxWidth:"100%",height:"100%",width:"100%",overflow:"hidden","- webkit - overflow - scrolling":"touch"},children:[e.jsx(Jr,{categories:C,isMobile:f,selectedCategory:F,setIsCategoryModalVisible:b,setSelectedCategory:P}),e.jsx(B,{flex:1,children:e.jsx(rt,{title:"תפריט",type:"P",data:N,mobileKeys:x,dataPrint:L,sortKeys:g,tableKeys:y,newTitle:"הוסף מוצר חדש",searchKeys:a,setDataPrint:I,onAdd:t,onEdit:r,onDelete:s,ingredientsArr:j,Dtitle:"אישור מחיקה",Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את המוצר?"}),e.jsx("p",{children:"שים לב! מחיקת מוצר עשויה להשפיע על מכירות ותערובות קשורות."})]}),iconADD:e.jsx(D,{icon:tt}),floatAction:[e.jsx(jt,{type:"primary",onClick:()=>b(!0),icon:e.jsx(D,{icon:et})})],openModalProduct:(_,v)=>{n("product"),m(_),v&&h(v)}})}),e.jsx(Tr,{isCategoryModalVisible:R,setIsCategoryModalVisible:b}),e.jsx(Yr,{})]})}const it="https://menu-server-c2b952e2c698.herokuapp.com/api",Xr=t=>X.post(`${it}/suppliers`,t),Vr=t=>{const r=encodeURIComponent(t._id);return X.put(`${it}/suppliers/${r}`,t)},Zr=t=>X.delete(`${it}/suppliers/${t}`),Kr=()=>X.get(`${it}/suppliers`),_s=o.createContext(),ea=()=>o.useContext(_s),ta=({children:t})=>{const[r,s]=o.useState(!1),i=async m=>{s(!0);try{await Xr(m),q.success("הספק נוסף בהצלחה"),s(!1)}catch(c){console.error("Error adding supplier:",c),q.error("שגיאה בהוספת הספק"),s(!1)}},n=async m=>{s(!0);try{await Vr(m),q.success("הספק עודכן בהצלחה"),s(!1)}catch(c){console.error("Error updating supplier:",c),q.error("שגיאה בעדכון הספק"),s(!1)}},u=async m=>{s(!0);try{await Zr(m),q.success("הספק נמחק בהצלחה"),s(!1)}catch(c){console.error("Error deleting supplier:",c),q.error("שגיאה במחיקת הספק"),s(!1)}};return e.jsx(_s.Provider,{value:{addSupplier:i,updateSupplier:n,deleteSupplier:u,loading:r},children:t})};function sa(){const{addSupplier:t,updateSupplier:r,deleteSupplier:s}=ea(),i=V(b=>b.suppliers),n=V(b=>b.ingredients),[u,m]=o.useState([]),[c,h]=o.useState([]),[f,N]=o.useState({}),S=["name"],L=["name","phone","email","contact_name","address",,"second_phone","notes"],I=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים"}],F=[{key:"name",dataIndex:"name",title:"שם הספק",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות שם ספק"},{min:3,message:"שם ספק חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"כמות רכיבים",editable:!1},{key:"phone",dataIndex:"phone",title:"טלפון",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות מספר טלפון"},{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"email",dataIndex:"email",title:"אימייל",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות אימייל"},{type:"email",message:"אימייל לא תקין"}]},{key:"contact_name",dataIndex:"contact_name",title:"איש קשר",editable:!0,type:"text",width:100,rules:[{required:!0,message:"חייב להיות איש קשר"},{min:3,message:"איש קשר חייב להיות לפחות 3 תווים"}]},{key:"address",dataIndex:"address",title:"כתובת",editable:!0,type:"text",width:150,rules:[{required:!0,message:"חייבת להיות כתובת"},{min:5,message:"כתובת חייבת להיות לפחות 5 תווים"}]},{key:"second_phone",dataIndex:"second_phone",title:"טלפון נוסף",editable:!0,type:"text",width:100,rules:[{pattern:/^[0-9]{9,10}$/,message:"טלפון חייב להיות מספר תקין באורך 9-10 ספרות"}]},{key:"notes",dataIndex:"notes",title:"הערות",editable:!0,type:"textArea",maxLength:120,width:150,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}],render:(b,w)=>{const d=(w==null?void 0:w.notes)||"—";return e.jsx(st,{title:d,children:e.jsx("span",{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px"},children:d})})}}],P=[{name:"רשימת ספקים",value:"name",type:"select",options:i.map(b=>({label:b.name,value:b.name}))},{name:"סטטוס רכיבים",value:"usedCount",type:"slider",min:0,max:Math.max(...u.map(b=>b.usedCount||0))}];o.useEffect(()=>{if(i){const b=i.map(w=>{const d=n==null?void 0:n.filter(p=>p.supplierId===w._id).length;return{...w,usedCount:d}});m(b),h(b)}},[i,n]),o.useEffect(()=>{const b=JSON.parse(localStorage.getItem("filtersSuppliers")||"{}");N(b)},[]);const R=b=>{N(b),localStorage.setItem("filtersSuppliers",JSON.stringify(b))};return e.jsx(rt,{title:"ספקים",titleView:"ספק",data:u,mobileKeys:L,dataPrint:c,sortKeys:I,tableKeys:F,newTitle:"הוסף ספק חדש",searchKeys:S,setDataPrint:h,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",filters:f,saveFilters:R,filtersArr:P,iconADD:e.jsx(D,{icon:nt}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הספק?"}),e.jsx("p",{children:"שים לב! במחיקת ספק אתה תמחוק את כל הרכיבים שלו וכן הם כמובן ימחקו מכל התערובות והמוצרים."})]})})}const lt="https://menu-server-c2b952e2c698.herokuapp.com/api",na=t=>X.post(`${lt}/ingredients`,t),ra=t=>{const r=encodeURIComponent(t._id);return X.put(`${lt}/ingredients/${r}`,t)},aa=t=>X.delete(`${lt}/ingredients/${t}`),ia=()=>X.get(`${lt}/ingredients`),Ts=o.createContext(),la=()=>o.useContext(Ts),oa=({children:t})=>{const[r,s]=o.useState(!1),i=async m=>{s(!0);try{await na(m),q.success("החומר גלם נוסף בהצלחה"),s(!1)}catch{q.error("שגיאה בהוספת חומר הגלם"),s(!1)}},n=async m=>{s(!0);const c=["unitQuantity","unitDescription","unitPrice","processedPrice"],h=Object.keys(m).filter(f=>!c.includes(f)).reduce((f,N)=>(f[N]=m[N],f),{});try{await ra(h),q.success("החומר גלם עודכן בהצלחה")}catch{q.error("שגיאה בעדכון חומר הגלם")}finally{s(!1)}},u=async m=>{s(!0);try{await aa(m),q.success("החומר גלם נמחק בהצלחה"),s(!1)}catch{q.error("שגיאה במחיקת חומר הגלם"),s(!1)}};return e.jsx(Ts.Provider,{value:{addIngredient:i,updateIngredient:n,deleteIngredient:u,loading:r},children:t})},Je="https://menu-server-c2b952e2c698.herokuapp.com/api",da=()=>X.get(`${Je}/settings`),ca=t=>X.put(`${Je}/settings`,{settings:t}),ua=t=>X.post(`${Je}/settings/categories`,t),xa=(t,r)=>X.put(`${Je}/settings/categories/${t}`,r),pa=t=>X.delete(`${Je}/settings/categories/${t}`),Es=Ie({name:"settings",initialState:{settings:null,loading:!1},reducers:{setSettings:(t,r)=>{t.settings=r.payload},updateSettingValue:(t,r)=>{const{key:s,value:i}=r.payload;t.settings&&t.settings[s]&&(t.settings[s].value=i,t.settings[s].lastUpdated=new Date().toISOString())},addCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value.push(s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},updateCategory:(t,r)=>{const s=r.payload;if(t.settings&&t.settings.materialCategories){const i=t.settings.materialCategories.value.findIndex(n=>n._id===s._id);i!==-1&&(t.settings.materialCategories.value[i]=s,t.settings.materialCategories.lastUpdated=new Date().toISOString())}},deleteCategory:(t,r)=>{const s=r.payload;t.settings&&t.settings.materialCategories&&(t.settings.materialCategories.value=t.settings.materialCategories.value.filter(i=>i._id!==s),t.settings.materialCategories.lastUpdated=new Date().toISOString())},setLoading:(t,r)=>{t.loading=r.payload}}}),{setSettings:ma,updateSettingValue:Mo,addCategory:ha,updateCategory:ga,deleteCategory:ja,setLoading:je}=Es.actions,fa=Es.reducer,$s=o.createContext(),As=()=>o.useContext($s),ya=({children:t})=>{const r=ze(),{settings:s,loading:i}=V(f=>f.settings),n=async()=>{r(je(!0));try{const{data:f}=await da();r(ma(f))}catch(f){console.error("Error fetching settings:",f)}finally{r(je(!1))}},u=async f=>{var N;r(je(!0));try{await ca(f);const[S]=await Promise.all([bs()]);r(Ps({products:(N=S.data)==null?void 0:N.reverse()})),q.success("הגדרות נשמרו בהצלחה"),r(je(!1))}catch{q.error("שגיאה בשמירת ההגדרות"),r(je(!1))}},m=async f=>{r(je(!0));try{const{data:N}=await ua(f);r(ha(N)),q.success("הקטגוריה נוספה בהצלחה")}catch(N){console.error("Error adding category:",N),q.error("שגיאה בהוספת הקטגוריה")}finally{r(je(!1))}},c=async(f,N)=>{r(je(!0));try{await xa(f,N),r(ga(N)),q.success("הקטגוריה עודכנה בהצלחה")}catch(S){console.error("Error updating category:",S),q.error("שגיאה בעדכון הקטגוריה")}finally{r(je(!1))}},h=async f=>{r(je(!0));try{await pa(f),r(ja(f)),q.success("הקטגוריה נמחקה בהצלחה")}catch(N){console.error("Error deleting category:",N),q.error("שגיאה במחיקת הקטגוריה")}finally{r(je(!1))}};return o.useEffect(()=>{n()},[]),e.jsx($s.Provider,{value:{settings:s,loading:i,fetchSettings:n,updateSetting:u,addCategoryContext:m,updateCategoryContext:c,deleteCategoryContext:h},children:t})},{Text:va}=Y;function wa(){var C;const{settings:t}=As(),r=o.useMemo(()=>{var j,a;return((a=(j=t==null?void 0:t.materialCategories)==null?void 0:j.value)==null?void 0:a.map(x=>({value:x==null?void 0:x._id,label:x==null?void 0:x.name,color:(x==null?void 0:x.color)||"blue"})))||[]},[(C=t==null?void 0:t.materialCategories)==null?void 0:C.value]),s=V(j=>j.suppliers),i=V(j=>j.ingredients),n=V(j=>j.products),u=V(j=>j.mixes),{addIngredient:m,updateIngredient:c,deleteIngredient:h}=la(),[f,N]=o.useState([]),[S,L]=o.useState([]),[I,F]=o.useState({});o.useState(!1);const P=["name","type","supplierId"],R=["unit","unitPrice","supplierId","usedInMixes","usedInProducts"],b=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"type",dataIndex:"type",title:"סוג"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"},{key:"unit",dataIndex:"unit",title:"יחידת מידה"},{key:"supplierName",dataIndex:"supplierName",title:"שם ספק"}],w=[{key:"SKU",dataIndex:"SKU",title:'מק"ט',editable:!0,type:"number",width:100,group:1,rules:[{validator:async(j,a,x)=>a?typeof a!="number"?Promise.reject('מק"ט חייב להיות מספר תקין'):a.toString().length===0?Promise.reject('מק"ט חייב להיות מינימום תו אחד '):f.some(y=>y.SKU===a&&y._id!==(x==null?void 0:x._id))?Promise.reject('מק"ט זה כבר קיים במערכת'):Promise.resolve():Promise.resolve()}]},{key:"name",dataIndex:"name",title:"שם",required:!0,editable:!0,group:1,type:"text",width:200,minWidth:200,rules:[{required:!0,message:"השדה חובה"},{min:3,message:"השם חייב להיות לפחות 3 תווים"},{pattern:/^[א-תa-zA-Z\s0-9%-]+$/,message:"השם יכול להכיל אותיות בעברית או אנגלית, מספרים והתווים הבאים: ' % ', ' - '"}]},{key:"supplierId",dataIndex:"supplierId",title:"שם ספק",editable:!0,group:1,type:"select",required:!0,width:100,render:(j,a,x)=>{var g;return e.jsxs(O,{align:"middle",style:{gap:5},children:[x==="view"&&e.jsx(D,{icon:nt})," ",(g=s==null?void 0:s.find(y=>(y==null?void 0:y._id)===(a==null?void 0:a.supplierId)))==null?void 0:g.name]})},options:s==null?void 0:s.map(j=>({value:j._id,label:j==null?void 0:j.name})),rules:[{required:!0,message:"יש לבחור ספק"},{validator:(j,a)=>(s==null?void 0:s.some(g=>g._id===a))?Promise.resolve():Promise.reject("ספק לא חוקי נבחר")}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"is_active",dataIndex:"is_active",title:"פעיל",editable:!0,group:1,type:"custom",render:(j,a,x,g)=>x==="edit"?e.jsx(e.Fragment,{children:e.jsx(M.Item,{name:"is_active",label:"פעיל",children:e.jsx(ft,{checkedChildren:"פעיל",unCheckedChildren:"לא פעיל"})},"is_active")}):e.jsx(Ke,{status:a!=null&&a.is_active?"success":"error",text:a!=null&&a.is_active?"פעיל":"לא פעיל"}),minWidth:120,width:120},{key:"type",dataIndex:"type",title:"סוג",render:(j,a)=>{const x=r.find(g=>g.value===(a==null?void 0:a.type));return e.jsx(Pe,{color:x==null?void 0:x.color,children:x==null?void 0:x.label})},type:"select",required:!0,editable:!0,group:2,options:r,divider:!0,width:100,rules:[{required:!0,message:"יש לבחור סוג"},{validator:(j,a)=>(r==null?void 0:r.some(g=>g.value===a))?Promise.resolve():Promise.reject("סוג לא חוקי נבחר")}]},{key:"unit",dataIndex:"unit",title:"יחידת מידה",editable:!0,group:2,type:"select",options:we,width:100,render:(j,a)=>{var x;return e.jsx("p",{children:((x=we.find(g=>g.value===(a==null?void 0:a.unit)))==null?void 0:x.label)||(a==null?void 0:a.unit)})},rules:[{required:!0,message:"יש לבחור יחידת מידה"},{validator:(j,a)=>(we==null?void 0:we.some(g=>g.value===a))?Promise.resolve():Promise.reject("יחידת מידה לא חוקית")}]},{key:"quantity",dataIndex:"quantity",title:"כמות",editable:!0,group:2,type:"custom",width:100,render:(j,a,x,g)=>{if(x=="edit")return e.jsx(M.Item,{name:"quantity",label:"כמות",rules:[{required:!0,message:"אנא הזן כמות"},{validator:(_,v)=>(g.getFieldValue("subUnit"),v==null?Promise.reject("כמות נדרשת"):v<0?Promise.reject("הכמות לא יכולה להיות שלילית"):(g.getFieldValue("subUnit")==="g"||g.getFieldValue("subUnit")==="ml")&&(v<.001||v>999)?Promise.reject('עבור גרם או מ"ל הכמות חייבת להיות בין 0.001 ל-999'):(g.getFieldValue("subUnit")==="kg"||g.getFieldValue("subUnit")==="liter")&&(v<1||v>1e6)?Promise.reject('עבור ק"ג או ליטר הכמות חייבת להיות מ-1 ומעלה, ובתוך הטווח המותר'):Promise.resolve())}],children:e.jsx(de,{style:{width:"100%"}})},"quantity");let y=a.unit,T="";return y==="weight"?T=a.quantity>=1?'ק"ג':"גרם":y==="volume"?T=a.quantity>=1?"ליטר":'מ"ל':y==="units"&&(T="יחידות"),e.jsxs("p",{children:[a.quantity<1?a.quantity*1e3:a.quantity," ",T]})}},{key:"price",dataIndex:"price",title:"מחיר כולל מעמ",editable:!0,group:2,type:"price",width:100,show:!1,divider:!0,render:(j,a,x,g)=>{var y;if(x!=="edit")return e.jsxs("p",{children:["₪",(y=a==null?void 0:a.price)==null?void 0:y.toFixed(2)]})}},{key:"priceExcludingVAT",dataIndex:"priceExcludingVAT",width:100,title:"מחיר ללא מעמ",render:(j,a)=>e.jsxs("p",{children:["₪",a==null?void 0:a.priceExcludingVAT]}),editable:!1,hiddenInForm:!0},{key:"unitPrice",dataIndex:"unitPrice",title:"כמות מינימלית",width:100,render:(j,a)=>e.jsxs(z,{children:[e.jsxs(O,{children:[e.jsxs("p",{children:[a.unitQuantity<1?a.unitQuantity*1e3:a.unitQuantity," ",a==null?void 0:a.unitDescription]}),e.jsx("br",{})]}),e.jsxs("p",{children:["₪",a==null?void 0:a.unitPrice]})]})},{key:"juiceRatio",dataIndex:"juiceRatio",title:"יחס עיבוד (תפוקת חומר מעובד)",editable:!0,group:2,width:100,type:"custom",render:(j,a,x,g)=>x=="view"||x!=="edit"?e.jsx("p",{children:a!=null&&a.juiceRatio?`${((a==null?void 0:a.juiceRatio)*100).toFixed(0)}%`:""}):e.jsxs(e.Fragment,{children:[e.jsx(M.Item,{name:"isJuice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(Be,{onChange:y=>{g.setFieldsValue({isJuice:y.target.checked}),y.target.checked||g.setFieldsValue({juiceRatio:void 0})},children:"האם הרכיב דורש עיבוד?"})}),e.jsx(M.Item,{noStyle:!0,shouldUpdate:(y,T)=>y.isJuice!==T.isJuice,children:({getFieldValue:y})=>y("isJuice")&&e.jsx(M.Item,{name:"juiceRatio",label:"יחס המיץ (0.1 עד 0.99)",rules:[{required:!0,message:"אנא הזן יחס מיץ"},{type:"number",min:.1,max:.99,message:"היחס חייב להיות בין 0.1 ל-0.99"}],children:e.jsx(de,{style:{width:"100%"}})})})]})},{key:"processedPrice",dataIndex:"processedPrice",title:"מחיר לכמות מינימלית מעובדת",width:100,render:(j,a)=>e.jsx("p",{children:a!=null&&a.processedPrice?`₪${a==null?void 0:a.processedPrice}`:""}),editable:!1,hiddenInForm:!0},{key:"notes",dataIndex:"notes",title:"הערות",width:100,editable:!0,group:1,render:(j,a)=>{const x=(a==null?void 0:a.notes)||"—";return e.jsx(st,{title:x,children:e.jsx(va,{style:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"150px",direction:"rtl"},children:x})})},type:"textArea",maxLength:120,rules:[{required:!1},{max:120,message:"מקסימום 120 תווים"}]}],d=[{name:"סוג",value:"type",options:r},{name:"ספק",value:"supplierId",options:s.map(j=>({label:j.name,value:j._id}))},{name:"סטטוס",value:"is_active",options:[{label:"פעיל",value:!0},{label:"לא פעיל",value:!1}]}];o.useEffect(()=>{if(i)if(s){let j=[...i==null?void 0:i.map(a=>{let x=s==null?void 0:s.find(T=>(T==null?void 0:T._id)===(a==null?void 0:a.supplierId));const g=(n==null?void 0:n.reduce((T,_)=>{var v;return T+((v=_.ingredients)==null?void 0:v.filter(W=>W.ingredientId===a._id).length)},0))||0,y=(u==null?void 0:u.reduce((T,_)=>{var v;return T+((v=_.ingredients)==null?void 0:v.filter(W=>W.ingredientId===a._id).length)},0))||0;return{...a,supplierName:x==null?void 0:x.name,usedCount:g+y}})];N(j),L(j)}else N([...i]),L([...i])},[s,i]),o.useEffect(()=>{const j=JSON.parse(localStorage.getItem("filtersIngredients")||"{}");F(j)},[]);const p=j=>{F(j),localStorage.setItem("filtersIngredients",JSON.stringify(j))};return e.jsx(e.Fragment,{children:e.jsx(rt,{title:"חומרי גלם",titleView:"חומר גלם",type:"ingredient",data:f,groups:!0,mobileKeys:R,dataPrint:S,sortKeys:b,tableKeys:w,newTitle:"הוסף חומר גלם חדש",searchKeys:P,setDataPrint:L,onAdd:m,onEdit:c,onDelete:h,Dtitle:"אישור מחיקה",filters:I,saveFilters:p,filtersArr:d,iconADD:e.jsx(D,{icon:We}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את הרכיב?"}),e.jsx("p",{children:"שים לב! הרכיב יימחק מכל המוצרים והתערובות בהם הוא נמצא."})]})})})}Fn.register(Pn,_n,Tn,En,$n,An);const{Text:ba}=Y,Ca=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F"];function Sa(){const t=V(I=>I.categories),r=V(I=>I.products),s=V(I=>I.suppliers),i=V(I=>I.ingredients),n=V(I=>I.mixes),u=V(I=>I.employees),m=Ae({query:"(max-width: 500px)"}),c=o.useMemo(()=>{const I=r.reduce((F,P)=>{var b;const R=((b=t.find(w=>w._id===P.category))==null?void 0:b.name)||"לא מוגדר";return F[R]=(F[R]||0)+1,F},{});return{labels:Object.keys(I),datasets:[{data:Object.values(I),backgroundColor:Ca}]}},[r,t]),h=o.useMemo(()=>[...i].sort((I,F)=>(F.unitPrice||0)-(I.unitPrice||0)).slice(0,5).map(I=>({name:I.name,price:I.unitPrice})),[i]),f=o.useMemo(()=>[...n].map(I=>{const F=I.totalCost/I.totalWeight;return{name:I.name,costPerLiter:F}}).sort((I,F)=>(F.costPerLiter||0)-(I.costPerLiter||0)).slice(0,5),[n]),N={labels:h.map(I=>I.name),datasets:[{label:"מחיר ל-100 גרם",data:h.map(I=>I.price),backgroundColor:"#FF8042"}]},S={labels:f.map(I=>I.name),datasets:[{label:"עלות לליטר",data:f.map(I=>I.costPerLiter),backgroundColor:"#8884d8"}]},L=o.useMemo(()=>r.filter(I=>I.profitMargin<=90).slice(0,3).map(I=>({key:I._id,name:I.name,profitMargin:I.profitMargin})),[r]);return e.jsxs("div",{className:"dashboard-container",style:{padding:m?"10px":"20px"},children:[e.jsxs(O,{gutter:[5,5],wrap:!0,children:[e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/menu",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle green",children:e.jsx(D,{icon:tt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"מוצרים"}),e.jsx("div",{className:"stat-value",children:r.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/suppliers",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle red",children:e.jsx(D,{icon:nt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"ספקים"}),e.jsx("div",{className:"stat-value",children:s.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/ingredients",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle blue",children:e.jsx(D,{icon:We})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"חומרי גלם"}),e.jsx("div",{className:"stat-value",children:i.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/menu",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle yellow",children:e.jsx(D,{icon:et})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"קטגוריות"}),e.jsx("div",{className:"stat-value",children:t.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/mixes",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle purple",children:e.jsx(D,{icon:xt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"תערובות"}),e.jsx("div",{className:"stat-value",children:n.length})]})]})})}),e.jsx(z,{xs:12,sm:12,md:10,lg:8,xl:6,children:e.jsx(pe,{to:"/employees",children:e.jsxs(le,{className:"dashboard-card",children:[e.jsx("div",{className:"icon-circle aqua",children:e.jsx(D,{icon:xt})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-title",children:"עובדים"}),e.jsx("div",{className:"stat-value",children:u==null?void 0:u.length})]})]})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:et,style:{marginLeft:"8px"}}),"מוצרים לפי קטגוריה"]}),children:e.jsx(kn,{data:c,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:We,style:{marginLeft:"8px"}}),"חומרי הגלם היקרים ביותר"]}),children:e.jsx(Qt,{data:N,options:{responsive:!0,maintainAspectRatio:!1}})})})]}),e.jsx(Z,{className:"no-margin"}),e.jsxs(O,{gutter:[16,16],children:[e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:xt,style:{marginLeft:"8px"}}),"התערובות היקרות ביותר"]}),children:e.jsx(Qt,{data:S,options:{responsive:!0,maintainAspectRatio:!1}})})}),e.jsx(z,{xs:24,md:12,children:e.jsx(le,{className:"dashboard-card",title:e.jsxs("span",{children:[e.jsx(D,{icon:tt,style:{marginLeft:"8px"}}),"מוצרים עם רווחיות נמוכה"]}),children:e.jsx(O,{gutter:[16,16],children:L.map(I=>e.jsx(z,{xs:24,sm:8,children:e.jsxs(le,{children:[e.jsx(Ze,{title:I.name,value:I.profitMargin,suffix:"%",valueStyle:{color:"#cf1322"}}),e.jsx(ba,{type:"secondary",children:"רווחיות"})]})},I.key))})})})]})]})}const ot="https://menu-server-c2b952e2c698.herokuapp.com/api",Ia=t=>X.post(`${ot}/mixes`,t),Na=t=>{const r=encodeURIComponent(t._id);return X.put(`${ot}/mixes/${r}`,t)},ka=t=>X.delete(`${ot}/mixes/${t}`),Fa=()=>X.get(`${ot}/mixes`),Rs=o.createContext(),Pa=()=>o.useContext(Rs),_a=({children:t})=>{const[r,s]=o.useState(!1),i=async m=>{s(!0);try{await Ia(m),q.success("התערובת נוספה בהצלחה"),s(!1)}catch(c){console.error("Error adding mix:",c),q.error("שגיאה בהוספת התערובת"),s(!1)}},n=async m=>{s(!0);try{await Na(m),q.success("התערובת עודכנה בהצלחה"),s(!1)}catch(c){console.error("Error updating mix:",c),q.error("שגיאה בעדכון התערובת"),s(!1)}},u=async m=>{s(!0);try{await ka(m),q.success("התערובת נמחקה בהצלחה"),s(!1)}catch(c){console.error("Error deleting mix:",c),q.error("שגיאה במחיקת התערובת"),s(!1)}};return e.jsx(Rs.Provider,{value:{addMix:i,updateMix:n,deleteMix:u,loading:r},children:t})};function Ta(){var b;const{addMix:t,updateMix:r,deleteMix:s}=Pa(),[i,n]=o.useState([]),[u,m]=o.useState([]),[c,h]=o.useState({}),f=V(w=>w.mixes),N=(b=V(w=>w.ingredients))==null?void 0:b.filter(w=>w.is_active);V(w=>w.products);const S=V(w=>{var d,p;return(p=(d=w.settings.settings)==null?void 0:d.hourlyRate)==null?void 0:p.value}),L=({ingredients:w})=>{const[p,C]=o.useState(!1),j=w.slice(0,2);return w.slice(2).map((x,g)=>e.jsx("div",{style:{marginBottom:"5px"},children:`${x==null?void 0:x.name} (${x.quantity} ${x.unit}) - ₪${x==null?void 0:x.costForQuantity}`},g)),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",alignItems:"center"},children:[e.jsx("span",{style:{color:"blue",cursor:"pointer",fontWeight:"bold",marginLeft:"5px"},onClick:()=>C(!0),children:e.jsx(Sn,{style:{fontSize:"16px",color:"#000"}})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",maxWidth:"400px"},children:j.map((x,g)=>e.jsx("span",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",fontSize:"0.7vw"},children:`${x==null?void 0:x.name} (${x.quantity} ${x.unit}) - ₪${x==null?void 0:x.costForQuantity}`},g))}),e.jsx(fe,{title:"רשימת מרכיבים",open:p,onCancel:()=>C(!1),footer:[e.jsx(E,{onClick:()=>C(!1),children:"סגור"},"close")],children:w.map((x,g)=>e.jsx("div",{style:{backgroundColor:"#f0f0f0",borderRadius:"8px",padding:"5px 10px",width:"fit-content",fontSize:"0.7vw",marginBottom:".5vw"},children:`${x==null?void 0:x.name} (${x.quantity} ${x.unit}) - ₪${x==null?void 0:x.costForQuantity}`},g))})]})},I=["name","ingredients"],F=["name","preparationTime","totalCost","totalWeight","usedCount"],P=[{key:"name",dataIndex:"name",title:"שם",required:!0},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה"},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת"},{key:"totalWeight",dataIndex:"totalWeight",title:"משקל כולל"},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש"}],R=[{key:"name",dataIndex:"name",title:"שם התערובת",editable:!0,type:"text",minWidth:100,rules:[{required:!0,message:"חייב להיות שם תערובת"},{min:3,message:"שם חייב להיות לפחות 3 תווים"}]},{key:"usedCount",dataIndex:"usedCount",title:"בשימוש",editable:!1,width:100},{key:"preparationTime",dataIndex:"preparationTime",title:"זמן הכנה (דקות)",editable:!0,minWidth:100,type:"number",rules:[{required:!0,message:"זמן הכנה נדרש"},{type:"number",min:0,message:"זמן הכנה חייב להיות מספר חיובי"}]},{key:"unitCost",dataIndex:"unitCost",title:"עלות ל-100 גרם (₪)",minWidth:100,render:(w,d)=>(d==null?void 0:d.totalWeight)!=null&&(d==null?void 0:d.totalCost)!=null?`₪${((Number(d.totalCost)+Number(d.laborCost||0))/(Number(d.totalWeight)*10)).toFixed(2)} / 100 גרם`:"—",editable:!1},{key:"laborCost",dataIndex:"laborCost",title:"עלות עבודה (₪)",minWidth:100,render:(w,d)=>{var p;return`₪${(p=d==null?void 0:d.laborCost)==null?void 0:p.toFixed(2)} (₪${S})`||"—"},editable:!1},{key:"totalCost",dataIndex:"totalCost",title:"עלות כוללת (₪)",minWidth:100,render:(w,d)=>(d==null?void 0:d.totalCost)!=null&&(d==null?void 0:d.laborCost)!=null?`₪${(Number(d.totalCost)+Number(d.laborCost)).toFixed(2)}`:"—",editable:!1},{key:"totalWeight",dataIndex:"totalWeight",title:'משקל כולל (ק"ג)',minWidth:100,render:(w,d)=>{var p;return((p=d.totalWeight)==null?void 0:p.toFixed(2))||"—"},editable:!1},{key:"ingredients",title:"רכיבים",type:"ingredientsManager",editable:!0,width:500,minWidth:500,column:!0,fields:[{key:"ingredientId",type:"select",title:"רכיב",placeholder:"בחר רכיב",options:N.map(w=>({value:w._id,label:w.name})),required:!0,rules:[{required:!0,message:"יש לבחור רכיב"}]},{key:"quantity",type:"number",title:"כמות",placeholder:"הזן כמות",required:!0,rules:[{required:!0,message:"יש להזין כמות"},{type:"number",min:0,message:"כמות חייבת להיות חיובית"}]},{key:"unit",type:"text",title:"יחידה",readonly:!0},{key:"weightOrVolumePerUnit",type:"number",title:"נפח/משקל ליחידה (אם רלוונטי)",placeholder:"הזן נפח ליחידה",required:!1,visible:w=>w.unit==="units",rules:[{type:"number",min:0,message:"ערך חייב להיות חיובי"}]}],render:(w,d,p,C)=>{let j=[...(d==null?void 0:d.ingredients)||[]].sort((a,x)=>x.quantity-a.quantity);return j=j==null?void 0:j.map(a=>{var x;return{name:a==null?void 0:a.ingredientData.name,quantity:((a==null?void 0:a.rawQuantityForJuice)||a.quantity)<1&&a.unit!=="units"?((a==null?void 0:a.rawQuantityForJuice)||a.quantity)*100:(a==null?void 0:a.rawQuantityForJuice)||a.quantity,unit:(x=we==null?void 0:we.find(g=>g.value===a.unit))==null?void 0:x.display((a==null?void 0:a.rawQuantityForJuice)||a.quantity),costForQuantity:a==null?void 0:a.costForQuantity}}),C?e.jsx("ul",{style:{display:"flex",flexDirection:"column",gap:"5px",padding:0,margin:0,listStyleType:"none"},children:j==null?void 0:j.map((a,x)=>e.jsxs("li",{style:{whiteSpace:"normal",display:"flex"},children:[e.jsx(st,{title:a==null?void 0:a.name,children:e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:"150px"},children:a==null?void 0:a.name})}),` (${a.quantity} ${a.unit}) - ₪${a==null?void 0:a.costForQuantity}`]},x))}):e.jsx(L,{ingredients:j})},rules:[{required:!0,message:"יש לבחור לפחות רכיב אחד"}]}];return N==null||N.map(w=>({label:w.name,value:w._id})),o.useEffect(()=>{f&&(n(f),m(f))},[f,N,S]),o.useEffect(()=>{const w=JSON.parse(localStorage.getItem("filtersMenu")||"{}");h(w)},[]),e.jsx(rt,{title:"מתכונים",titleView:"מיקס",type:"mix",data:i,mobileKeys:F,dataPrint:u,sortKeys:P,tableKeys:R,newTitle:"הוסף תערובת חדשה",searchKeys:I,setDataPrint:m,onAdd:t,onEdit:r,onDelete:s,Dtitle:"אישור מחיקה",ingredientsArr:N,iconADD:e.jsx(D,{icon:Et}),Dcontent:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"האם אתה בטוח שברצונך למחוק את התערובת?"}),e.jsx("p",{children:"שים לב! מחיקת תערובת עשויה להשפיע על מוצרים המשתמשים בה."})]})})}const{Text:Ea}=Y,{Option:Xe}=ce,Ms=({addEmployee:t,initialValues:r,onClose:s})=>{const[i]=M.useForm(),n=V(h=>h.employees),[u,m]=o.useState("");o.useEffect(()=>{r&&i.setFieldsValue(r)},[r,i]);const c=h=>{if(n.some(f=>f.name===h.name.trim()&&(!r||f._id!==r._id))){m("קיים כבר עובד בעל שם דומה");return}t({...r,...h}),i.resetFields(),s()};return e.jsx(le,{className:"employee-form-card",children:e.jsxs(M,{form:i,layout:"vertical",onFinish:c,initialValues:r,children:[e.jsx(M.Item,{label:"שם עובד",name:"name",rules:[{required:!0,message:"אנא הזן שם עובד"}],children:e.jsx(xe,{})}),e.jsx(M.Item,{label:"תפקיד",name:"position",children:e.jsx(xe,{placeholder:"הזן תפקיד"})}),e.jsx(M.Item,{label:"תעריף שעתי",name:"hourlyRate",rules:[{required:!0,message:"אנא הזן תעריף שעתי"}],children:e.jsx(de,{min:0,style:{width:"100%"}})}),e.jsx(M.Item,{label:"סטטוס",name:"status",initialValue:"active",rules:[{required:!0}],children:e.jsxs(ce,{children:[e.jsx(Xe,{value:"active",children:"פעיל"}),e.jsx(Xe,{value:"inactive",children:"לא פעיל"}),e.jsx(Xe,{value:"on_leave",children:"בחופשה"}),e.jsx(Xe,{value:"terminated",children:"סיים העסקה"})]})}),u&&e.jsx(ln,{style:{display:"block",marginBottom:"10px"},children:e.jsx(Ea,{type:"danger",className:"error-message",children:u})}),e.jsxs(M.Item,{children:[e.jsx(E,{type:"primary",htmlType:"submit",className:"employee-form-button",children:r?"עדכן עובד":"הוסף עובד"}),e.jsx(E,{className:"employee-form-button",onClick:s,style:{marginLeft:"8px"},children:"ביטול"})]})]})})},dt="https://menu-server-c2b952e2c698.herokuapp.com/api",$a=t=>X.post(`${dt}/employees`,t),Aa=t=>{const r=encodeURIComponent(t._id);return X.put(`${dt}/employees/${r}`,t)},Ra=t=>X.delete(`${dt}/employees/${t}`),Ma=(t,r)=>X.get(`${dt}/employees?`),qs=o.createContext(),Ls=()=>o.useContext(qs),qa=({children:t})=>{const[r,s]=o.useState(!1),i=async m=>{s(!0);try{await $a(m),q.success("העובד נוסף בהצלחה"),s(!1)}catch(c){console.error("Error adding employee:",c),q.error("שגיאה בהוספת עובד"),s(!1)}},n=async m=>{s(!0);try{await Aa(m),q.success("העובד עודכן בהצלחה"),s(!1)}catch(c){console.error("Error updating employee:",c),q.error("שגיאה בעדכון עובד"),s(!1)}},u=async m=>{s(!0);try{await Ra(m),q.success("העובד נמחק בהצלחה"),s(!1)}catch(c){console.error("Error deleting employee:",c),q.error("שגיאה במחיקת עובד"),s(!1)}};return e.jsx(qs.Provider,{value:{addEmployee:i,updateEmployee:n,deleteEmployee:u,loading:r},children:t})},{Text:mt}=Y,La=({sortKey:t})=>{const{updateEmployee:r,deleteEmployee:s}=Ls(),i=V(S=>S.employees),[n,u]=o.useState(!1),[m,c]=o.useState(null),h=S=>{c(S),u(!0)},f=()=>{c(null),u(!1)},N=[...i].sort((S,L)=>t==="name"?S.name.localeCompare(L.name):0);return e.jsxs(le,{title:"רשימת עובדים",className:"employee-list-card",children:[e.jsx(ue,{itemLayout:"vertical",dataSource:N,renderItem:S=>e.jsx(ue.Item,{className:"employee-item",actions:[e.jsx(E,{type:"link",onClick:()=>h(S),children:"ערוך"}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את העובד הנוכחי?",onConfirm:()=>s(S._id),okText:"כן",cancelText:"לא",children:e.jsx(E,{icon:e.jsx(_e,{}),danger:!0})})],children:e.jsx(ue.Item.Meta,{title:e.jsx(mt,{strong:!0,children:S.name}),description:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(mt,{strong:!0,children:"תפקיד:"})," ",S.position||"לא הוגדר"]}),e.jsxs("p",{children:[e.jsx(mt,{strong:!0,children:"תעריף שעתי:"})," ",S.hourlyRate," ₪"]}),e.jsx("p",{children:e.jsx(Ke,{color:Da(S.status),text:Oa(S.status),style:{marginLeft:"8px"}})})]})})},S._id)}),e.jsx(fe,{title:m?"ערוך עובד":"הוסף עובד חדש",open:n,onCancel:f,footer:null,children:e.jsx(Ms,{addEmployee:r,initialValues:m,onClose:f})})]})},Oa=t=>{switch(t){case"active":return"פעיל";case"inactive":return"לא פעיל";case"on_leave":return"בחופשה";case"terminated":return"סיים העסקה";default:return"לא ידוע"}},Da=t=>{switch(t){case"active":return"green";case"inactive":return"grey";case"on_leave":return"orange";case"terminated":return"red";default:return"blue"}};function Ua(){const{addEmployee:t}=Ls(),[r,s]=o.useState(!1),[i,n]=o.useState(""),u=()=>{s(!0)},m=()=>{s(!1)};return e.jsxs("div",{style:{padding:"20px"},className:"scrollable-content employees-page-container",children:[e.jsxs("div",{className:"employees-controls",children:[e.jsx(E,{type:"primary",onClick:u,className:"add-employee-button",children:"הוסף עובד חדש"}),e.jsxs(ce,{value:i,onChange:c=>n(c),className:"sort-select",children:[e.jsx(ce.Option,{value:"",children:"מיין"}),e.jsx(ce.Option,{value:"name",children:"מיין לפי שם"})]})]}),e.jsx(La,{sortKey:i}),e.jsx(fe,{title:"הוסף עובד חדש",open:r,onCancel:m,footer:null,destroyOnClose:!0,children:e.jsx(Ms,{addEmployee:t,onClose:m})})]})}const Ge="https://menu-server-c2b952e2c698.herokuapp.com/api",Ha=(t,r)=>X.post(`${Ge}/employees/${t}/hours`,r),Ba=(t,r)=>X.put(`${Ge}/employees/hours/${t}`,r),Wa=t=>X.delete(`${Ge}/employees/hours/${t}`),za=t=>X.get(`${Ge}/employees/${t}/hours`),Qa=(t,r)=>X.get(`${Ge}/employees/hours/${r}/${t}`),Os=o.createContext(),Ya=()=>o.useContext(Os),Ja=({children:t})=>{const[r,s]=o.useState(!1),i=async(c,h)=>new Promise(async(f,N)=>{var S;s(!0);try{const L=await Ha(c,h);if((L==null?void 0:L.status)===200){q.error((S=L.data)==null?void 0:S.message),N(!1);return}q.success("שעות העבודה נוספו בהצלחה"),f(!0)}catch(L){console.error("Error adding employee hours:",L),q.error("שגיאה בהוספת שעות עבודה"),N(!1)}finally{s(!1)}}),n=async(c,h)=>new Promise(async(f,N)=>{s(!0);try{(await Ba(c,h)).status!==201?N(!1):(q.success("שעות העבודה עודכנו בהצלחה"),f(!0))}catch(S){console.error("Error updating employee hours:",S),q.error("שגיאה בעדכון שעות עבודה"),N(!1)}finally{s(!1)}}),u=async c=>{s(!0);try{const h=await za(c);return q.success("שעות העבודה נשלפו בהצלחה"),h.data}catch(h){console.error("Error fetching employee hours:",h),q.error("שגיאה בשליפת שעות עבודה")}finally{s(!1)}},m=async c=>{s(!0);try{await Wa(c),q.success("שעות העבודה נמחקו בהצלחה")}catch(h){console.error("Error deleting employee hours:",h),q.error("שגיאה במחיקת שעות עבודה")}finally{s(!1)}};return e.jsx(Os.Provider,{value:{loading:r,addEmployeeHours:i,updateEmployeeHours:n,deleteEmployeeHours:m,fetchEmployeeHours:u},children:t})},{Option:Ga}=ce,Xa=({visible:t,onClose:r,dayData:s})=>{const{addEmployeeHours:i,updateEmployeeHours:n,deleteEmployeeHours:u}=Ya(),m=V(d=>d.employees),[c,h]=o.useState(),[f,N]=o.useState(),[S,L]=o.useState(!1),[I]=M.useForm();if(!s)return null;const F=()=>{const d=S?n:i,p=S?f:c;d(S?p==null?void 0:p.hoursId:p.employeeId,p).then(()=>{h(),L(!1),I.resetFields()}).catch(()=>{})},P=d=>{N({...d,employeeId:d.employeeId,startTime:d.hours.start,endTime:d.hours.end,date:s.date}),L(!0)},R=()=>{h(null),L(!1)},b=d=>{u(d)},w=m==null?void 0:m.filter(d=>!s.employees.some(p=>p.employeeId===d._id));return e.jsxs(fe,{title:`ניהול שעות עבודה ליום ${s.date}`,open:t,onCancel:r,footer:null,width:800,style:{top:"1em"},destroyOnClose:!0,children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"סיכום יום"}),e.jsxs("p",{children:["תאריך: ",s.date]}),e.jsxs("p",{children:["יום בשבוע: ",s.dayOfWeek]}),e.jsx(Pe,{color:(s==null?void 0:s.status)==="חצי יום"?"orange":"green",children:s==null?void 0:s.status})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:S?"עריכת עובד":"הוספת עובד חדש"}),e.jsx(M,{form:I,layout:"vertical",onFinish:F,children:e.jsx(M.Item,{label:"בחר עובד",style:{maxWidth:"400px"},children:e.jsx(ce,{showSearch:!0,placeholder:"חיפוש והוספת עובד",optionFilterProp:"children",value:(c==null?void 0:c.employeeId)||null,onChange:d=>{const p=w.find(C=>C._id===d);h({name:p==null?void 0:p.name,startTime:"",endTime:"",date:s==null?void 0:s.date,employeeId:p._id})},filterOption:(d,p)=>p.children.toLowerCase().includes(d.toLowerCase()),children:w==null?void 0:w.map(d=>e.jsx(Ga,{value:d._id,children:d.name},d._id))})})})]}),e.jsx(Z,{}),c&&e.jsxs(M,{layout:"inline",onFinish:F,initialValues:{startTime:c==null?void 0:c.startTime,endTime:c==null?void 0:c.endTime},children:[e.jsx(M.Item,{label:"שעת כניסה",children:e.jsx(xe,{placeholder:"HH:mm",value:c==null?void 0:c.startTime,onChange:d=>h(p=>({...p,startTime:d.target.value}))})}),e.jsx(M.Item,{label:"שעת יציאה",children:e.jsx(xe,{placeholder:"HH:mm",value:c==null?void 0:c.endTime,onChange:d=>h(p=>({...p,endTime:d.target.value}))})}),!(c!=null&&c._id)&&e.jsx(E,{type:"primary",onClick:F,children:"שמור שעות עבודה"})]}),e.jsx(Z,{}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("h3",{style:{fontWeight:"600",color:"#333"},children:"עובדים שנוספו"}),e.jsx(ue,{bordered:!0,className:"scroll-content",style:{maxHeight:"25em",overflow:"auto"},dataSource:s==null?void 0:s.employees,renderItem:d=>{var p,C,j;return e.jsx(ue.Item,{children:e.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{fontWeight:"500",width:"6em"},children:d.name}),S&&d.employeeId===(f==null?void 0:f.employeeId)?e.jsxs(e.Fragment,{children:[e.jsx(xe,{placeholder:"שעת כניסה",value:f==null?void 0:f.startTime,onChange:a=>N(x=>({...x,startTime:a.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsx(xe,{placeholder:"שעת יציאה",value:f==null?void 0:f.endTime,onChange:a=>N(x=>({...x,endTime:a.target.value})),style:{width:"100px",marginRight:"10px"}}),e.jsxs(O,{style:{gap:"0.5em"},children:[e.jsx(E,{type:"primary",icon:e.jsx(In,{}),onClick:F}),e.jsx(E,{icon:e.jsx($t,{}),onClick:R,style:{marginLeft:"5px"}})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:"כניסה",value:(p=d==null?void 0:d.hours)==null?void 0:p.start}),e.jsx(Ze,{title:"יציאה",value:(C=d==null?void 0:d.hours)==null?void 0:C.end}),e.jsx(Ze,{title:"סך שעות",value:(j=d==null?void 0:d.hoursWorked)==null?void 0:j.toFixed(2)}),e.jsxs(O,{style:{gap:"0.5em"},children:[e.jsx(E,{icon:e.jsx(At,{}),onClick:()=>P(d)}),e.jsx(_t,{title:"האם אתה בטוח שברצונך למחוק את העובד?",onConfirm:()=>b(d.hoursId),okText:"כן",cancelText:"לא",children:e.jsx(E,{icon:e.jsx(_e,{}),danger:!0})})]})]})]})})}})]})]})},Va=({monthData:t})=>{const[r,s]=o.useState(!1),[i,n]=o.useState(null),u=h=>{n(h),s(!0)},m=[{title:"תאריך",dataIndex:"date",key:"date"},{title:"יום בשבוע",dataIndex:"dayOfWeek",key:"dayOfWeek"},{title:"סטטוס",dataIndex:"status",key:"status",render:h=>e.jsx(Pe,{color:h==="חצי יום"?"orange":"green",children:h})},{title:"מספר עובדים",dataIndex:"employeesCount",key:"employeesCount",render:h=>h??"לא ידוע"},{title:"סך הכל שעות",dataIndex:"totalHours",key:"totalHours",render:h=>(h==null?void 0:h.toFixed(2))??"לא ידוע"}],c=h=>{let f="";return h!=null&&h.hasError&&(f+="workhours-error "),h.isToday?f+="today-row":h.isPast&&(f+="past-row"),f};return e.jsxs(e.Fragment,{children:[e.jsx(as,{columns:m,dataSource:t,rowKey:"date",pagination:!1,rowClassName:c,onRow:(h,f)=>({onClick:()=>(h.isToday||h.isPast)&&u(f)})}),e.jsx(Xa,{visible:r,onClose:()=>s(!1),dayData:t[i]})]})},{MonthPicker:Za}=on;Se.locale("he");const Ka=()=>{const t=ze(),r=V(n=>n.employeeHours.data),s=V(n=>n.employeeHours.selectedDate),i=n=>{t(Dr(n.format("YYYY-MM")))};return e.jsxs("div",{className:"workhours-container",children:[e.jsx("h1",{children:"ניהול שעות עבודה חודשיות"}),e.jsx(Za,{onChange:i,placeholder:"בחר חודש ושנה",disabledDate:n=>n&&n>Se().endOf("month")},s),e.jsx(Va,{monthData:r})," "]})},Ds=Ie({name:"suppliers",initialState:[],reducers:{addSuppliersState:(t,r)=>r.payload,addOrUpdateSupplierState:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateSupplierState:(t,r)=>{const s=r.payload;return t.map(i=>i._id===s._id?s:i)},deleteSupplierState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{addSuppliersState:ei,addOrUpdateSupplierState:ti,updateSupplierState:si,deleteSupplierState:ni}=Ds.actions,ri=Ds.reducer;function ht(t){let r,s,i,n;const u=t.price/1.17;return t.unit==='ק"ג'||t.unit==="weight"?(r=.1,s="גרם",i=u/t.quantity*r):t.unit==="ליטר"||t.unit==="volume"?(r=.1,s='מ"ל',i=u/t.quantity*r):(t.unit==="יחידות"||t.unit==="units")&&(r=1,s="יחידה",i=u/t.quantity),t.isJuice&&(n=i/(t.juiceRatio||1)),{...t,priceExcludingVAT:u.toFixed(2),unitQuantity:r,unitDescription:s,unitPrice:i.toFixed(2),processedPrice:n?n.toFixed(2):null}}const Us=Ie({name:"ingredients",initialState:[],reducers:{addIngerdientsState:(t,r)=>r.payload.map(ht),addOrUpdateIngredientState:(t,r)=>{const s=ht(r.payload),i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateIngredientState:(t,r)=>{const s=ht(r.payload);return t.map(i=>i._id===s._id?s:i)},deleteIngredientState:(t,r)=>{const s=r.payload._id;return t.filter(i=>i._id!==s)}}}),{addIngerdientsState:ai,addOrUpdateIngredientState:ii,updateIngredientState:li,deleteIngredientState:oi}=Us.actions,di=Us.reducer,Hs=Ie({name:"mixes",initialState:[],reducers:{setMixesState:(t,r)=>{const{mixes:s,ingredientsState:i}=r.payload;return s},addOrUpdateMixState:(t,r)=>{const{newMix:s,ingredientsState:i}=r.payload,n=s,u=t.findIndex(m=>m._id===s._id);u!==-1?t[u]=n:t.unshift(n)},updateMixState:(t,r)=>{const{updatedMix:s,ingredientsState:i}=r.payload,n=s,u=t.findIndex(m=>m._id===s._id);u!==-1&&(t[u]=n)},deleteMixState:(t,r)=>t.filter(s=>s._id!==r.payload._id)}}),{setMixesState:ci,addOrUpdateMixState:ui,updateMixState:xi,deleteMixState:pi}=Hs.actions,mi=Hs.reducer,Bs=Ie({name:"categories",initialState:[],reducers:{setCategories:(t,r)=>r.payload,addOrUpdateCategory:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.unshift(s)},updateCategory:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1&&(t[i]=s)},deleteCategory:(t,r)=>{const s=r.payload;return t.filter(i=>i._id!==s)}}}),{setCategories:hi,addOrUpdateCategory:gi,updateCategory:ji,deleteCategory:fi}=Bs.actions,yi=Bs.reducer,Ws=Ie({name:"employees",initialState:[],reducers:{setEmployees:(t,r)=>r.payload,addOrUpdateEmployee:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1?t[i]=s:t.push(s)},updateEmployee:(t,r)=>{const s=r.payload,i=t.findIndex(n=>n._id===s._id);i!==-1&&(t[i]=s)},deleteEmployee:(t,r)=>t.filter(s=>s._id!==r.payload)}}),{setEmployees:vi,addOrUpdateEmployee:wi,updateEmployee:bi,deleteEmployee:Ci}=Ws.actions,Si=Ws.reducer,Ii=(t,r)=>{t.on("ingredientAdded",s=>{r(ii(s))}),t.on("ingredientUpdated",s=>{r(li(s))}),t.on("ingredientDeleted",s=>{r(oi(s))}),t.on("supplierAdded",s=>{r(ti(s))}),t.on("supplierUpdated",s=>{r(si(s))}),t.on("supplierDeleted",s=>{r(ni(s))}),t.on("productAdded",s=>{r((i,n)=>{const u=n().ingredients,m=n().mixes;i(bt({newProduct:s,ingredientsState:u,mixesState:m}))})}),t.on("productUpdated",s=>{r((i,n)=>{const u=n().ingredients,m=n().mixes;i(bt({newProduct:s,ingredientsState:u,mixesState:m}))})}),t.on("productDeleted",s=>{r(Hr(s))}),t.on("categoryAdded",s=>{r(gi(s))}),t.on("categoryUpdated",s=>{r(ji(s))}),t.on("categoryDeleted",s=>{r(fi(s._id))}),t.on("mixAdded",s=>{r((i,n)=>{const u=n().ingredients;i(ui({newMix:s,ingredientsState:u}))})}),t.on("mixUpdated",s=>{r((i,n)=>{const u=n().ingredients;i(xi({updatedMix:s,ingredientsState:u}))})}),t.on("mixDeleted",s=>{r(pi(s))}),t.on("employeeAdded",s=>{r(wi(s))}),t.on("employeeUpdated",s=>{r(bi(s))}),t.on("employeeDeleted",s=>{r(Ci(s._id))}),t.on("employeeHoursAdded",s=>{r(qr(s))}),t.on("employeeHoursUpdated",s=>{r(Lr(s))}),t.on("employeeHoursDeleted",s=>{r(Or({_id:s._id}))})},ss="https://menu-server-c2b952e2c698.herokuapp.com/",Ni=o.createContext(),ki=({children:t})=>{const r=ze();return console.log(ss),o.useEffect(()=>{const s=Mn(ss);return Ii(s,r),()=>s.disconnect()},[r]),e.jsx(Ni.Provider,{value:{},children:t})};q.config({prefixCls:"my-message"});const Fi=({children:t,setLoading:r})=>{const s=ze(),i=V(u=>u.employeeHours.selectedDate),n=V(u=>{var m,c;return(c=(m=u.settings.settings)==null?void 0:m.hourlyRate)==null?void 0:c.value});return o.useEffect(()=>{(async()=>{var h,f;r(!0);const m=zt(i).year(),c=zt(i).month()+1;try{const[N,S,L,I,F,P,R]=await Promise.all([ia(),Kr(),bs(),kr(),Fa(),Ma(),Qa(c,m)]);s(ai((h=N==null?void 0:N.data)==null?void 0:h.reverse())),s((b,w)=>{var p;const d=w().ingredients;b(ci({mixes:(p=F==null?void 0:F.data)==null?void 0:p.reverse(),ingredientsState:d}))}),s((b,w)=>{var C;const d=w().ingredients,p=w().mixes;b(Ps({products:(C=L.data)==null?void 0:C.reverse(),ingredientsState:d,mixesState:p,averageHourlyRate:n}))}),s(hi(I.data)),s(ei((f=S==null?void 0:S.data)==null?void 0:f.reverse())),s(vi(P.data)),s(Rr({selectedDate:i,employees:P.data,employeeHours:R==null?void 0:R.data})),r(!1)}catch(N){console.error("Error fetching data:",N),r(!1)}})()},[s,r,i]),e.jsx(ki,{children:e.jsx(oa,{children:e.jsx(ta,{children:e.jsx(jr,{children:e.jsx(_a,{children:e.jsx(Pr,{children:e.jsx(qa,{children:e.jsx(Ja,{children:e.jsx(ya,{children:t})})})})})})})})})},Ct="/assets/logo-Ha-8mVYV.png";function te(...t){return Qn(zn(t))}const zs=On,Pi=Ln,Qs=o.forwardRef(({className:t,...r},s)=>e.jsx(xs,{ref:s,className:te("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));Qs.displayName=xs.displayName;const qt=o.forwardRef(({className:t,children:r,...s},i)=>e.jsxs(Pi,{children:[e.jsx(Qs,{}),e.jsxs(ps,{ref:i,className:te("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[r,e.jsxs(qn,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(wt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qt.displayName=ps.displayName;const Lt=({className:t,...r})=>e.jsx("div",{className:te("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Lt.displayName="DialogHeader";const Ot=o.forwardRef(({className:t,...r},s)=>e.jsx(ms,{ref:s,className:te("text-lg font-semibold leading-none tracking-tight",t),...r}));Ot.displayName=ms.displayName;const _i=o.forwardRef(({className:t,...r},s)=>e.jsx(hs,{ref:s,className:te("text-sm text-muted-foreground",t),...r}));_i.displayName=hs.displayName;const Ti=Mt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Te=o.forwardRef(({className:t,...r},s)=>e.jsx(gs,{ref:s,className:te(Ti(),t),...r}));Te.displayName=gs.displayName;const Ei=tr,Ys=o.createContext({}),Ve=({...t})=>e.jsx(Ys.Provider,{value:{name:t.name},children:e.jsx(sr,{...t})}),ct=()=>{const t=o.useContext(Ys),r=o.useContext(Js),{getFieldState:s,formState:i}=er(),n=s(t.name,i);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:u}=r;return{id:u,name:t.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...n}},Js=o.createContext({}),Le=o.forwardRef(({className:t,...r},s)=>{const i=o.useId();return e.jsx(Js.Provider,{value:{id:i},children:e.jsx("div",{ref:s,className:te("space-y-2",t),...r})})});Le.displayName="FormItem";const Oe=o.forwardRef(({className:t,...r},s)=>{const{error:i,formItemId:n}=ct();return e.jsx(Te,{ref:s,className:te(i&&"text-destructive",t),htmlFor:n,...r})});Oe.displayName="FormLabel";const De=o.forwardRef(({...t},r)=>{const{error:s,formItemId:i,formDescriptionId:n,formMessageId:u}=ct();return e.jsx(js,{ref:r,id:i,"aria-describedby":s?`${n} ${u}`:`${n}`,"aria-invalid":!!s,...t})});De.displayName="FormControl";const $i=o.forwardRef(({className:t,...r},s)=>{const{formDescriptionId:i}=ct();return e.jsx("p",{ref:s,id:i,className:te("text-[0.8rem] text-muted-foreground",t),...r})});$i.displayName="FormDescription";const Ue=o.forwardRef(({className:t,children:r,...s},i)=>{const{error:n,formMessageId:u}=ct(),m=n?String(n==null?void 0:n.message):r;return m?e.jsx("p",{ref:i,id:u,className:te("text-[0.8rem] font-medium text-destructive",t),...s,children:m}):null});Ue.displayName="FormMessage";const St=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("rounded-xl border bg-card text-card-foreground shadow",t),...r}));St.displayName="Card";const It=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("flex flex-col space-y-1.5 p-6",t),...r}));It.displayName="CardHeader";const Nt=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("font-semibold leading-none tracking-tight",t),...r}));Nt.displayName="CardTitle";const Ai=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("text-sm text-muted-foreground",t),...r}));Ai.displayName="CardDescription";const He=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("p-6 pt-0",t),...r}));He.displayName="CardContent";const Ri=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("flex items-center p-6 pt-0",t),...r}));Ri.displayName="CardFooter";const Mi=Mt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ge=o.forwardRef(({className:t,variant:r,size:s,asChild:i=!1,...n},u)=>{const m=i?js:"button";return e.jsx(m,{className:te(Mi({variant:r,size:s,className:t})),ref:u,...n})});ge.displayName="Button";const Ce=o.forwardRef(({className:t,type:r,...s},i)=>e.jsx("input",{type:r,className:te("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:i,...s}));Ce.displayName="Input";const qi=Mt("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Gs=o.forwardRef(({className:t,variant:r,...s},i)=>e.jsx("div",{ref:i,role:"alert",className:te(qi({variant:r}),t),...s}));Gs.displayName="Alert";const Li=o.forwardRef(({className:t,...r},s)=>e.jsx("h5",{ref:s,className:te("mb-1 font-medium leading-none tracking-tight",t),...r}));Li.displayName="AlertTitle";const Xs=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:te("text-sm [&_p]:leading-relaxed",t),...r}));Xs.displayName="AlertDescription";const Oi=Dn,Vs=o.forwardRef(({className:t,...r},s)=>e.jsx(fs,{ref:s,className:te("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));Vs.displayName=fs.displayName;const kt=o.forwardRef(({className:t,...r},s)=>e.jsx(ys,{ref:s,className:te("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));kt.displayName=ys.displayName;const Ft=o.forwardRef(({className:t,...r},s)=>e.jsx(vs,{ref:s,className:te("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Ft.displayName=vs.displayName;const Di=Hn,Ui=Bn,Zs=o.forwardRef(({className:t,align:r="center",sideOffset:s=4,...i},n)=>e.jsx(Un,{children:e.jsx(ws,{ref:n,align:r,sideOffset:s,className:te("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})}));Zs.displayName=ws.displayName;const ns=({value:t,onChange:r})=>{const s=["#2196F3","#1976D2","#0D47A1","#4FC3F7","#4CAF50","#2E7D32","#81C784","#26A69A","#F44336","#D32F2F","#FF7043","#FF5722","#9C27B0","#7B1FA2","#E91E63","#6A1B9A"];return e.jsxs(Di,{children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(ge,{variant:"outline",className:"w-[140px] flex items-center justify-between gap-2 rtl",children:[e.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm border border-zinc-200",style:{backgroundColor:t||"#ffffff"}}),e.jsx("span",{className:"flex-1 text-right",children:"בחר צבע"}),e.jsx(Yn,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Zs,{className:"w-[256px] p-3",align:"start",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.map(i=>e.jsx("button",{className:te("h-10 w-10 rounded-md relative","transition-all duration-100 ease-in-out","hover:scale-110 hover:shadow-lg","focus:outline-none focus:ring-2 focus:ring-zinc-400",t===i&&"ring-2 ring-zinc-800"),style:{backgroundColor:i,transform:t===i?"scale(1.1)":"scale(1)"},onClick:()=>r(i),children:t===i&&e.jsx(Jn,{className:te("absolute inset-0 m-auto","w-4 h-4 text-white","drop-shadow-[0_2px_3px_rgba(0,0,0,0.3)]")})},i))})})]})},Hi=Me.object({hourlyRate:Me.number().positive("עלות שעת עבודה חייבת להיות מספר חיובי").min(0),fixedExpensesRate:Me.number().min(0,"האחוז חייב להיות בין 0 ל-100").max(100,"האחוז חייב להיות בין 0 ל-100"),profitRate:Me.number().min(0,"האחוז חייב להיות בין 0 ל-100").max(100,"האחוז חייב להיות בין 0 ל-100"),vatRate:Me.number().min(0,'מע"מ חייב להיות מספר חיובי').max(100,'מע"מ חייב להיות מספר חיובי')});function Bi({open:t,onConfirm:r,onCancel:s,itemName:i}){return e.jsx(zs,{open:t,onOpenChange:s,children:e.jsxs(qt,{className:"max-w-sm",children:[e.jsx(Lt,{children:e.jsx(Ot,{children:"מחיקת קטגוריה"})}),e.jsxs("p",{children:['האם אתה בטוח שברצונך למחוק את הקטגוריה "',i,'"?']}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(ge,{variant:"outline",onClick:s,children:"ביטול"}),e.jsx(ge,{variant:"destructive",onClick:r,children:"מחיקה"})]})]})})}function Wi({flag:t,setFlag:r}){var re,ae,ie,k,A;const{settings:s,loading:i,updateSetting:n,fetchSettings:u,addCategoryContext:m,updateCategoryContext:c,deleteCategoryContext:h}=As(),f=nr({resolver:rr(Hi),defaultValues:{hourlyRate:((re=s==null?void 0:s.hourlyRate)==null?void 0:re.value)||0,fixedExpensesRate:((ae=s==null?void 0:s.fixedExpensesRate)==null?void 0:ae.value)||0,profitRate:((ie=s==null?void 0:s.profitRate)==null?void 0:ie.value)||0,vatRate:parseFloat((k=s==null?void 0:s.vatRate)==null?void 0:k.value)||0}}),[N,S]=o.useState({name:"",description:"",color:""}),[L,I]=o.useState(!1),[F,P]=o.useState(null),[R,b]=o.useState(null),[w,d]=o.useState(!1),[p,C]=o.useState(null),[j,a]=o.useState(null);o.useEffect(()=>{t&&(u(),a(null))},[t]),o.useEffect(()=>{var l,$,H,K;s&&f.reset({hourlyRate:parseFloat((l=s==null?void 0:s.hourlyRate)==null?void 0:l.value)||0,fixedExpensesRate:parseFloat(($=s==null?void 0:s.fixedExpensesRate)==null?void 0:$.value)||0,profitRate:parseFloat((H=s==null?void 0:s.profitRate)==null?void 0:H.value)||0,vatRate:parseFloat((K=s==null?void 0:s.vatRate)==null?void 0:K.value)||0})},[s,f]);const x=l=>{P(l),b({name:l.name,description:l.description}),a(null)},g=()=>{P(null),b(null),a(null)},y=(l,$)=>{b(H=>({...H,[l]:$}))},T=async()=>{var l;if(!((l=R==null?void 0:R.name)!=null&&l.trim())){a("שם הקטגוריה הוא שדה חובה");return}try{await c(F._id,{...F,...R}),g(),await u()}catch{a("שגיאה בעדכון הקטגוריה")}},_=async()=>{var l;if(!((l=N.name)!=null&&l.trim())){a("שם הקטגוריה הוא שדה חובה");return}try{await m(N),S({name:"",description:"",color:""}),I(!1),a(null),await u()}catch{a("שגיאה בהוספת הקטגוריה")}},v=l=>{var $;return($=s==null?void 0:s.materialCategories)==null?void 0:$.value.some(H=>H.color===l)},W=async()=>{try{await h(p._id),await u(),d(!1)}catch{a("שגיאה במחיקת הקטגוריה")}},J=l=>{C(l),d(!0)},G=async l=>{try{const $={hourlyRate:{value:parseFloat(l.hourlyRate)},fixedExpensesRate:{value:parseFloat(l.fixedExpensesRate)},profitRate:{value:parseFloat(l.profitRate)},vatRate:{value:parseFloat(l.vatRate)}};await n($)}catch{}};return e.jsxs(zs,{open:t,onOpenChange:r,className:"rtl",children:[e.jsxs(qt,{className:"max-w-4xl h-[90vh] overflow-hidden",children:[e.jsx(Lt,{children:e.jsx(Ot,{className:"text-2xl font-bold",children:"הגדרות מערכת"})}),e.jsxs(Oi,{defaultValue:"general",className:"h-full rtl",children:[e.jsxs(Vs,{className:"grid w-full grid-cols-2 rtl",children:[e.jsxs(kt,{value:"general",className:"flex items-center gap-2 rtl",children:[e.jsx(Gn,{className:"w-4 h-4 rtl"}),"הגדרות כלליות"]}),e.jsxs(kt,{value:"categories",className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),"קטגוריות"]})]}),e.jsxs("div",{className:"px-1 rtl",style:{height:"calc(90vh - 140px)"},children:[j&&e.jsx(Gs,{variant:"destructive",className:"mb-4",children:e.jsx(Xs,{children:j})}),e.jsxs(Ft,{value:"general",className:"mt-4 rtl flex flex-col w-full",children:[e.jsx(It,{className:"rtl",children:e.jsx(Nt,{children:"הגדרות תמחור"})}),e.jsx(He,{className:"space-y-4 flex-1 rtl",children:e.jsx(Ei,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(G),className:"space-y-4",children:[e.jsx(Ve,{control:f.control,name:"hourlyRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"עלות שעת עבודה (₪)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",placeholder:"הכנס עלות שעת עבודה",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"fixedExpensesRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"אחוז השתתפות בהוצאות קבועות (%)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",max:"100",placeholder:"הכנס אחוז הוצאות",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"profitRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:"אחוז רווח רצוי (%)"}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.1",min:"0",max:"100",placeholder:"הכנס אחוז רווח",onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx(Ve,{control:f.control,name:"vatRate",render:({field:l})=>e.jsxs(Le,{children:[e.jsx(Oe,{children:' מע"מ (%)'}),e.jsx(De,{children:e.jsx(Ce,{...l,type:"number",step:"0.01",min:"0.10",max:"100",placeholder:'מע"מ',onChange:$=>l.onChange(parseFloat($.target.value)||0)})}),e.jsx(Ue,{})]})}),e.jsx("div",{className:"flex justify-center text-center",children:e.jsxs(ge,{type:"submit",className:"flex items-center gap-2",disabled:i,children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור הגדרות"]})})]})})})]}),e.jsxs(Ft,{value:"categories",className:"mt-4 rtl flex flex-col w-full",children:[e.jsxs(It,{className:"flex flex-row items-center justify-between",children:[e.jsx(Nt,{children:"קטגוריות חומרי גלם"}),!L&&e.jsxs(ge,{variant:"outline",onClick:()=>I(!0),className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"}),"הוסף קטגוריה"]})]}),e.jsxs(He,{className:"space-y-4",children:[L&&e.jsx(St,{className:"border-2 border-zinc-200",children:e.jsxs(He,{className:"space-y-4 p-4",children:[e.jsxs("div",{children:[e.jsx(Te,{children:"שם הקטגוריה"}),e.jsx(Ce,{value:N.name,onChange:l=>S({...N,name:l.target.value}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Te,{children:"תיאור"}),e.jsx(Ce,{value:N.description,onChange:l=>S({...N,description:l.target.value}),className:"mt-1"})]}),e.jsx(ns,{value:N.color,onChange:l=>{v(l)?a("צבע זה כבר בשימוש"):S({...N,color:l})}}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(ge,{onClick:_,className:"flex items-center gap-2",disabled:i,children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור"]}),e.jsxs(ge,{variant:"outline",onClick:()=>{I(!1),S({name:"",description:"",color:""})},className:"flex items-center gap-2",disabled:i,children:[e.jsx(wt,{className:"w-4 h-4"}),"ביטול"]})]})]})}),e.jsx("div",{className:"space-y-2 max-h-[59vh] overflow-y-auto pr-2",children:(A=s==null?void 0:s.materialCategories)==null?void 0:A.value.map(l=>e.jsx(St,{className:"border border-zinc-200",children:e.jsx(He,{className:"p-4",children:(F==null?void 0:F._id)===l._id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Te,{children:"שם"}),e.jsx(Ce,{value:R==null?void 0:R.name,onChange:$=>y("name",$.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Te,{children:"תיאור"}),e.jsx(Ce,{value:R==null?void 0:R.description,onChange:$=>y("description",$.target.value),className:"mt-1"})]}),e.jsx(ns,{value:(R==null?void 0:R.color)||(l==null?void 0:l.color),onChange:$=>{v($)?a("צבע זה כבר בשימוש"):y("color",$)}}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(ge,{onClick:T,disabled:i,className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4"}),"שמור"]}),e.jsxs(ge,{variant:"outline",onClick:g,disabled:i,className:"flex items-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4"}),"ביטול"]})]})]}):e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex flex-row items-center gap-2",style:{},children:[l.name,e.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm border border-zinc-200",style:{backgroundColor:l==null?void 0:l.color}})]}),e.jsx("div",{className:"text-sm text-zinc-500",style:{},children:l.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ge,{variant:"outline",size:"sm",onClick:()=>x(l),className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"}),"ערוך"]}),e.jsxs(ge,{variant:"destructive",size:"sm",onClick:()=>J(l._id),className:"flex items-center gap-2",children:[e.jsx(Kn,{className:"w-4 h-4"}),"מחק"]})]})]})})},l._id))})]})]})]})]})]}),e.jsx(Bi,{open:w,onConfirm:W,onCancel:()=>d(!1),itemName:p==null?void 0:p.name})]})}function zi({drawerVisible:t,setDrawerVisible:r,isMobile:s}){const[i,n]=o.useState(!1);return e.jsxs("div",{className:"top-bar",children:[e.jsx(pe,{to:"/",children:e.jsx(yt,{className:"logo-mobile",src:Ct,alt:"GainGuard",preview:!1})}),e.jsxs("div",{children:[e.jsx("button",{className:"settings-button",onClick:()=>n(!i),children:e.jsx(D,{icon:gn})}),s&&e.jsx("button",{className:"menu-button",onClick:()=>r(!t),children:e.jsx(D,{icon:jn})}),e.jsx(Wi,{flag:i,setFlag:()=>n(!1)})]})]})}const{Header:Qi,Content:Yi,Footer:Ji}=ls;function Gi(){const[t,r]=o.useState(!1),[s,i]=o.useState(!1),n=Ae({query:"(max-width: 1200px)"});return e.jsxs(Fi,{setLoading:i,children:[e.jsx(dn,{fullscreen:!0,spinning:s,size:"large"}),e.jsx(Rn,{children:e.jsxs(ls,{className:"app-container",style:{minHeight:n?"85vh":"100vh"},children:[e.jsxs("div",{className:"nav-container",children:[e.jsx("div",{className:"nav-top",children:e.jsx(yt,{className:"logo",src:Ct,alt:"GainGuard",preview:!1})}),e.jsx(rs,{})]}),e.jsxs("div",{className:"body-container",children:[e.jsxs(Qi,{className:"header",style:{padding:"0 20px"},children:[e.jsx(zi,{isMobile:n,drawerVisible:t,setDrawerVisible:r}),e.jsx(Z,{className:"no-margin"})]}),e.jsx(Yi,{className:"content",children:e.jsxs(ar,{children:[e.jsx(Fe,{path:"/",element:e.jsx(Sa,{})}),e.jsx(Fe,{path:"/menu",element:e.jsx(Gr,{})}),e.jsx(Fe,{path:"/suppliers",element:e.jsx(sa,{})}),e.jsx(Fe,{path:"/mixes",element:e.jsx(Ta,{})}),e.jsx(Fe,{path:"/ingredients",element:e.jsx(wa,{})}),e.jsx(Fe,{path:"/employees",element:e.jsx(Ua,{})}),e.jsx(Fe,{path:"/work-hours",element:e.jsx(Ka,{})})]})}),e.jsx(Ji,{className:"footer",children:"© 2024 מערכת ניהול תפריט ועץ מוצר"})]}),e.jsx(is,{title:e.jsxs(z,{children:[e.jsx(yt,{className:"logo",src:Ct,alt:"GainGuard",preview:!1}),e.jsx("p",{children:"ניווט"})]}),placement:"right",closable:!0,onClose:()=>r(!1),open:t,width:300,children:e.jsx(rs,{onClose:()=>r(!1)})})]})})]})}function rs({onClose:t}){const r=ir(),s=i=>r.pathname===i?"link-active":"link";return e.jsxs("div",{className:"nav-desktop-child",children:[e.jsx(Z,{}),e.jsx(E,{type:"link",onClick:t,className:s("/"),children:e.jsxs(pe,{to:"/",children:[e.jsx(D,{icon:fn})," ",e.jsx("p",{children:"לוח מחוונים"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/menu"),children:e.jsxs(pe,{to:"/menu",children:[e.jsx(D,{icon:tt})," ",e.jsx("p",{children:"תפריט"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/mixes"),children:e.jsxs(pe,{to:"/mixes",children:[e.jsx(D,{icon:Et})," ",e.jsx("p",{children:"מתכונים"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/ingredients"),children:e.jsxs(pe,{to:"/ingredients",children:[e.jsx(D,{icon:We})," ",e.jsx("p",{children:"חומרי גלם"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/suppliers"),children:e.jsxs(pe,{to:"/suppliers",children:[e.jsx(D,{icon:nt})," ",e.jsx("p",{children:"ספקים"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/employees"),children:e.jsxs(pe,{to:"/employees",children:[e.jsx(D,{icon:yn})," ",e.jsx("p",{children:"עובדים"})]})}),e.jsx(E,{type:"link",onClick:t,className:s("/work-hours"),children:e.jsxs(pe,{to:"/work-hours",children:[e.jsx(D,{icon:Tt})," ",e.jsx("p",{children:"ניהול שעות עבודה"})]})})]})}const gt=us("dashboard/fetchDashboardData",async(t,{getState:r})=>(r(),{})),Xi=Ie({name:"dashboard",initialState:[],reducers:{},extraReducers:t=>{t.addCase(gt.pending,r=>{}).addCase(gt.fulfilled,(r,s)=>{}).addCase(gt.rejected,r=>{})}}),Vi=Xi.reducer,Zi=Nn({reducer:{suppliers:ri,ingredients:di,products:Br,dashboard:Vi,mixes:mi,categories:yi,employees:Si,employeeHours:Ur,settings:fa}});Ks.createRoot(document.getElementById("root")).render(e.jsx(Pt.StrictMode,{children:e.jsx(en,{store:Zi,children:e.jsx(Wn,{children:e.jsx(Gi,{})})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(t=>{console.error("ServiceWorker registration failed: ",t)})});
